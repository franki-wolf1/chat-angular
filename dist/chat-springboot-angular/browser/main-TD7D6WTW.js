import{A as Er,B as pt,a as x,b as ae,c as P,d as wO,e as gp,f as y,g as DI,h as Kc,i as CI,j as bI,k as TI,l as mp,m as SI,n as ca,o as yp,p as Qc,q as AI,r as xI,s as vp,t as Ie,u as ai,v as mn,w as Yc,x as la,y as MI,z as RI}from"./chunk-WOI2HMKT.js";var fT=P((eQ,Ny)=>{"use strict";global.crypto&&global.crypto.getRandomValues?Ny.exports.randomBytes=function(t){var e=new Uint8Array(t);return global.crypto.getRandomValues(e),e}:Ny.exports.randomBytes=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=Math.floor(Math.random()*256);return e}});var ki=P((tQ,gT)=>{"use strict";var BB=fT(),pT="abcdefghijklmnopqrstuvwxyz012345";gT.exports={string:function(t){for(var e=pT.length,n=BB.randomBytes(t),r=[],i=0;i<t;i++)r.push(pT.substr(n[i]%e,1));return r.join("")},number:function(t){return Math.floor(Math.random()*t)},numberString:function(t){var e=(""+(t-1)).length,n=new Array(e+1).join("0");return(n+this.number(t)).slice(-e)}}});var nr=P((nQ,Wd)=>{"use strict";var UB=ki(),oo={},Py=!1,mT=global.chrome&&global.chrome.app&&global.chrome.app.runtime;Wd.exports={attachEvent:function(t,e){typeof global.addEventListener<"u"?global.addEventListener(t,e,!1):global.document&&global.attachEvent&&(global.document.attachEvent("on"+t,e),global.attachEvent("on"+t,e))},detachEvent:function(t,e){typeof global.addEventListener<"u"?global.removeEventListener(t,e,!1):global.document&&global.detachEvent&&(global.document.detachEvent("on"+t,e),global.detachEvent("on"+t,e))},unloadAdd:function(t){if(mT)return null;var e=UB.string(8);return oo[e]=t,Py&&setTimeout(this.triggerUnloadCallbacks,0),e},unloadDel:function(t){t in oo&&delete oo[t]},triggerUnloadCallbacks:function(){for(var t in oo)oo[t](),delete oo[t]}};var $B=function(){Py||(Py=!0,Wd.exports.triggerUnloadCallbacks())};mT||Wd.exports.attachEvent("unload",$B)});var vT=P((rQ,yT)=>{"use strict";yT.exports=function(e,n){if(n=n.split(":")[0],e=+e,!e)return!1;switch(n){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}});var ET=P(Oy=>{"use strict";var qB=Object.prototype.hasOwnProperty,HB;function _T(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch{return null}}function wT(t){try{return encodeURIComponent(t)}catch{return null}}function GB(t){for(var e=/([^=?#&]+)=?([^&]*)/g,n={},r;r=e.exec(t);){var i=_T(r[1]),s=_T(r[2]);i===null||s===null||i in n||(n[i]=s)}return n}function zB(t,e){e=e||"";var n=[],r,i;typeof e!="string"&&(e="?");for(i in t)if(qB.call(t,i)){if(r=t[i],!r&&(r===null||r===HB||isNaN(r))&&(r=""),i=wT(i),r=wT(r),i===null||r===null)continue;n.push(i+"="+r)}return n.length?e+n.join("&"):""}Oy.stringify=zB;Oy.parse=GB});var Vy=P((sQ,AT)=>{"use strict";var DT=vT(),Kd=ET(),WB=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,CT=/[\n\r\t]/g,KB=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,bT=/:\d+$/,QB=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,YB=/^[a-zA-Z]:/;function Fy(t){return(t||"").toString().replace(WB,"")}var ky=[["#","hash"],["?","query"],function(e,n){return Sn(n.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],IT={hash:1,query:1};function TT(t){var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e={};var n=e.location||{};t=t||n;var r={},i=typeof t,s;if(t.protocol==="blob:")r=new An(unescape(t.pathname),{});else if(i==="string"){r=new An(t,{});for(s in IT)delete r[s]}else if(i==="object"){for(s in t)s in IT||(r[s]=t[s]);r.slashes===void 0&&(r.slashes=KB.test(t.href))}return r}function Sn(t){return t==="file:"||t==="ftp:"||t==="http:"||t==="https:"||t==="ws:"||t==="wss:"}function ST(t,e){t=Fy(t),t=t.replace(CT,""),e=e||{};var n=QB.exec(t),r=n[1]?n[1].toLowerCase():"",i=!!n[2],s=!!n[3],o=0,a;return i?s?(a=n[2]+n[3]+n[4],o=n[2].length+n[3].length):(a=n[2]+n[4],o=n[2].length):s?(a=n[3]+n[4],o=n[3].length):a=n[4],r==="file:"?o>=2&&(a=a.slice(2)):Sn(r)?a=n[4]:r?i&&(a=a.slice(2)):o>=2&&Sn(e.protocol)&&(a=n[4]),{protocol:r,slashes:i||Sn(r),slashesCount:o,rest:a}}function ZB(t,e){if(t==="")return e;for(var n=(e||"/").split("/").slice(0,-1).concat(t.split("/")),r=n.length,i=n[r-1],s=!1,o=0;r--;)n[r]==="."?n.splice(r,1):n[r]===".."?(n.splice(r,1),o++):o&&(r===0&&(s=!0),n.splice(r,1),o--);return s&&n.unshift(""),(i==="."||i==="..")&&n.push(""),n.join("/")}function An(t,e,n){if(t=Fy(t),t=t.replace(CT,""),!(this instanceof An))return new An(t,e,n);var r,i,s,o,a,u,c=ky.slice(),l=typeof e,d=this,h=0;for(l!=="object"&&l!=="string"&&(n=e,e=null),n&&typeof n!="function"&&(n=Kd.parse),e=TT(e),i=ST(t||"",e),r=!i.protocol&&!i.slashes,d.slashes=i.slashes||r&&e.slashes,d.protocol=i.protocol||e.protocol||"",t=i.rest,(i.protocol==="file:"&&(i.slashesCount!==2||YB.test(t))||!i.slashes&&(i.protocol||i.slashesCount<2||!Sn(d.protocol)))&&(c[3]=[/(.*)/,"pathname"]);h<c.length;h++){if(o=c[h],typeof o=="function"){t=o(t,d);continue}s=o[0],u=o[1],s!==s?d[u]=t:typeof s=="string"?(a=s==="@"?t.lastIndexOf(s):t.indexOf(s),~a&&(typeof o[2]=="number"?(d[u]=t.slice(0,a),t=t.slice(a+o[2])):(d[u]=t.slice(a),t=t.slice(0,a)))):(a=s.exec(t))&&(d[u]=a[1],t=t.slice(0,a.index)),d[u]=d[u]||r&&o[3]&&e[u]||"",o[4]&&(d[u]=d[u].toLowerCase())}n&&(d.query=n(d.query)),r&&e.slashes&&d.pathname.charAt(0)!=="/"&&(d.pathname!==""||e.pathname!=="")&&(d.pathname=ZB(d.pathname,e.pathname)),d.pathname.charAt(0)!=="/"&&Sn(d.protocol)&&(d.pathname="/"+d.pathname),DT(d.port,d.protocol)||(d.host=d.hostname,d.port=""),d.username=d.password="",d.auth&&(a=d.auth.indexOf(":"),~a?(d.username=d.auth.slice(0,a),d.username=encodeURIComponent(decodeURIComponent(d.username)),d.password=d.auth.slice(a+1),d.password=encodeURIComponent(decodeURIComponent(d.password))):d.username=encodeURIComponent(decodeURIComponent(d.auth)),d.auth=d.password?d.username+":"+d.password:d.username),d.origin=d.protocol!=="file:"&&Sn(d.protocol)&&d.host?d.protocol+"//"+d.host:"null",d.href=d.toString()}function XB(t,e,n){var r=this;switch(t){case"query":typeof e=="string"&&e.length&&(e=(n||Kd.parse)(e)),r[t]=e;break;case"port":r[t]=e,DT(e,r.protocol)?e&&(r.host=r.hostname+":"+e):(r.host=r.hostname,r[t]="");break;case"hostname":r[t]=e,r.port&&(e+=":"+r.port),r.host=e;break;case"host":r[t]=e,bT.test(e)?(e=e.split(":"),r.port=e.pop(),r.hostname=e.join(":")):(r.hostname=e,r.port="");break;case"protocol":r.protocol=e.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(e){var i=t==="pathname"?"/":"#";r[t]=e.charAt(0)!==i?i+e:e}else r[t]=e;break;case"username":case"password":r[t]=encodeURIComponent(e);break;case"auth":var s=e.indexOf(":");~s?(r.username=e.slice(0,s),r.username=encodeURIComponent(decodeURIComponent(r.username)),r.password=e.slice(s+1),r.password=encodeURIComponent(decodeURIComponent(r.password))):r.username=encodeURIComponent(decodeURIComponent(e))}for(var o=0;o<ky.length;o++){var a=ky[o];a[4]&&(r[a[1]]=r[a[1]].toLowerCase())}return r.auth=r.password?r.username+":"+r.password:r.username,r.origin=r.protocol!=="file:"&&Sn(r.protocol)&&r.host?r.protocol+"//"+r.host:"null",r.href=r.toString(),r}function JB(t){(!t||typeof t!="function")&&(t=Kd.stringify);var e,n=this,r=n.host,i=n.protocol;i&&i.charAt(i.length-1)!==":"&&(i+=":");var s=i+(n.protocol&&n.slashes||Sn(n.protocol)?"//":"");return n.username?(s+=n.username,n.password&&(s+=":"+n.password),s+="@"):n.password?(s+=":"+n.password,s+="@"):n.protocol!=="file:"&&Sn(n.protocol)&&!r&&n.pathname!=="/"&&(s+="@"),(r[r.length-1]===":"||bT.test(n.hostname)&&!n.port)&&(r+=":"),s+=r+n.pathname,e=typeof n.query=="object"?t(n.query):n.query,e&&(s+=e.charAt(0)!=="?"?"?"+e:e),n.hash&&(s+=n.hash),s}An.prototype={set:XB,toString:JB};An.extractProtocol=ST;An.location=TT;An.trimLeft=Fy;An.qs=Kd;AT.exports=An});var At=P((oQ,xT)=>{"use strict";var eU=Vy(),tU=function(){};xT.exports={getOrigin:function(t){if(!t)return null;var e=new eU(t);if(e.protocol==="file:")return null;var n=e.port;return n||(n=e.protocol==="https:"?"443":"80"),e.protocol+"//"+e.hostname+":"+n},isOriginEqual:function(t,e){var n=this.getOrigin(t)===this.getOrigin(e);return tU("same",t,e,n),n},isSchemeEqual:function(t,e){return t.split(":")[0]===e.split(":")[0]},addPath:function(t,e){var n=t.split("?");return n[0]+e+(n[1]?"?"+n[1]:"")},addQuery:function(t,e){return t+(t.indexOf("?")===-1?"?"+e:"&"+e)},isLoopbackAddr:function(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^\[::1\]$/.test(t)}}});var se=P((aQ,Ly)=>{"use strict";typeof Object.create=="function"?Ly.exports=function(e,n){n&&(e.super_=n,e.prototype=Object.create(n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Ly.exports=function(e,n){if(n){e.super_=n;var r=function(){};r.prototype=n.prototype,e.prototype=new r,e.prototype.constructor=e}}});var jy=P((uQ,MT)=>{"use strict";function Qd(){this._listeners={}}Qd.prototype.addEventListener=function(t,e){t in this._listeners||(this._listeners[t]=[]);var n=this._listeners[t];n.indexOf(e)===-1&&(n=n.concat([e])),this._listeners[t]=n};Qd.prototype.removeEventListener=function(t,e){var n=this._listeners[t];if(n){var r=n.indexOf(e);if(r!==-1){n.length>1?this._listeners[t]=n.slice(0,r).concat(n.slice(r+1)):delete this._listeners[t];return}}};Qd.prototype.dispatchEvent=function(){var t=arguments[0],e=t.type,n=arguments.length===1?[t]:Array.apply(null,arguments);if(this["on"+e]&&this["on"+e].apply(this,n),e in this._listeners)for(var r=this._listeners[e],i=0;i<r.length;i++)r[i].apply(this,n)};MT.exports=Qd});var nt=P((cQ,RT)=>{"use strict";var nU=se(),Yd=jy();function Fr(){Yd.call(this)}nU(Fr,Yd);Fr.prototype.removeAllListeners=function(t){t?delete this._listeners[t]:this._listeners={}};Fr.prototype.once=function(t,e){var n=this,r=!1;function i(){n.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}this.on(t,i)};Fr.prototype.emit=function(){var t=arguments[0],e=this._listeners[t];if(e){for(var n=arguments.length,r=new Array(n-1),i=1;i<n;i++)r[i-1]=arguments[i];for(var s=0;s<e.length;s++)e[s].apply(this,r)}};Fr.prototype.on=Fr.prototype.addListener=Yd.prototype.addEventListener;Fr.prototype.removeListener=Yd.prototype.removeEventListener;RT.exports.EventEmitter=Fr});var PT=P((lQ,By)=>{"use strict";var NT=global.WebSocket||global.MozWebSocket;NT?By.exports=function(e){return new NT(e)}:By.exports=void 0});var LT=P((dQ,VT)=>{"use strict";var OT=nr(),rU=At(),iU=se(),kT=nt().EventEmitter,FT=PT(),rr=function(){};function ir(t,e,n){if(!ir.enabled())throw new Error("Transport created when disabled");kT.call(this),rr("constructor",t);var r=this,i=rU.addPath(t,"/websocket");i.slice(0,5)==="https"?i="wss"+i.slice(5):i="ws"+i.slice(4),this.url=i,this.ws=new FT(this.url,[],n),this.ws.onmessage=function(s){rr("message event",s.data),r.emit("message",s.data)},this.unloadRef=OT.unloadAdd(function(){rr("unload"),r.ws.close()}),this.ws.onclose=function(s){rr("close event",s.code,s.reason),r.emit("close",s.code,s.reason),r._cleanup()},this.ws.onerror=function(s){rr("error event",s),r.emit("close",1006,"WebSocket connection broken"),r._cleanup()}}iU(ir,kT);ir.prototype.send=function(t){var e="["+t+"]";rr("send",e),this.ws.send(e)};ir.prototype.close=function(){rr("close");var t=this.ws;this._cleanup(),t&&t.close()};ir.prototype._cleanup=function(){rr("_cleanup");var t=this.ws;t&&(t.onmessage=t.onclose=t.onerror=null),OT.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()};ir.enabled=function(){return rr("enabled"),!!FT};ir.transportName="websocket";ir.roundTrips=2;VT.exports=ir});var UT=P((hQ,BT)=>{"use strict";var sU=se(),jT=nt().EventEmitter,sr=function(){};function Fi(t,e){sr(t),jT.call(this),this.sendBuffer=[],this.sender=e,this.url=t}sU(Fi,jT);Fi.prototype.send=function(t){sr("send",t),this.sendBuffer.push(t),this.sendStop||this.sendSchedule()};Fi.prototype.sendScheduleWait=function(){sr("sendScheduleWait");var t=this,e;this.sendStop=function(){sr("sendStop"),t.sendStop=null,clearTimeout(e)},e=setTimeout(function(){sr("timeout"),t.sendStop=null,t.sendSchedule()},25)};Fi.prototype.sendSchedule=function(){sr("sendSchedule",this.sendBuffer.length);var t=this;if(this.sendBuffer.length>0){var e="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,e,function(n){t.sendStop=null,n?(sr("error",n),t.emit("close",n.code||1006,"Sending error: "+n),t.close()):t.sendScheduleWait()}),this.sendBuffer=[]}};Fi.prototype._cleanup=function(){sr("_cleanup"),this.removeAllListeners()};Fi.prototype.close=function(){sr("close"),this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)};BT.exports=Fi});var HT=P((fQ,qT)=>{"use strict";var oU=se(),$T=nt().EventEmitter,yu=function(){};function Zd(t,e,n){yu(e),$T.call(this),this.Receiver=t,this.receiveUrl=e,this.AjaxObject=n,this._scheduleReceiver()}oU(Zd,$T);Zd.prototype._scheduleReceiver=function(){yu("_scheduleReceiver");var t=this,e=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);e.on("message",function(n){yu("message",n),t.emit("message",n)}),e.once("close",function(n,r){yu("close",n,r,t.pollIsClosing),t.poll=e=null,t.pollIsClosing||(r==="network"?t._scheduleReceiver():(t.emit("close",n||1006,r),t.removeAllListeners()))})};Zd.prototype.abort=function(){yu("abort"),this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()};qT.exports=Zd});var qy=P((pQ,GT)=>{"use strict";var aU=se(),uU=At(),Uy=UT(),cU=HT(),Xd=function(){};function $y(t,e,n,r,i){var s=uU.addPath(t,e);Xd(s);var o=this;Uy.call(this,t,n),this.poll=new cU(r,s,i),this.poll.on("message",function(a){Xd("poll message",a),o.emit("message",a)}),this.poll.once("close",function(a,u){Xd("poll close",a,u),o.poll=null,o.emit("close",a,u),o.close()})}aU($y,Uy);$y.prototype.close=function(){Uy.prototype.close.call(this),Xd("close"),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)};GT.exports=$y});var Vi=P((gQ,KT)=>{"use strict";var lU=se(),dU=At(),zT=qy(),Hy=function(){};function hU(t){return function(e,n,r){Hy("create ajax sender",e,n);var i={};typeof n=="string"&&(i.headers={"Content-type":"text/plain"});var s=dU.addPath(e,"/xhr_send"),o=new t("POST",s,n,i);return o.once("finish",function(a){if(Hy("finish",a),o=null,a!==200&&a!==204)return r(new Error("http status "+a));r()}),function(){Hy("abort"),o.close(),o=null;var a=new Error("Aborted");a.code=1e3,r(a)}}}function WT(t,e,n,r){zT.call(this,t,e,hU(r),n,r)}lU(WT,zT);KT.exports=WT});var _u=P((mQ,YT)=>{"use strict";var fU=se(),QT=nt().EventEmitter,Vr=function(){};function vu(t,e){Vr(t),QT.call(this);var n=this;this.bufferPosition=0,this.xo=new e("POST",t,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(r,i){Vr("finish",r,i),n._chunkHandler(r,i),n.xo=null;var s=r===200?"network":"permanent";Vr("close",s),n.emit("close",null,s),n._cleanup()})}fU(vu,QT);vu.prototype._chunkHandler=function(t,e){if(Vr("_chunkHandler",t),!(t!==200||!e))for(var n=-1;;this.bufferPosition+=n+1){var r=e.slice(this.bufferPosition);if(n=r.indexOf(`
`),n===-1)break;var i=r.slice(0,n);i&&(Vr("message",i),this.emit("message",i))}};vu.prototype._cleanup=function(){Vr("_cleanup"),this.removeAllListeners()};vu.prototype.abort=function(){Vr("abort"),this.xo&&(this.xo.close(),Vr("close"),this.emit("close",null,"user"),this.xo=null),this._cleanup()};YT.exports=vu});var Gy=P((yQ,tS)=>{"use strict";var XT=nt().EventEmitter,pU=se(),JT=nr(),gU=At(),wu=global.XMLHttpRequest,vt=function(){};function xn(t,e,n,r){vt(t,e);var i=this;XT.call(this),setTimeout(function(){i._start(t,e,n,r)},0)}pU(xn,XT);xn.prototype._start=function(t,e,n,r){var i=this;try{this.xhr=new wu}catch{}if(!this.xhr){vt("no xhr"),this.emit("finish",0,"no xhr support"),this._cleanup();return}e=gU.addQuery(e,"t="+ +new Date),this.unloadRef=JT.unloadAdd(function(){vt("unload cleanup"),i._cleanup(!0)});try{this.xhr.open(t,e,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){vt("xhr timeout"),i.emit("finish",0,""),i._cleanup(!1)})}catch(o){vt("exception",o),this.emit("finish",0,""),this._cleanup(!1);return}if((!r||!r.noCredentials)&&xn.supportsCORS&&(vt("withCredentials"),this.xhr.withCredentials=!0),r&&r.headers)for(var s in r.headers)this.xhr.setRequestHeader(s,r.headers[s]);this.xhr.onreadystatechange=function(){if(i.xhr){var o=i.xhr,a,u;switch(vt("readyState",o.readyState),o.readyState){case 3:try{u=o.status,a=o.responseText}catch{}vt("status",u),u===1223&&(u=204),u===200&&a&&a.length>0&&(vt("chunk"),i.emit("chunk",u,a));break;case 4:u=o.status,vt("status",u),u===1223&&(u=204),(u===12005||u===12029)&&(u=0),vt("finish",u,o.responseText),i.emit("finish",u,o.responseText),i._cleanup(!1);break}}};try{i.xhr.send(n)}catch{i.emit("finish",0,""),i._cleanup(!1)}};xn.prototype._cleanup=function(t){if(vt("cleanup"),!!this.xhr){if(this.removeAllListeners(),JT.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),t)try{this.xhr.abort()}catch{}this.unloadRef=this.xhr=null}};xn.prototype.close=function(){vt("close"),this._cleanup(!0)};xn.enabled=!!wu;var ZT=["Active"].concat("Object").join("X");!xn.enabled&&ZT in global&&(vt("overriding xmlhttprequest"),wu=function(){try{return new global[ZT]("Microsoft.XMLHTTP")}catch{return null}},xn.enabled=!!new wu);var eS=!1;try{eS="withCredentials"in new wu}catch{}xn.supportsCORS=eS;tS.exports=xn});var Eu=P((vQ,nS)=>{"use strict";var mU=se(),Jd=Gy();function zy(t,e,n,r){Jd.call(this,t,e,n,r)}mU(zy,Jd);zy.enabled=Jd.enabled&&Jd.supportsCORS;nS.exports=zy});var ao=P((_Q,rS)=>{"use strict";var yU=se(),Wy=Gy();function Ky(t,e,n){Wy.call(this,t,e,n,{noCredentials:!0})}yU(Ky,Wy);Ky.enabled=Wy.enabled;rS.exports=Ky});var uo=P((wQ,iS)=>{"use strict";iS.exports={isOpera:function(){return global.navigator&&/opera/i.test(global.navigator.userAgent)},isKonqueror:function(){return global.navigator&&/konqueror/i.test(global.navigator.userAgent)},hasDomain:function(){if(!global.document)return!0;try{return!!global.document.domain}catch{return!1}}}});var aS=P((EQ,oS)=>{"use strict";var vU=se(),sS=Vi(),_U=_u(),Qy=Eu(),wU=ao(),EU=uo();function co(t){if(!wU.enabled&&!Qy.enabled)throw new Error("Transport created when disabled");sS.call(this,t,"/xhr_streaming",_U,Qy)}vU(co,sS);co.enabled=function(t){return t.nullOrigin||EU.isOpera()?!1:Qy.enabled};co.transportName="xhr-streaming";co.roundTrips=2;co.needBody=!!global.document;oS.exports=co});var eh=P((IQ,lS)=>{"use strict";var uS=nt().EventEmitter,IU=se(),cS=nr(),DU=uo(),CU=At(),Lr=function(){};function Li(t,e,n){Lr(t,e);var r=this;uS.call(this),setTimeout(function(){r._start(t,e,n)},0)}IU(Li,uS);Li.prototype._start=function(t,e,n){Lr("_start");var r=this,i=new global.XDomainRequest;e=CU.addQuery(e,"t="+ +new Date),i.onerror=function(){Lr("onerror"),r._error()},i.ontimeout=function(){Lr("ontimeout"),r._error()},i.onprogress=function(){Lr("progress",i.responseText),r.emit("chunk",200,i.responseText)},i.onload=function(){Lr("load"),r.emit("finish",200,i.responseText),r._cleanup(!1)},this.xdr=i,this.unloadRef=cS.unloadAdd(function(){r._cleanup(!0)});try{this.xdr.open(t,e),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(n)}catch{this._error()}};Li.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)};Li.prototype._cleanup=function(t){if(Lr("cleanup",t),!!this.xdr){if(this.removeAllListeners(),cS.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,t)try{this.xdr.abort()}catch{}this.unloadRef=this.xdr=null}};Li.prototype.close=function(){Lr("close"),this._cleanup(!0)};Li.enabled=!!(global.XDomainRequest&&DU.hasDomain());lS.exports=Li});var Zy=P((DQ,hS)=>{"use strict";var bU=se(),dS=Vi(),TU=_u(),Yy=eh();function Iu(t){if(!Yy.enabled)throw new Error("Transport created when disabled");dS.call(this,t,"/xhr_streaming",TU,Yy)}bU(Iu,dS);Iu.enabled=function(t){return t.cookie_needed||t.nullOrigin?!1:Yy.enabled&&t.sameScheme};Iu.transportName="xdr-streaming";Iu.roundTrips=2;hS.exports=Iu});var Xy=P((CQ,fS)=>{"use strict";fS.exports=global.EventSource});var mS=P((bQ,gS)=>{"use strict";var SU=se(),pS=nt().EventEmitter,AU=Xy(),lo=function(){};function Du(t){lo(t),pS.call(this);var e=this,n=this.es=new AU(t);n.onmessage=function(r){lo("message",r.data),e.emit("message",decodeURI(r.data))},n.onerror=function(r){lo("error",n.readyState,r);var i=n.readyState!==2?"network":"permanent";e._cleanup(),e._close(i)}}SU(Du,pS);Du.prototype.abort=function(){lo("abort"),this._cleanup(),this._close("user")};Du.prototype._cleanup=function(){lo("cleanup");var t=this.es;t&&(t.onmessage=t.onerror=null,t.close(),this.es=null)};Du.prototype._close=function(t){lo("close",t);var e=this;setTimeout(function(){e.emit("close",null,t),e.removeAllListeners()},200)};gS.exports=Du});var Jy=P((TQ,vS)=>{"use strict";var xU=se(),yS=Vi(),MU=mS(),RU=Eu(),NU=Xy();function ho(t){if(!ho.enabled())throw new Error("Transport created when disabled");yS.call(this,t,"/eventsource",MU,RU)}xU(ho,yS);ho.enabled=function(){return!!NU};ho.transportName="eventsource";ho.roundTrips=2;vS.exports=ho});var ev=P((SQ,_S)=>{"use strict";_S.exports="1.6.1"});var fo=P((AQ,or)=>{"use strict";var th=nr(),PU=uo(),ji=function(){};or.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){or.exports.WPrefix in global||(global[or.exports.WPrefix]={})},postMessage:function(t,e){global.parent!==global?global.parent.postMessage(JSON.stringify({windowId:or.exports.currentWindowId,type:t,data:e||""}),"*"):ji("Cannot postMessage, no parent window.",t,e)},createIframe:function(t,e){var n=global.document.createElement("iframe"),r,i,s=function(){ji("unattach"),clearTimeout(r);try{n.onload=null}catch{}n.onerror=null},o=function(){ji("cleanup"),n&&(s(),setTimeout(function(){n&&n.parentNode.removeChild(n),n=null},0),th.unloadDel(i))},a=function(c){ji("onerror",c),n&&(o(),e(c))},u=function(c,l){ji("post",c,l),setTimeout(function(){try{n&&n.contentWindow&&n.contentWindow.postMessage(c,l)}catch{}},0)};return n.src=t,n.style.display="none",n.style.position="absolute",n.onerror=function(){a("onerror")},n.onload=function(){ji("onload"),clearTimeout(r),r=setTimeout(function(){a("onload timeout")},2e3)},global.document.body.appendChild(n),r=setTimeout(function(){a("timeout")},15e3),i=th.unloadAdd(o),{post:u,cleanup:o,loaded:s}},createHtmlfile:function(t,e){var n=["Active"].concat("Object").join("X"),r=new global[n]("htmlfile"),i,s,o,a=function(){clearTimeout(i),o.onerror=null},u=function(){r&&(a(),th.unloadDel(s),o.parentNode.removeChild(o),o=r=null,CollectGarbage())},c=function(h){ji("onerror",h),r&&(u(),e(h))},l=function(h,f){try{setTimeout(function(){o&&o.contentWindow&&o.contentWindow.postMessage(h,f)},0)}catch{}};r.open(),r.write('<html><script>document.domain="'+global.document.domain+'";<\/script></html>'),r.close(),r.parentWindow[or.exports.WPrefix]=global[or.exports.WPrefix];var d=r.createElement("div");return r.body.appendChild(d),o=r.createElement("iframe"),d.appendChild(o),o.src=t,o.onerror=function(){c("onerror")},i=setTimeout(function(){c("timeout")},15e3),s=th.unloadAdd(u),{post:l,cleanup:u,loaded:a}}};or.exports.iframeEnabled=!1;global.document&&(or.exports.iframeEnabled=(typeof global.postMessage=="function"||typeof global.postMessage=="object")&&!PU.isKonqueror())});var nv=P((xQ,DS)=>{"use strict";var OU=se(),wS=nt().EventEmitter,kU=ev(),tv=At(),ES=fo(),IS=nr(),FU=ki(),Mn=function(){};function Rn(t,e,n){if(!Rn.enabled())throw new Error("Transport created when disabled");wS.call(this);var r=this;this.origin=tv.getOrigin(n),this.baseUrl=n,this.transUrl=e,this.transport=t,this.windowId=FU.string(8);var i=tv.addPath(n,"/iframe.html")+"#"+this.windowId;Mn(t,e,i),this.iframeObj=ES.createIframe(i,function(s){Mn("err callback"),r.emit("close",1006,"Unable to load an iframe ("+s+")"),r.close()}),this.onmessageCallback=this._message.bind(this),IS.attachEvent("message",this.onmessageCallback)}OU(Rn,wS);Rn.prototype.close=function(){if(Mn("close"),this.removeAllListeners(),this.iframeObj){IS.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch{}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}};Rn.prototype._message=function(t){if(Mn("message",t.data),!tv.isOriginEqual(t.origin,this.origin)){Mn("not same origin",t.origin,this.origin);return}var e;try{e=JSON.parse(t.data)}catch{Mn("bad json",t.data);return}if(e.windowId!==this.windowId){Mn("mismatched window id",e.windowId,this.windowId);return}switch(e.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([kU,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",e.data);break;case"c":var n;try{n=JSON.parse(e.data)}catch{Mn("bad json",e.data);return}this.emit("close",n[0],n[1]),this.close();break}};Rn.prototype.postMessage=function(t,e){Mn("postMessage",t,e),this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:t,data:e||""}),this.origin)};Rn.prototype.send=function(t){Mn("send",t),this.postMessage("m",t)};Rn.enabled=function(){return ES.iframeEnabled};Rn.transportName="iframe";Rn.roundTrips=2;DS.exports=Rn});var nh=P((MQ,CS)=>{"use strict";CS.exports={isObject:function(t){var e=typeof t;return e==="function"||e==="object"&&!!t},extend:function(t){if(!this.isObject(t))return t;for(var e,n,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}}});var ih=P((RQ,bS)=>{"use strict";var VU=se(),rh=nv(),LU=nh();bS.exports=function(t){function e(n,r){rh.call(this,t.transportName,n,r)}return VU(e,rh),e.enabled=function(n,r){if(!global.document)return!1;var i=LU.extend({},r);return i.sameOrigin=!0,t.enabled(i)&&rh.enabled()},e.transportName="iframe-"+t.transportName,e.needBody=!0,e.roundTrips=rh.roundTrips+t.roundTrips-1,e.facadeTransport=t,e}});var xS=P((NQ,AS)=>{"use strict";var jU=se(),Bi=fo(),BU=At(),SS=nt().EventEmitter,UU=ki(),ar=function(){};function an(t){ar(t),SS.call(this);var e=this;Bi.polluteGlobalNamespace(),this.id="a"+UU.string(6),t=BU.addQuery(t,"c="+decodeURIComponent(Bi.WPrefix+"."+this.id)),ar("using htmlfile",an.htmlfileEnabled);var n=an.htmlfileEnabled?Bi.createHtmlfile:Bi.createIframe;global[Bi.WPrefix][this.id]={start:function(){ar("start"),e.iframeObj.loaded()},message:function(r){ar("message",r),e.emit("message",r)},stop:function(){ar("stop"),e._cleanup(),e._close("network")}},this.iframeObj=n(t,function(){ar("callback"),e._cleanup(),e._close("permanent")})}jU(an,SS);an.prototype.abort=function(){ar("abort"),this._cleanup(),this._close("user")};an.prototype._cleanup=function(){ar("_cleanup"),this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete global[Bi.WPrefix][this.id]};an.prototype._close=function(t){ar("_close",t),this.emit("close",null,t),this.removeAllListeners()};an.htmlfileEnabled=!1;var TS=["Active"].concat("Object").join("X");if(TS in global)try{an.htmlfileEnabled=!!new global[TS]("htmlfile")}catch{}an.enabled=an.htmlfileEnabled||Bi.iframeEnabled;AS.exports=an});var iv=P((PQ,RS)=>{"use strict";var $U=se(),rv=xS(),qU=ao(),MS=Vi();function Cu(t){if(!rv.enabled)throw new Error("Transport created when disabled");MS.call(this,t,"/htmlfile",rv,qU)}$U(Cu,MS);Cu.enabled=function(t){return rv.enabled&&t.sameOrigin};Cu.transportName="htmlfile";Cu.roundTrips=2;RS.exports=Cu});var ov=P((OQ,OS)=>{"use strict";var HU=se(),NS=Vi(),GU=_u(),sv=Eu(),PS=ao();function bu(t){if(!PS.enabled&&!sv.enabled)throw new Error("Transport created when disabled");NS.call(this,t,"/xhr",GU,sv)}HU(bu,NS);bu.enabled=function(t){return t.nullOrigin?!1:PS.enabled&&t.sameOrigin?!0:sv.enabled};bu.transportName="xhr-polling";bu.roundTrips=2;OS.exports=bu});var LS=P((kQ,VS)=>{"use strict";var zU=se(),FS=Vi(),WU=Zy(),KU=_u(),kS=eh();function Tu(t){if(!kS.enabled)throw new Error("Transport created when disabled");FS.call(this,t,"/xhr",KU,kS)}zU(Tu,FS);Tu.enabled=WU.enabled;Tu.transportName="xdr-polling";Tu.roundTrips=2;VS.exports=Tu});var $S=P((FQ,US)=>{"use strict";var Su=fo(),jS=ki(),QU=uo(),YU=At(),ZU=se(),BS=nt().EventEmitter,un=function(){};function Gt(t){un(t);var e=this;BS.call(this),Su.polluteGlobalNamespace(),this.id="a"+jS.string(6);var n=YU.addQuery(t,"c="+encodeURIComponent(Su.WPrefix+"."+this.id));global[Su.WPrefix][this.id]=this._callback.bind(this),this._createScript(n),this.timeoutId=setTimeout(function(){un("timeout"),e._abort(new Error("JSONP script loaded abnormally (timeout)"))},Gt.timeout)}ZU(Gt,BS);Gt.prototype.abort=function(){if(un("abort"),global[Su.WPrefix][this.id]){var t=new Error("JSONP user aborted read");t.code=1e3,this._abort(t)}};Gt.timeout=35e3;Gt.scriptErrorTimeout=1e3;Gt.prototype._callback=function(t){un("_callback",t),this._cleanup(),!this.aborting&&(t&&(un("message",t),this.emit("message",t)),this.emit("close",null,"network"),this.removeAllListeners())};Gt.prototype._abort=function(t){un("_abort",t),this._cleanup(),this.aborting=!0,this.emit("close",t.code,t.message),this.removeAllListeners()};Gt.prototype._cleanup=function(){if(un("_cleanup"),clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var t=this.script;t.parentNode.removeChild(t),t.onreadystatechange=t.onerror=t.onload=t.onclick=null,this.script=null}delete global[Su.WPrefix][this.id]};Gt.prototype._scriptError=function(){un("_scriptError");var t=this;this.errorTimer||(this.errorTimer=setTimeout(function(){t.loadedOkay||t._abort(new Error("JSONP script loaded abnormally (onerror)"))},Gt.scriptErrorTimeout))};Gt.prototype._createScript=function(t){un("_createScript",t);var e=this,n=this.script=global.document.createElement("script"),r;if(n.id="a"+jS.string(8),n.src=t,n.type="text/javascript",n.charset="UTF-8",n.onerror=this._scriptError.bind(this),n.onload=function(){un("onload"),e._abort(new Error("JSONP script loaded abnormally (onload)"))},n.onreadystatechange=function(){if(un("onreadystatechange",n.readyState),/loaded|closed/.test(n.readyState)){if(n&&n.htmlFor&&n.onclick){e.loadedOkay=!0;try{n.onclick()}catch{}}n&&e._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},typeof n.async>"u"&&global.document.attachEvent)if(QU.isOpera())r=this.script2=global.document.createElement("script"),r.text="try{var a = document.getElementById('"+n.id+"'); if(a)a.onerror();}catch(x){};",n.async=r.async=!1;else{try{n.htmlFor=n.id,n.event="onclick"}catch{}n.async=!0}typeof n.async<"u"&&(n.async=!0);var i=global.document.getElementsByTagName("head")[0];i.insertBefore(n,i.firstChild),r&&i.insertBefore(r,i.firstChild)};US.exports=Gt});var GS=P((VQ,HS)=>{"use strict";var XU=ki(),qS=At(),ur=function(){},xt,Au;function JU(t){ur("createIframe",t);try{return global.document.createElement('<iframe name="'+t+'">')}catch{var e=global.document.createElement("iframe");return e.name=t,e}}function e$(){ur("createForm"),xt=global.document.createElement("form"),xt.style.display="none",xt.style.position="absolute",xt.method="POST",xt.enctype="application/x-www-form-urlencoded",xt.acceptCharset="UTF-8",Au=global.document.createElement("textarea"),Au.name="d",xt.appendChild(Au),global.document.body.appendChild(xt)}HS.exports=function(t,e,n){ur(t,e),xt||e$();var r="a"+XU.string(8);xt.target=r,xt.action=qS.addQuery(qS.addPath(t,"/jsonp_send"),"i="+r);var i=JU(r);i.id=r,i.style.display="none",xt.appendChild(i);try{Au.value=e}catch{}xt.submit();var s=function(o){ur("completed",r,o),i.onerror&&(i.onreadystatechange=i.onerror=i.onload=null,setTimeout(function(){ur("cleaning up",r),i.parentNode.removeChild(i),i=null},500),Au.value="",n(o))};return i.onerror=function(){ur("onerror",r),s()},i.onload=function(){ur("onload",r),s()},i.onreadystatechange=function(o){ur("onreadystatechange",r,i.readyState,o),i.readyState==="complete"&&s()},function(){ur("aborted",r),s(new Error("Aborted"))}}});var KS=P((LQ,WS)=>{"use strict";var t$=se(),zS=qy(),n$=$S(),r$=GS();function Ui(t){if(!Ui.enabled())throw new Error("Transport created when disabled");zS.call(this,t,"/jsonp",r$,n$)}t$(Ui,zS);Ui.enabled=function(){return!!global.document};Ui.transportName="jsonp-polling";Ui.roundTrips=1;Ui.needBody=!0;WS.exports=Ui});var YS=P((jQ,QS)=>{"use strict";QS.exports=[LT(),aS(),Zy(),Jy(),ih()(Jy()),iv(),ih()(iv()),ov(),LS(),ih()(ov()),KS()]});var rA=P(()=>{"use strict";var xu=Array.prototype,lv=Object.prototype,i$=Function.prototype,Mu=String.prototype,av=xu.slice,dv=lv.toString,JS=function(t){return lv.toString.call(t)==="[object Function]"},s$=function(e){return dv.call(e)==="[object Array]"},eA=function(e){return dv.call(e)==="[object String]"},o$=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch{return!1}}(),cv;o$?cv=function(t,e,n,r){!r&&e in t||Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:!0,value:n})}:cv=function(t,e,n,r){!r&&e in t||(t[e]=n)};var Ru=function(t,e,n){for(var r in e)lv.hasOwnProperty.call(e,r)&&cv(t,r,e[r],n)},tA=function(t){if(t==null)throw new TypeError("can't convert "+t+" to object");return Object(t)};function a$(t){var e=+t;return e!==e?e=0:e!==0&&e!==1/0&&e!==-1/0&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e}function u$(t){return t>>>0}function uv(){}Ru(i$,{bind:function(e){var n=this;if(!JS(n))throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var r=av.call(arguments,1),i=function(){if(this instanceof u){var c=n.apply(this,r.concat(av.call(arguments)));return Object(c)===c?c:this}else return n.apply(e,r.concat(av.call(arguments)))},s=Math.max(0,n.length-r.length),o=[],a=0;a<s;a++)o.push("$"+a);var u=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this, arguments); }")(i);return n.prototype&&(uv.prototype=n.prototype,u.prototype=new uv,uv.prototype=null),u}});Ru(Array,{isArray:s$});var ZS=Object("a"),nA=ZS[0]!=="a"||!(0 in ZS),c$=function(e){var n=!0,r=!0;return e&&(e.call("foo",function(i,s,o){typeof o!="object"&&(n=!1)}),e.call([1],function(){"use strict";r=typeof this=="string"},"x")),!!e&&n&&r};Ru(xu,{forEach:function(e){var n=tA(this),r=nA&&eA(this)?this.split(""):n,i=arguments[1],s=-1,o=r.length>>>0;if(!JS(e))throw new TypeError;for(;++s<o;)s in r&&e.call(i,r[s],s,n)}},!c$(xu.forEach));var l$=Array.prototype.indexOf&&[0,1].indexOf(1,2)!==-1;Ru(xu,{indexOf:function(e){var n=nA&&eA(this)?this.split(""):tA(this),r=n.length>>>0;if(!r)return-1;var i=0;for(arguments.length>1&&(i=a$(arguments[1])),i=i>=0?i:Math.max(0,r+i);i<r;i++)if(i in n&&n[i]===e)return i;return-1}},l$);var XS=Mu.split;"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1?function(){var t=/()??/.exec("")[1]===void 0;Mu.split=function(e,n){var r=this;if(e===void 0&&n===0)return[];if(dv.call(e)!=="[object RegExp]")return XS.call(this,e,n);var i=[],s=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),o=0,a,u,c,l;for(e=new RegExp(e.source,s+"g"),r+="",t||(a=new RegExp("^"+e.source+"$(?!\\s)",s)),n=n===void 0?-1>>>0:u$(n);(u=e.exec(r))&&(c=u.index+u[0].length,!(c>o&&(i.push(r.slice(o,u.index)),!t&&u.length>1&&u[0].replace(a,function(){for(var d=1;d<arguments.length-2;d++)arguments[d]===void 0&&(u[d]=void 0)}),u.length>1&&u.index<r.length&&xu.push.apply(i,u.slice(1)),l=u[0].length,o=c,i.length>=n)));)e.lastIndex===u.index&&e.lastIndex++;return o===r.length?(l||!e.test(""))&&i.push(""):i.push(r.slice(o)),i.length>n?i.slice(0,n):i}}():"0".split(void 0,0).length&&(Mu.split=function(e,n){return e===void 0&&n===0?[]:XS.call(this,e,n)});var d$=Mu.substr,h$="".substr&&"0b".substr(-1)!=="b";Ru(Mu,{substr:function(e,n){return d$.call(this,e<0&&(e=this.length+e)<0?0:e,n)}},h$)});var sA=P(($Q,iA)=>{"use strict";var sh=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,hv,f$=function(t){var e,n={},r=[];for(e=0;e<65536;e++)r.push(String.fromCharCode(e));return t.lastIndex=0,r.join("").replace(t,function(i){return n[i]="\\u"+("0000"+i.charCodeAt(0).toString(16)).slice(-4),""}),t.lastIndex=0,n};iA.exports={quote:function(t){var e=JSON.stringify(t);return sh.lastIndex=0,sh.test(e)?(hv||(hv=f$(sh)),e.replace(sh,function(n){return hv[n]})):e}}});var aA=P((qQ,oA)=>{"use strict";var oh=function(){};oA.exports=function(t){return{filterToEnabled:function(e,n){var r={main:[],facade:[]};return e?typeof e=="string"&&(e=[e]):e=[],t.forEach(function(i){if(i){if(i.transportName==="websocket"&&n.websocket===!1){oh("disabled from server","websocket");return}if(e.length&&e.indexOf(i.transportName)===-1){oh("not in whitelist",i.transportName);return}i.enabled(n)?(oh("enabled",i.transportName),r.main.push(i),i.facadeTransport&&r.facade.push(i.facadeTransport)):oh("disabled",i.transportName)}}),r}}}});var cA=P((HQ,uA)=>{"use strict";var fv={};["log","debug","warn"].forEach(function(t){var e;try{e=global.console&&global.console[t]&&global.console[t].apply}catch{}fv[t]=e?function(){return global.console[t].apply(global.console,arguments)}:t==="log"?function(){}:fv.log});uA.exports=fv});var ah=P((GQ,lA)=>{"use strict";function $i(t){this.type=t}$i.prototype.initEvent=function(t,e,n){return this.type=t,this.bubbles=e,this.cancelable=n,this.timeStamp=+new Date,this};$i.prototype.stopPropagation=function(){};$i.prototype.preventDefault=function(){};$i.CAPTURING_PHASE=1;$i.AT_TARGET=2;$i.BUBBLING_PHASE=3;lA.exports=$i});var pv=P((zQ,dA)=>{"use strict";dA.exports=global.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}});var gA=P((WQ,pA)=>{"use strict";var p$=se(),hA=ah();function fA(){hA.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}p$(fA,hA);pA.exports=fA});var _A=P((KQ,vA)=>{"use strict";var g$=se(),mA=ah();function yA(t){mA.call(this),this.initEvent("message",!1,!1),this.data=t}g$(yA,mA);vA.exports=yA});var IA=P((QQ,EA)=>{"use strict";var wA=nt().EventEmitter,m$=se();function Nu(){var t=this;wA.call(this),this.to=setTimeout(function(){t.emit("finish",200,"{}")},Nu.timeout)}m$(Nu,wA);Nu.prototype.close=function(){clearTimeout(this.to)};Nu.timeout=2e3;EA.exports=Nu});var mv=P((YQ,CA)=>{"use strict";var DA=nt().EventEmitter,y$=se(),v$=nh(),_$=function(){};function gv(t,e){DA.call(this);var n=this,r=+new Date;this.xo=new e("GET",t),this.xo.once("finish",function(i,s){var o,a;if(i===200){if(a=+new Date-r,s)try{o=JSON.parse(s)}catch{_$("bad json",s)}v$.isObject(o)||(o={})}n.emit("finish",o,a),n.removeAllListeners()})}y$(gv,DA);gv.prototype.close=function(){this.removeAllListeners(),this.xo.close()};CA.exports=gv});var yv=P((ZQ,TA)=>{"use strict";var w$=se(),bA=nt().EventEmitter,E$=ao(),I$=mv();function uh(t){var e=this;bA.call(this),this.ir=new I$(t,E$),this.ir.once("finish",function(n,r){e.ir=null,e.emit("message",JSON.stringify([n,r]))})}w$(uh,bA);uh.transportName="iframe-info-receiver";uh.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()};TA.exports=uh});var MA=P((XQ,xA)=>{"use strict";var SA=nt().EventEmitter,D$=se(),C$=nr(),AA=nv(),b$=yv(),T$=function(){};function ch(t,e){var n=this;SA.call(this);var r=function(){var i=n.ifr=new AA(b$.transportName,e,t);i.once("message",function(s){if(s){var o;try{o=JSON.parse(s)}catch{T$("bad json",s),n.emit("finish"),n.close();return}var a=o[0],u=o[1];n.emit("finish",a,u)}n.close()}),i.once("close",function(){n.emit("finish"),n.close()})};global.document.body?r():C$.attachEvent("load",r)}D$(ch,SA);ch.enabled=function(){return AA.enabled()};ch.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null};xA.exports=ch});var FA=P((JQ,kA)=>{"use strict";var OA=nt().EventEmitter,S$=se(),A$=At(),RA=eh(),NA=Eu(),x$=ao(),M$=IA(),PA=MA(),lh=mv(),po=function(){};function cr(t,e){po(t);var n=this;OA.call(this),setTimeout(function(){n.doXhr(t,e)},0)}S$(cr,OA);cr._getReceiver=function(t,e,n){return n.sameOrigin?new lh(e,x$):NA.enabled?new lh(e,NA):RA.enabled&&n.sameScheme?new lh(e,RA):PA.enabled()?new PA(t,e):new lh(e,M$)};cr.prototype.doXhr=function(t,e){var n=this,r=A$.addPath(t,"/info");po("doXhr",r),this.xo=cr._getReceiver(t,r,e),this.timeoutRef=setTimeout(function(){po("timeout"),n._cleanup(!1),n.emit("finish")},cr.timeout),this.xo.once("finish",function(i,s){po("finish",i,s),n._cleanup(!0),n.emit("finish",i,s)})};cr.prototype._cleanup=function(t){po("_cleanup"),clearTimeout(this.timeoutRef),this.timeoutRef=null,!t&&this.xo&&this.xo.close(),this.xo=null};cr.prototype.close=function(){po("close"),this.removeAllListeners(),this._cleanup(!1)};cr.timeout=8e3;kA.exports=cr});var jA=P((eY,LA)=>{"use strict";var VA=fo();function Pu(t){this._transport=t,t.on("message",this._transportMessage.bind(this)),t.on("close",this._transportClose.bind(this))}Pu.prototype._transportClose=function(t,e){VA.postMessage("c",JSON.stringify([t,e]))};Pu.prototype._transportMessage=function(t){VA.postMessage("t",t)};Pu.prototype._send=function(t){this._transport.send(t)};Pu.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()};LA.exports=Pu});var qA=P((tY,$A)=>{"use strict";var BA=At(),R$=nr(),N$=jA(),UA=yv(),vv=fo(),dh=pv(),_v=function(){};$A.exports=function(t,e){var n={};e.forEach(function(i){i.facadeTransport&&(n[i.facadeTransport.transportName]=i.facadeTransport)}),n[UA.transportName]=UA;var r;t.bootstrap_iframe=function(){var i;vv.currentWindowId=dh.hash.slice(1);var s=function(o){if(o.source===parent&&(typeof r>"u"&&(r=o.origin),o.origin===r)){var a;try{a=JSON.parse(o.data)}catch{_v("bad json",o.data);return}if(a.windowId===vv.currentWindowId)switch(a.type){case"s":var u;try{u=JSON.parse(a.data)}catch{_v("bad json",a.data);break}var c=u[0],l=u[1],d=u[2],h=u[3];if(_v(c,l,d,h),c!==t.version)throw new Error('Incompatible SockJS! Main site uses: "'+c+'", the iframe: "'+t.version+'".');if(!BA.isOriginEqual(d,dh.href)||!BA.isOriginEqual(h,dh.href))throw new Error("Can't connect to different domain from within an iframe. ("+dh.href+", "+d+", "+h+")");i=new N$(new n[l](d,h));break;case"m":i._send(a.data);break;case"c":i&&i._close(),i=null;break}}};R$.attachEvent("message",s),vv.postMessage("s")}}});var YA=P((nY,QA)=>{"use strict";rA();var P$=Vy(),O$=se(),HA=ki(),k$=sA(),Ou=At(),F$=nr(),V$=aA(),L$=nh(),j$=uo(),B$=cA(),wv=ah(),zA=jy(),hh=pv(),U$=gA(),GA=_A(),$$=FA(),ke=function(){},WA;function oe(t,e,n){if(!(this instanceof oe))return new oe(t,e,n);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");zA.call(this),this.readyState=oe.CONNECTING,this.extensions="",this.protocol="",n=n||{},n.protocols_whitelist&&B$.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=n.transports,this._transportOptions=n.transportOptions||{},this._timeout=n.timeout||0;var r=n.sessionId||8;if(typeof r=="function")this._generateSessionId=r;else if(typeof r=="number")this._generateSessionId=function(){return HA.string(r)};else throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._server=n.server||HA.numberString(1e3);var i=new P$(t);if(!i.host||!i.protocol)throw new SyntaxError("The URL '"+t+"' is invalid");if(i.hash)throw new SyntaxError("The URL must not contain a fragment");if(i.protocol!=="http:"&&i.protocol!=="https:")throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+i.protocol+"' is not allowed.");var s=i.protocol==="https:";if(hh.protocol==="https:"&&!s&&!Ou.isLoopbackAddr(i.hostname))throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");e?Array.isArray(e)||(e=[e]):e=[];var o=e.sort();o.forEach(function(u,c){if(!u)throw new SyntaxError("The protocols entry '"+u+"' is invalid.");if(c<o.length-1&&u===o[c+1])throw new SyntaxError("The protocols entry '"+u+"' is duplicated.")});var a=Ou.getOrigin(hh.href);this._origin=a?a.toLowerCase():null,i.set("pathname",i.pathname.replace(/\/+$/,"")),this.url=i.href,ke("using url",this.url),this._urlInfo={nullOrigin:!j$.hasDomain(),sameOrigin:Ou.isOriginEqual(this.url,hh.href),sameScheme:Ou.isSchemeEqual(this.url,hh.href)},this._ir=new $$(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}O$(oe,zA);function KA(t){return t===1e3||t>=3e3&&t<=4999}oe.prototype.close=function(t,e){if(t&&!KA(t))throw new Error("InvalidAccessError: Invalid code");if(e&&e.length>123)throw new SyntaxError("reason argument has an invalid length");if(!(this.readyState===oe.CLOSING||this.readyState===oe.CLOSED)){var n=!0;this._close(t||1e3,e||"Normal closure",n)}};oe.prototype.send=function(t){if(typeof t!="string"&&(t=""+t),this.readyState===oe.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===oe.OPEN&&this._transport.send(k$.quote(t))};oe.version=ev();oe.CONNECTING=0;oe.OPEN=1;oe.CLOSING=2;oe.CLOSED=3;oe.prototype._receiveInfo=function(t,e){if(ke("_receiveInfo",e),this._ir=null,!t){this._close(1002,"Cannot connect to server");return}this._rto=this.countRTO(e),this._transUrl=t.base_url?t.base_url:this.url,t=L$.extend(t,this._urlInfo),ke("info",t);var n=WA.filterToEnabled(this._transportsWhitelist,t);this._transports=n.main,ke(this._transports.length+" enabled transports"),this._connect()};oe.prototype._connect=function(){for(var t=this._transports.shift();t;t=this._transports.shift()){if(ke("attempt",t.transportName),t.needBody&&(!global.document.body||typeof global.document.readyState<"u"&&global.document.readyState!=="complete"&&global.document.readyState!=="interactive")){ke("waiting for body"),this._transports.unshift(t),F$.attachEvent("load",this._connect.bind(this));return}var e=Math.max(this._timeout,this._rto*t.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),e),ke("using timeout",e);var n=Ou.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),r=this._transportOptions[t.transportName];ke("transport url",n);var i=new t(n,this._transUrl,r);i.on("message",this._transportMessage.bind(this)),i.once("close",this._transportClose.bind(this)),i.transportName=t.transportName,this._transport=i;return}this._close(2e3,"All transports failed",!1)};oe.prototype._transportTimeout=function(){ke("_transportTimeout"),this.readyState===oe.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))};oe.prototype._transportMessage=function(t){ke("_transportMessage",t);var e=this,n=t.slice(0,1),r=t.slice(1),i;switch(n){case"o":this._open();return;case"h":this.dispatchEvent(new wv("heartbeat")),ke("heartbeat",this.transport);return}if(r)try{i=JSON.parse(r)}catch{ke("bad json",r)}if(typeof i>"u"){ke("empty payload",r);return}switch(n){case"a":Array.isArray(i)&&i.forEach(function(s){ke("message",e.transport,s),e.dispatchEvent(new GA(s))});break;case"m":ke("message",this.transport,i),this.dispatchEvent(new GA(i));break;case"c":Array.isArray(i)&&i.length===2&&this._close(i[0],i[1],!0);break}};oe.prototype._transportClose=function(t,e){if(ke("_transportClose",this.transport,t,e),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),!KA(t)&&t!==2e3&&this.readyState===oe.CONNECTING){this._connect();return}this._close(t,e)};oe.prototype._open=function(){ke("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===oe.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=oe.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new wv("open")),ke("connected",this.transport)):this._close(1006,"Server lost session")};oe.prototype._close=function(t,e,n){ke("_close",this.transport,t,e,n,this.readyState);var r=!1;if(this._ir&&(r=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===oe.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=oe.CLOSING,setTimeout((function(){this.readyState=oe.CLOSED,r&&this.dispatchEvent(new wv("error"));var i=new U$("close");i.wasClean=n||!1,i.code=t||1e3,i.reason=e,this.dispatchEvent(i),this.onmessage=this.onclose=this.onerror=null,ke("disconnected")}).bind(this),0)};oe.prototype.countRTO=function(t){return t>100?4*t:300+t};QA.exports=function(t){return WA=V$(t),qA()(oe,t),oe}});var XA=P((rY,ZA)=>{"use strict";var q$=YS();ZA.exports=YA()(q$);"_sockjs_onload"in global&&setTimeout(global._sockjs_onload,1)});var NI=null;var _p=1,PI=Symbol("SIGNAL");function Et(t){let e=NI;return NI=t,e}var OI={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function EO(t){if(!(Ip(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===_p)){if(!t.producerMustRecompute(t)&&!wp(t)){t.dirty=!1,t.lastCleanEpoch=_p;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=_p}}function kI(t){return t&&(t.nextProducerIndex=0),Et(t)}function FI(t,e){if(Et(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(Ip(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Ep(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function wp(t){Zc(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(EO(n),r!==n.version))return!0}return!1}function VI(t){if(Zc(t),Ip(t))for(let e=0;e<t.producerNode.length;e++)Ep(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Ep(t,e){if(IO(t),Zc(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)Ep(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Zc(i),i.producerIndexOfThis[r]=e}}function Ip(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Zc(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function IO(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function DO(){throw new Error}var CO=DO;function LI(t){CO=t}function $(t){return typeof t=="function"}function Es(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Xc=Es(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function ui(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Se=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if($(r))try{r()}catch(s){e=s instanceof Xc?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{jI(s)}catch(o){e=e??[],o instanceof Xc?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Xc(e)}}add(e){var n;if(e&&e!==this)if(this.closed)jI(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&ui(n,e)}remove(e){let{_finalizers:n}=this;n&&ui(n,e),e instanceof t&&e._removeParent(this)}};Se.EMPTY=(()=>{let t=new Se;return t.closed=!0,t})();var Dp=Se.EMPTY;function Jc(t){return t instanceof Se||t&&"closed"in t&&$(t.remove)&&$(t.add)&&$(t.unsubscribe)}function jI(t){$(t)?t():t.unsubscribe()}var Zt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Is={setTimeout(t,e,...n){let{delegate:r}=Is;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=Is;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function el(t){Is.setTimeout(()=>{let{onUnhandledError:e}=Zt;if(e)e(t);else throw t})}function da(){}var BI=Cp("C",void 0,void 0);function UI(t){return Cp("E",void 0,t)}function $I(t){return Cp("N",t,void 0)}function Cp(t,e,n){return{kind:t,value:e,error:n}}var ci=null;function Ds(t){if(Zt.useDeprecatedSynchronousErrorHandling){let e=!ci;if(e&&(ci={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=ci;if(ci=null,n)throw r}}else t()}function qI(t){Zt.useDeprecatedSynchronousErrorHandling&&ci&&(ci.errorThrown=!0,ci.error=t)}var li=class extends Se{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Jc(e)&&e.add(this)):this.destination=SO}static create(e,n,r){return new Gn(e,n,r)}next(e){this.isStopped?Tp($I(e),this):this._next(e)}error(e){this.isStopped?Tp(UI(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Tp(BI,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},bO=Function.prototype.bind;function bp(t,e){return bO.call(t,e)}var Sp=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){tl(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){tl(r)}else tl(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){tl(n)}}},Gn=class extends li{constructor(e,n,r){super();let i;if($(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Zt.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&bp(e.next,s),error:e.error&&bp(e.error,s),complete:e.complete&&bp(e.complete,s)}):i=e}this.destination=new Sp(i)}};function tl(t){Zt.useDeprecatedSynchronousErrorHandling?qI(t):el(t)}function TO(t){throw t}function Tp(t,e){let{onStoppedNotification:n}=Zt;n&&Is.setTimeout(()=>n(t,e))}var SO={closed:!0,next:da,error:TO,complete:da};var Cs=typeof Symbol=="function"&&Symbol.observable||"@@observable";function at(t){return t}function Ap(...t){return xp(t)}function xp(t){return t.length===0?at:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var X=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=xO(n)?n:new Gn(n,r,i);return Ds(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=HI(r),new r((i,s)=>{let o=new Gn({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Cs](){return this}pipe(...n){return xp(n)(this)}toPromise(n){return n=HI(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function HI(t){var e;return(e=t??Zt.Promise)!==null&&e!==void 0?e:Promise}function AO(t){return t&&$(t.next)&&$(t.error)&&$(t.complete)}function xO(t){return t&&t instanceof li||AO(t)&&Jc(t)}function Mp(t){return $(t?.lift)}function Q(t){return e=>{if(Mp(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Y(t,e,n,r,i){return new Rp(t,e,n,r,i)}var Rp=class extends li{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function bs(){return Q((t,e)=>{let n=null;t._refCount++;let r=Y(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Ts=class extends X{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Mp(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Se;let n=this.getSubject();e.add(this.source.subscribe(Y(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Se.EMPTY)}return e}refCount(){return bs()(this)}};var GI=Es(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ue=(()=>{class t extends X{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new nl(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new GI}next(n){Ds(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){Ds(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Ds(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Dp:(this.currentObservers=null,s.push(n),new Se(()=>{this.currentObservers=null,ui(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new X;return n.source=this,n}}return t.create=(e,n)=>new nl(e,n),t})(),nl=class extends Ue{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:Dp}};var $e=class extends Ue{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var ha={now(){return(ha.delegate||Date).now()},delegate:void 0};var rl=class extends Ue{constructor(e=1/0,n=1/0,r=ha){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}};var il=class extends Se{constructor(e,n){super()}schedule(e,n=0){return this}};var fa={setInterval(t,e,...n){let{delegate:r}=fa;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=fa;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var Ss=class extends il{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return fa.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&fa.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,ui(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var As=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};As.now=ha.now;var xs=class extends As{constructor(e,n=As.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var pa=new xs(Ss);var sl=class extends Ss{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var ol=class extends xs{};var Np=new ol(sl);var gt=new X(t=>t.complete());function zI(t){return t&&$(t.schedule)}function Pp(t){return t[t.length-1]}function al(t){return $(Pp(t))?t.pop():void 0}function yn(t){return zI(Pp(t))?t.pop():void 0}function WI(t,e){return typeof Pp(t)=="number"?t.pop():e}var ul=t=>t&&typeof t.length=="number"&&typeof t!="function";function cl(t){return $(t?.then)}function ll(t){return $(t[Cs])}function dl(t){return Symbol.asyncIterator&&$(t?.[Symbol.asyncIterator])}function hl(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function MO(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var fl=MO();function pl(t){return $(t?.[fl])}function gl(t){return CI(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield Kc(n.read());if(i)return yield Kc(void 0);yield yield Kc(r)}}finally{n.releaseLock()}})}function ml(t){return $(t?.getReader)}function ye(t){if(t instanceof X)return t;if(t!=null){if(ll(t))return RO(t);if(ul(t))return NO(t);if(cl(t))return PO(t);if(dl(t))return KI(t);if(pl(t))return OO(t);if(ml(t))return kO(t)}throw hl(t)}function RO(t){return new X(e=>{let n=t[Cs]();if($(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function NO(t){return new X(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function PO(t){return new X(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,el)})}function OO(t){return new X(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function KI(t){return new X(e=>{FO(t,e).catch(n=>e.error(n))})}function kO(t){return KI(gl(t))}function FO(t,e){var n,r,i,s;return DI(this,void 0,void 0,function*(){try{for(n=bI(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function mt(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function Ot(t,e=0){return Q((n,r)=>{n.subscribe(Y(r,i=>mt(r,t,()=>r.next(i),e),()=>mt(r,t,()=>r.complete(),e),i=>mt(r,t,()=>r.error(i),e)))})}function Xt(t,e=0){return Q((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function QI(t,e){return ye(t).pipe(Xt(e),Ot(e))}function YI(t,e){return ye(t).pipe(Xt(e),Ot(e))}function ZI(t,e){return new X(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function XI(t,e){return new X(n=>{let r;return mt(n,e,()=>{r=t[fl](),mt(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>$(r?.return)&&r.return()})}function yl(t,e){if(!t)throw new Error("Iterable cannot be null");return new X(n=>{mt(n,e,()=>{let r=t[Symbol.asyncIterator]();mt(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function JI(t,e){return yl(gl(t),e)}function eD(t,e){if(t!=null){if(ll(t))return QI(t,e);if(ul(t))return ZI(t,e);if(cl(t))return YI(t,e);if(dl(t))return yl(t,e);if(pl(t))return XI(t,e);if(ml(t))return JI(t,e)}throw hl(t)}function ue(t,e){return e?eD(t,e):ye(t)}function j(...t){let e=yn(t);return ue(t,e)}function Ms(t,e){let n=$(t)?t:()=>t,r=i=>i.error(n());return new X(e?i=>e.schedule(r,0,i):r)}function Op(t){return!!t&&(t instanceof X||$(t.lift)&&$(t.subscribe))}var zn=Es(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function V(t,e){return Q((n,r)=>{let i=0;n.subscribe(Y(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:VO}=Array;function LO(t,e){return VO(e)?t(...e):t(e)}function vl(t){return V(e=>LO(t,e))}var{isArray:jO}=Array,{getPrototypeOf:BO,prototype:UO,keys:$O}=Object;function _l(t){if(t.length===1){let e=t[0];if(jO(e))return{args:e,keys:null};if(qO(e)){let n=$O(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function qO(t){return t&&typeof t=="object"&&BO(t)===UO}function wl(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function El(...t){let e=yn(t),n=al(t),{args:r,keys:i}=_l(t);if(r.length===0)return ue([],e);let s=new X(HO(r,e,i?o=>wl(i,o):at));return n?s.pipe(vl(n)):s}function HO(t,e,n=at){return r=>{tD(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let u=0;u<i;u++)tD(e,()=>{let c=ue(t[u],e),l=!1;c.subscribe(Y(r,d=>{s[u]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function tD(t,e,n){t?mt(n,t,e):e()}function nD(t,e,n,r,i,s,o,a){let u=[],c=0,l=0,d=!1,h=()=>{d&&!u.length&&!c&&e.complete()},f=v=>c<r?m(v):u.push(v),m=v=>{s&&e.next(v),c++;let _=!1;ye(n(v,l++)).subscribe(Y(e,I=>{i?.(I),s?f(I):e.next(I)},()=>{_=!0},void 0,()=>{if(_)try{for(c--;u.length&&c<r;){let I=u.shift();o?mt(e,o,()=>m(I)):m(I)}h()}catch(I){e.error(I)}}))};return t.subscribe(Y(e,f,()=>{d=!0,h()})),()=>{a?.()}}function qe(t,e,n=1/0){return $(e)?qe((r,i)=>V((s,o)=>e(r,s,i,o))(ye(t(r,i))),n):(typeof e=="number"&&(n=e),Q((r,i)=>nD(r,i,t,n)))}function ga(t=1/0){return qe(at,t)}function rD(){return ga(1)}function Rs(...t){return rD()(ue(t,yn(t)))}function Il(t){return new X(e=>{ye(t()).subscribe(e)})}function kp(...t){let e=al(t),{args:n,keys:r}=_l(t),i=new X(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),u=o,c=o;for(let l=0;l<o;l++){let d=!1;ye(n[l]).subscribe(Y(s,h=>{d||(d=!0,c--),a[l]=h},()=>u--,void 0,()=>{(!u||!d)&&(c||s.next(r?wl(r,a):a),s.complete())}))}});return e?i.pipe(vl(e)):i}function Fp(...t){let e=yn(t),n=WI(t,1/0),r=t;return r.length?r.length===1?ye(r[0]):ga(n)(ue(r,e)):gt}function Je(t,e){return Q((n,r)=>{let i=0;n.subscribe(Y(r,s=>t.call(e,s,i++)&&r.next(s)))})}function Ir(t){return Q((e,n)=>{let r=null,i=!1,s;r=e.subscribe(Y(n,void 0,void 0,o=>{s=ye(t(o,Ir(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function iD(t,e,n,r,i){return(s,o)=>{let a=n,u=e,c=0;s.subscribe(Y(o,l=>{let d=c++;u=a?t(u,l,d):(a=!0,l),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}function Ns(t,e){return $(e)?qe(t,e,1):qe(t,1)}function Dr(t){return Q((e,n)=>{let r=!1;e.subscribe(Y(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Wn(t){return t<=0?()=>gt:Q((e,n)=>{let r=0;e.subscribe(Y(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function Vp(t){return V(()=>t)}function Lp(t,e=at){return t=t??GO,Q((n,r)=>{let i,s=!0;n.subscribe(Y(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function GO(t,e){return t===e}function Dl(t=zO){return Q((e,n)=>{let r=!1;e.subscribe(Y(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function zO(){return new zn}function ma(t){return Q((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function kt(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Je((i,s)=>t(i,s,r)):at,Wn(1),n?Dr(e):Dl(()=>new zn))}function Ps(t){return t<=0?()=>gt:Q((e,n)=>{let r=[];e.subscribe(Y(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function jp(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Je((i,s)=>t(i,s,r)):at,Ps(1),n?Dr(e):Dl(()=>new zn))}function ya(){return Q((t,e)=>{let n,r=!1;t.subscribe(Y(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function di(t,e){return Q(iD(t,e,arguments.length>=2,!0))}function sD(t={}){let{connector:e=()=>new Ue,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,c=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=u=void 0,l=d=!1},m=()=>{let v=o;f(),v?.unsubscribe()};return Q((v,_)=>{c++,!d&&!l&&h();let I=u=u??e();_.add(()=>{c--,c===0&&!d&&!l&&(a=Bp(m,i))}),I.subscribe(_),!o&&c>0&&(o=new Gn({next:M=>I.next(M),error:M=>{d=!0,h(),a=Bp(f,n,M),I.error(M)},complete:()=>{l=!0,h(),a=Bp(f,r),I.complete()}}),ye(v).subscribe(o))})(s)}}function Bp(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new Gn({next:()=>{r.unsubscribe(),t()}});return ye(e(...n)).subscribe(r)}function Cl(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,sD({connector:()=>new rl(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function hi(...t){let e=yn(t);return Q((n,r)=>{(e?Rs(t,n,e):Rs(t,n)).subscribe(r)})}function Ae(t,e){return Q((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(Y(r,u=>{i?.unsubscribe();let c=0,l=s++;ye(t(u,l)).subscribe(i=Y(r,d=>r.next(e?e(u,d,l,c++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function bl(t,e){return $(e)?Ae(()=>t,e):Ae(()=>t)}function Up(t){return Q((e,n)=>{ye(t).subscribe(Y(n,()=>n.complete(),da)),!n.closed&&e.subscribe(n)})}function Pe(t,e,n){let r=$(t)||e||n?{next:t,error:e,complete:n}:t;return r?Q((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Y(s,u=>{var c;(c=r.next)===null||c===void 0||c.call(r,u),s.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},u=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,u),s.error(u)},()=>{var u,c;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):at}var WO="https://g.co/ng/security#xss",U=class extends Error{constructor(e,n){super($g(e,n)),this.code=e}};function $g(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function fe(t){for(let e in t)if(t[e]===fe)return e;throw Error("Could not find renamed property on target object.")}function KO(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function yt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(yt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function oD(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var QO=fe({__forward_ref__:fe});function ka(t){return t.__forward_ref__=ka,t.toString=function(){return yt(this())},t}function ut(t){return qD(t)?t():t}function qD(t){return typeof t=="function"&&t.hasOwnProperty(QO)&&t.__forward_ref__===ka}function HD(t){return t&&!!t.\u0275providers}var YO=fe({\u0275cmp:fe}),ZO=fe({\u0275dir:fe}),XO=fe({\u0275pipe:fe}),JO=fe({\u0275mod:fe}),Ol=fe({\u0275fac:fe}),va=fe({__NG_ELEMENT_ID__:fe}),aD=fe({__NG_ENV_ID__:fe});function GD(t){return typeof t=="string"?t:t==null?"":String(t)}function ek(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():GD(t)}function tk(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new U(-200,`Circular dependency in DI detected for ${t}${n}`)}function qg(t,e){throw new U(-201,!1)}function nk(t,e){t==null&&rk(e,t,null,"!=")}function rk(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(r==null?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}function L(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Dt(t){return{providers:t.providers||[],imports:t.imports||[]}}function Jl(t){return uD(t,WD)||uD(t,KD)}function zD(t){return Jl(t)!==null}function uD(t,e){return t.hasOwnProperty(e)?t[e]:null}function ik(t){let e=t&&(t[WD]||t[KD]);return e||null}function cD(t){return t&&(t.hasOwnProperty(lD)||t.hasOwnProperty(sk))?t[lD]:null}var WD=fe({\u0275prov:fe}),lD=fe({\u0275inj:fe}),KD=fe({ngInjectableDef:fe}),sk=fe({ngInjectorDef:fe}),Z=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(Z||{}),rg;function ok(){return rg}function Ft(t){let e=rg;return rg=t,e}function QD(t,e,n){let r=Jl(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&Z.Optional)return null;if(e!==void 0)return e;qg(t,"Injector")}var _a=globalThis;var k=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=L({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};var ak={},Ia=ak,ig="__NG_DI_FLAG__",kl="ngTempTokenPath",uk="ngTokenPath",ck=/\n/gm,lk="\u0275",dD="__source",wa;function Cr(t){let e=wa;return wa=t,e}function dk(t,e=Z.Default){if(wa===void 0)throw new U(-203,!1);return wa===null?QD(t,void 0,e):wa.get(t,e&Z.Optional?null:void 0,e)}function S(t,e=Z.Default){return(ok()||dk)(ut(t),e)}function R(t,e=Z.Default){return S(t,ed(e))}function ed(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function sg(t){let e=[];for(let n=0;n<t.length;n++){let r=ut(t[n]);if(Array.isArray(r)){if(r.length===0)throw new U(900,!1);let i,s=Z.Default;for(let o=0;o<r.length;o++){let a=r[o],u=hk(a);typeof u=="number"?u===-1?i=a.token:s|=u:i=a}e.push(S(i,s))}else e.push(S(r))}return e}function YD(t,e){return t[ig]=e,t.prototype[ig]=e,t}function hk(t){return t[ig]}function fk(t,e,n,r){let i=t[kl];throw e[dD]&&i.unshift(e[dD]),t.message=pk(`
`+t.message,i,n,r),t[uk]=i,t[kl]=null,t}function pk(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==lk?t.slice(2):t;let i=yt(e);if(Array.isArray(e))i=e.map(yt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):yt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(ck,`
  `)}`}function Fa(t){return{toString:t}.toString()}var ZD=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(ZD||{}),wn=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(wn||{}),Ls={},Vt=[],It=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(It||{});function XD(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function og(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];mk(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function gk(t){return t===3||t===4||t===6}function mk(t){return t.charCodeAt(0)===64}function Da(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?hD(t,n,i,null,e[++r]):hD(t,n,i,null,null))}}return t}function hD(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var JD="ng-template";function yk(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if(typeof s=="string"&&i){let o=t[r++];if(n&&s==="class"&&XD(o.toLowerCase(),e,0)!==-1)return!0}else if(s===1){for(;r<t.length&&typeof(s=t[r++])=="string";)if(s.toLowerCase()===e)return!0;return!1}else typeof s=="number"&&(i=!1)}return!1}function eC(t){return t.type===4&&t.value!==JD}function vk(t,e,n){let r=t.type===4&&!n?JD:t.value;return e===r}function _k(t,e,n){let r=4,i=t.attrs||[],s=Ik(i),o=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!o&&!Jt(r)&&!Jt(u))return!1;if(o&&Jt(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!vk(t,u,n)||u===""&&e.length===1){if(Jt(r))return!1;o=!0}}else{let c=r&8?u:e[++a];if(r&8&&t.attrs!==null){if(!yk(t.attrs,c,n)){if(Jt(r))return!1;o=!0}continue}let l=r&8?"class":u,d=wk(l,i,eC(t),n);if(d===-1){if(Jt(r))return!1;o=!0;continue}if(c!==""){let h;d>s?h="":h=i[d+1].toLowerCase();let f=r&8?h:null;if(f&&XD(f,c,0)!==-1||r&2&&c!==h){if(Jt(r))return!1;o=!0}}}}return Jt(r)||o}function Jt(t){return(t&1)===0}function wk(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return Dk(e,t)}function Ek(t,e,n=!1){for(let r=0;r<e.length;r++)if(_k(t,e[r],n))return!0;return!1}function Ik(t){for(let e=0;e<t.length;e++){let n=t[e];if(gk(n))return e}return t.length}function Dk(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function fD(t,e){return t?":not("+e.trim()+")":e}function Ck(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Jt(o)&&(e+=fD(s,i),i=""),r=o,s=s||!Jt(r);n++}return i!==""&&(e+=fD(s,i)),e}function bk(t){return t.map(Ck).join(",")}function Tk(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Jt(i))break;i=s}r++}return{attrs:e,classes:n}}function Gs(t){return Fa(()=>{let e=sC(t),n=ae(x({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===ZD.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||wn.Emulated,styles:t.styles||Vt,_:null,schemas:t.schemas||null,tView:null,id:""});oC(n);let r=t.dependencies;return n.directiveDefs=gD(r,!1),n.pipeDefs=gD(r,!0),n.id=xk(n),n})}function Sk(t){return gi(t)||tC(t)}function Ak(t){return t!==null}function Ct(t){return Fa(()=>({type:t.type,bootstrap:t.bootstrap||Vt,declarations:t.declarations||Vt,imports:t.imports||Vt,exports:t.exports||Vt,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function pD(t,e){if(t==null)return Ls;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=It.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==It.None?[r,a]:r,e[s]=o):n[s]=r}return n}function tn(t){return Fa(()=>{let e=sC(t);return oC(e),e})}function gi(t){return t[YO]||null}function tC(t){return t[ZO]||null}function nC(t){return t[XO]||null}function rC(t){let e=gi(t)||tC(t)||nC(t);return e!==null?e.standalone:!1}function iC(t,e){let n=t[JO]||null;if(!n&&e===!0)throw new Error(`Type ${yt(t)} does not have '\u0275mod' property.`);return n}function sC(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Ls,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||Vt,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:pD(t.inputs,e),outputs:pD(t.outputs),debugInfo:null}}function oC(t){t.features?.forEach(e=>e(t))}function gD(t,e){if(!t)return null;let n=e?nC:Sk;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(Ak)}function xk(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}var Xn=0,ee=1,H=2,et=3,en=4,nn=5,Fl=6,Ca=7,Kn=8,js=9,br=10,tt=11,ba=12,mD=13,Va=14,En=15,td=16,Os=17,Ta=18,nd=19,aC=20,Ea=21,$p=22,mi=23,Tr=25,uC=1;var yi=7,Vl=8,Ll=9,Lt=10,Hg=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(Hg||{});function fi(t){return Array.isArray(t)&&typeof t[uC]=="object"}function Jn(t){return Array.isArray(t)&&t[uC]===!0}function cC(t){return(t.flags&4)!==0}function rd(t){return t.componentOffset>-1}function Gg(t){return(t.flags&1)===1}function Sr(t){return!!t.template}function Mk(t){return(t[H]&512)!==0}function Bs(t,e){let n=t.hasOwnProperty(Ol);return n?t[Ol]:null}var ag=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function lC(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function zs(){return dC}function dC(t){return t.type.prototype.ngOnChanges&&(t.setInput=Nk),Rk}zs.ngInherit=!0;function Rk(){let t=fC(this),e=t?.current;if(e){let n=t.previous;if(n===Ls)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function Nk(t,e,n,r,i){let s=this.declaredInputs[r],o=fC(t)||Pk(t,{previous:Ls,current:null}),a=o.current||(o.current={}),u=o.previous,c=u[s];a[s]=new ag(c&&c.currentValue,n,u===Ls),lC(t,e,i,n)}var hC="__ngSimpleChanges__";function fC(t){return t[hC]||null}function Pk(t,e){return t[hC]=e}var yD=null;var vn=function(t,e,n){yD?.(t,e,n)},Ok="svg",kk="math",Fk=!1;function Vk(){return Fk}function In(t){for(;Array.isArray(t);)t=t[Xn];return t}function pC(t,e){return In(e[t])}function rn(t,e){return In(e[t.index])}function gC(t,e){return t.data[e]}function xr(t,e){let n=e[t];return fi(n)?n:n[Xn]}function zg(t){return(t[H]&128)===128}function Lk(t){return Jn(t[et])}function jl(t,e){return e==null?null:t[e]}function mC(t){t[Os]=0}function jk(t){t[H]&1024||(t[H]|=1024,zg(t)&&Sa(t))}function yC(t){return t[H]&9216||t[mi]?.dirty}function ug(t){yC(t)?Sa(t):t[H]&64&&(Vk()?(t[H]|=1024,Sa(t)):t[br].changeDetectionScheduler?.notify())}function Sa(t){t[br].changeDetectionScheduler?.notify();let e=Aa(t);for(;e!==null&&!(e[H]&8192||(e[H]|=8192,!zg(e)));)e=Aa(e)}function Bk(t,e){if((t[H]&256)===256)throw new U(911,!1);t[Ea]===null&&(t[Ea]=[]),t[Ea].push(e)}function Aa(t){let e=t[et];return Jn(e)?e[et]:e}var ie={lFrame:bC(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Uk(){return ie.lFrame.elementDepthCount}function $k(){ie.lFrame.elementDepthCount++}function qk(){ie.lFrame.elementDepthCount--}function vC(){return ie.bindingsEnabled}function Hk(){return ie.skipHydrationRootTNode!==null}function Gk(t){return ie.skipHydrationRootTNode===t}function zk(){ie.skipHydrationRootTNode=null}function Oe(){return ie.lFrame.lView}function Dn(){return ie.lFrame.tView}function Bt(){let t=_C();for(;t!==null&&t.type===64;)t=t.parent;return t}function _C(){return ie.lFrame.currentTNode}function Wk(){let t=ie.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function La(t,e){let n=ie.lFrame;n.currentTNode=t,n.isParent=e}function wC(){return ie.lFrame.isParent}function Kk(){ie.lFrame.isParent=!1}function Qk(){let t=ie.lFrame,e=t.bindingRootIndex;return e===-1&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function Yk(t){return ie.lFrame.bindingIndex=t}function EC(){return ie.lFrame.bindingIndex++}function Zk(t){let e=ie.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function Xk(){return ie.lFrame.inI18n}function Jk(t,e){let n=ie.lFrame;n.bindingIndex=n.bindingRootIndex=t,cg(e)}function e1(){return ie.lFrame.currentDirectiveIndex}function cg(t){ie.lFrame.currentDirectiveIndex=t}function t1(t){let e=ie.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function IC(t){ie.lFrame.currentQueryIndex=t}function n1(t){let e=t[ee];return e.type===2?e.declTNode:e.type===1?t[nn]:null}function DC(t,e,n){if(n&Z.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&Z.Host);)if(i=n1(s),i===null||(s=s[Va],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=ie.lFrame=CC();return r.currentTNode=e,r.lView=t,!0}function Wg(t){let e=CC(),n=t[ee];ie.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function CC(){let t=ie.lFrame,e=t===null?null:t.child;return e===null?bC(t):e}function bC(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function TC(){let t=ie.lFrame;return ie.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var SC=TC;function Kg(){let t=TC();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Ws(){return ie.lFrame.selectedIndex}function vi(t){ie.lFrame.selectedIndex=t}function r1(){let t=ie.lFrame;return gC(t.tView,t.selectedIndex)}function i1(){return ie.lFrame.currentNamespace}var AC=!0;function Qg(){return AC}function Yg(t){AC=t}function s1(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=dC(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function Zg(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:c,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function xl(t,e,n){xC(t,e,3,n)}function Ml(t,e,n,r){(t[H]&3)===n&&xC(t,e,n,r)}function qp(t,e){let n=t[H];(n&3)===e&&(n&=16383,n+=1,t[H]=n)}function xC(t,e,n,r){let i=r!==void 0?t[Os]&65535:0,s=r??-1,o=e.length-1,a=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(t[Os]+=65536),(a<s||s==-1)&&(o1(t,n,e,u),t[Os]=(t[Os]&4294901760)+u+2),u++}function vD(t,e){vn(4,t,e);let n=Et(null);try{e.call(t)}finally{Et(n),vn(5,t,e)}}function o1(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[H]>>14<t[Os]>>16&&(t[H]&3)===e&&(t[H]+=16384,vD(a,s)):vD(a,s)}var Vs=-1,_i=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function a1(t){return t instanceof _i}function u1(t){return(t.flags&8)!==0}function c1(t){return(t.flags&16)!==0}function MC(t){return t!==Vs}function Bl(t){return t&32767}function l1(t){return t>>16}function Ul(t,e){let n=l1(t),r=e;for(;n>0;)r=r[Va],n--;return r}var lg=!0;function _D(t){let e=lg;return lg=t,e}var d1=256,RC=d1-1,NC=5,h1=0,_n={};function f1(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(va)&&(r=n[va]),r==null&&(r=n[va]=h1++);let i=r&RC,s=1<<i;e.data[t+(i>>NC)]|=s}function $l(t,e){let n=PC(t,e);if(n!==-1)return n;let r=e[ee];r.firstCreatePass&&(t.injectorIndex=e.length,Hp(r.data,t),Hp(e,null),Hp(r.blueprint,null));let i=Xg(t,e),s=t.injectorIndex;if(MC(i)){let o=Bl(i),a=Ul(i,e),u=a[ee].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|u[o+c]}return e[s+8]=i,s}function Hp(t,e){t.push(0,0,0,0,0,0,0,0,e)}function PC(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function Xg(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=LC(i),r===null)return Vs;if(n++,i=i[Va],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Vs}function dg(t,e,n){f1(t,e,n)}function OC(t,e,n){if(n&Z.Optional||t!==void 0)return t;qg(e,"NodeInjector")}function kC(t,e,n,r){if(n&Z.Optional&&r===void 0&&(r=null),!(n&(Z.Self|Z.Host))){let i=t[js],s=Ft(void 0);try{return i?i.get(e,r,n&Z.Optional):QD(e,r,n&Z.Optional)}finally{Ft(s)}}return OC(r,e,n)}function FC(t,e,n,r=Z.Default,i){if(t!==null){if(e[H]&2048&&!(r&Z.Self)){let o=v1(t,e,n,r,_n);if(o!==_n)return o}let s=VC(t,e,n,r,_n);if(s!==_n)return s}return kC(e,n,r,i)}function VC(t,e,n,r,i){let s=m1(n);if(typeof s=="function"){if(!DC(e,t,r))return r&Z.Host?OC(i,n,r):kC(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&Z.Optional))qg(n);else return o}finally{SC()}}else if(typeof s=="number"){let o=null,a=PC(t,e),u=Vs,c=r&Z.Host?e[En][nn]:null;for((a===-1||r&Z.SkipSelf)&&(u=a===-1?Xg(t,e):e[a+8],u===Vs||!ED(r,!1)?a=-1:(o=e[ee],a=Bl(u),e=Ul(u,e)));a!==-1;){let l=e[ee];if(wD(s,a,l.data)){let d=p1(a,e,n,o,r,c);if(d!==_n)return d}u=e[a+8],u!==Vs&&ED(r,e[ee].data[a+8]===c)&&wD(s,a,e)?(o=l,a=Bl(u),e=Ul(u,e)):a=-1}}return i}function p1(t,e,n,r,i,s){let o=e[ee],a=o.data[t+8],u=r==null?rd(a)&&lg:r!=o&&(a.type&3)!==0,c=i&Z.Host&&s===a,l=g1(a,o,n,u,c);return l!==null?Us(e,o,l,a):_n}function g1(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,u=t.directiveStart,c=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:c;for(let f=d;f<h;f++){let m=o[f];if(f<u&&n===m||f>=u&&m.type===n)return f}if(i){let f=o[u];if(f&&Sr(f)&&f.type===n)return u}return null}function Us(t,e,n,r){let i=t[n],s=e.data;if(a1(i)){let o=i;o.resolving&&tk(ek(s[n]));let a=_D(o.canSeeViewProviders);o.resolving=!0;let u,c=o.injectImpl?Ft(o.injectImpl):null,l=DC(t,r,Z.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&s1(n,s[n],e)}finally{c!==null&&Ft(c),_D(a),o.resolving=!1,SC()}}return i}function m1(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(va)?t[va]:void 0;return typeof e=="number"?e>=0?e&RC:y1:e}function wD(t,e,n){let r=1<<t;return!!(n[e+(t>>NC)]&r)}function ED(t,e){return!(t&Z.Self)&&!(t&Z.Host&&e)}var pi=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return FC(this._tNode,this._lView,e,ed(r),n)}};function y1(){return new pi(Bt(),Oe())}function ja(t){return Fa(()=>{let e=t.prototype.constructor,n=e[Ol]||hg(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[Ol]||hg(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function hg(t){return qD(t)?()=>{let e=hg(ut(t));return e&&e()}:Bs(t)}function v1(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[H]&2048&&!(o[H]&512);){let a=VC(s,o,n,r|Z.Self,_n);if(a!==_n)return a;let u=s.parent;if(!u){let c=o[aC];if(c){let l=c.get(n,_n,r);if(l!==_n)return l}u=LC(o),o=o[Va]}s=u}return i}function LC(t){let e=t[ee],n=e.type;return n===2?e.declTNode:n===1?t[nn]:null}var Tl="__parameters__";function _1(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function jC(t,e,n){return Fa(()=>{let r=_1(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(u,c,l){let d=u.hasOwnProperty(Tl)?u[Tl]:Object.defineProperty(u,Tl,{value:[]})[Tl];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}function w1(t){return typeof t=="function"}function Jg(t,e){t.forEach(n=>Array.isArray(n)?Jg(n,e):e(n))}function BC(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function ql(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function E1(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function I1(t,e,n){let r=Ba(t,e);return r>=0?t[r|1]=n:(r=~r,E1(t,r,e,n)),r}function Gp(t,e){let n=Ba(t,e);if(n>=0)return t[n|1]}function Ba(t,e){return D1(t,e,1)}function D1(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var Ua=YD(jC("Optional"),8);var UC=YD(jC("SkipSelf"),4);var $s=new k("ENVIRONMENT_INITIALIZER"),$C=new k("INJECTOR",-1),qC=new k("INJECTOR_DEF_TYPES"),Hl=class{get(e,n=Ia){if(n===Ia){let r=new Error(`NullInjectorError: No provider for ${yt(e)}!`);throw r.name="NullInjectorError",r}return n}};function id(t){return{\u0275providers:t}}function C1(...t){return{\u0275providers:HC(!0,t),\u0275fromNgModule:!0}}function HC(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return Jg(e,o=>{let a=o;fg(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&GC(i,s),n}function GC(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];em(i,s=>{e(s,r)})}}function fg(t,e,n,r){if(t=ut(t),!t)return!1;let i=null,s=cD(t),o=!s&&gi(t);if(!s&&!o){let u=t.ngModule;if(s=cD(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of u)fg(c,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let c;try{Jg(s.imports,l=>{fg(l,e,n,r)&&(c||=[],c.push(l))})}finally{}c!==void 0&&GC(c,e)}if(!a){let c=Bs(i)||(()=>new i);e({provide:i,useFactory:c,deps:Vt},i),e({provide:qC,useValue:i,multi:!0},i),e({provide:$s,useValue:()=>S(i),multi:!0},i)}let u=s.providers;if(u!=null&&!a){let c=t;em(u,l=>{e(l,c)})}}else return!1;return i!==t&&t.providers!==void 0}function em(t,e){for(let n of t)HD(n)&&(n=n.\u0275providers),Array.isArray(n)?em(n,e):e(n)}var b1=fe({provide:String,useValue:fe});function zC(t){return t!==null&&typeof t=="object"&&b1 in t}function T1(t){return!!(t&&t.useExisting)}function S1(t){return!!(t&&t.useFactory)}function qs(t){return typeof t=="function"}function A1(t){return!!t.useClass}var sd=new k("Set Injector scope."),Rl={},x1={},zp;function tm(){return zp===void 0&&(zp=new Hl),zp}var jt=class{},xa=class extends jt{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,gg(e,o=>this.processProvider(o)),this.records.set($C,ks(void 0,this)),i.has("environment")&&this.records.set(jt,ks(void 0,this));let s=this.records.get(sd);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(qC,Vt,Z.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=Cr(this),r=Ft(void 0),i;try{return e()}finally{Cr(n),Ft(r)}}get(e,n=Ia,r=Z.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(aD))return e[aD](this);r=ed(r);let i,s=Cr(this),o=Ft(void 0);try{if(!(r&Z.SkipSelf)){let u=this.records.get(e);if(u===void 0){let c=O1(e)&&Jl(e);c&&this.injectableDefInScope(c)?u=ks(pg(e),Rl):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&Z.Self?tm():this.parent;return n=r&Z.Optional&&n===Ia?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[kl]=a[kl]||[]).unshift(yt(e)),s)throw a;return fk(a,e,"R3InjectorError",this.source)}else throw a}finally{Ft(o),Cr(s)}}resolveInjectorInitializers(){let e=Cr(this),n=Ft(void 0),r;try{let i=this.get($s,Vt,Z.Self);for(let s of i)s()}finally{Cr(e),Ft(n)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(yt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new U(205,!1)}processProvider(e){e=ut(e);let n=qs(e)?e:ut(e&&e.provide),r=R1(e);if(!qs(e)&&e.multi===!0){let i=this.records.get(n);i||(i=ks(void 0,Rl,!0),i.factory=()=>sg(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===Rl&&(n.value=x1,n.value=n.factory()),typeof n.value=="object"&&n.value&&P1(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;let n=ut(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function pg(t){let e=Jl(t),n=e!==null?e.factory:Bs(t);if(n!==null)return n;if(t instanceof k)throw new U(204,!1);if(t instanceof Function)return M1(t);throw new U(204,!1)}function M1(t){if(t.length>0)throw new U(204,!1);let n=ik(t);return n!==null?()=>n.factory(t):()=>new t}function R1(t){if(zC(t))return ks(void 0,t.useValue);{let e=WC(t);return ks(e,Rl)}}function WC(t,e,n){let r;if(qs(t)){let i=ut(t);return Bs(i)||pg(i)}else if(zC(t))r=()=>ut(t.useValue);else if(S1(t))r=()=>t.useFactory(...sg(t.deps||[]));else if(T1(t))r=()=>S(ut(t.useExisting));else{let i=ut(t&&(t.useClass||t.provide));if(N1(t))r=()=>new i(...sg(t.deps));else return Bs(i)||pg(i)}return r}function ks(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function N1(t){return!!t.deps}function P1(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function O1(t){return typeof t=="function"||typeof t=="object"&&t instanceof k}function gg(t,e){for(let n of t)Array.isArray(n)?gg(n,e):n&&HD(n)?gg(n.\u0275providers,e):e(n)}function Di(t,e){t instanceof xa&&t.assertNotDestroyed();let n,r=Cr(t),i=Ft(void 0);try{return e()}finally{Cr(r),Ft(i)}}function ID(t,e=null,n=null,r){let i=KC(t,e,n,r);return i.resolveInjectorInitializers(),i}function KC(t,e=null,n=null,r,i=new Set){let s=[n||Vt,C1(t)];return r=r||(typeof t=="object"?void 0:yt(t)),new xa(s,e||tm(),r||null,i)}var Ci=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return ID({name:""},i,r,"");{let s=r.name??"";return ID({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Ia,e.NULL=new Hl,e.\u0275prov=L({token:e,providedIn:"any",factory:()=>S($C)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var mg;function QC(t){mg=t}function k1(){if(mg!==void 0)return mg;if(typeof document<"u")return document;throw new U(210,!1)}var nm=new k("AppId",{providedIn:"root",factory:()=>F1}),F1="ng",rm=new k("Platform Initializer"),Ut=new k("Platform ID",{providedIn:"platform",factory:()=>"unknown"});var im=new k("CSP nonce",{providedIn:"root",factory:()=>k1().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function YC(t){return t instanceof Function?t():t}function ZC(t){return(t.flags&128)===128}var Qn=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Qn||{});var XC=new Map,V1=0;function L1(){return V1++}function j1(t){XC.set(t[nd],t)}function B1(t){XC.delete(t[nd])}var DD="__ngContext__";function wi(t,e){fi(e)?(t[DD]=e[nd],j1(e)):t[DD]=e}var U1;function sm(t,e){return U1(t,e)}function Fs(t,e,n,r,i){if(r!=null){let s,o=!1;Jn(r)?s=r:fi(r)&&(o=!0,r=r[Xn]);let a=In(r);t===0&&n!==null?i==null?rb(e,n,a):Gl(e,n,a,i||null,!0):t===1&&n!==null?Gl(e,n,a,i||null,!0):t===2?iF(e,a,o):t===3&&e.destroyNode(a),s!=null&&oF(e,t,s,n,i)}}function $1(t,e){return t.createText(e)}function q1(t,e,n){t.setValue(e,n)}function JC(t,e,n){return t.createElement(e,n)}function H1(t,e){eb(t,e),e[Xn]=null,e[nn]=null}function G1(t,e,n,r,i,s){r[Xn]=i,r[nn]=e,od(t,r,n,1,i,s)}function eb(t,e){od(t,e,e[tt],2,null,null)}function z1(t){let e=t[ba];if(!e)return Wp(t[ee],t);for(;e;){let n=null;if(fi(e))n=e[ba];else{let r=e[Lt];r&&(n=r)}if(!n){for(;e&&!e[en]&&e!==t;)fi(e)&&Wp(e[ee],e),e=e[et];e===null&&(e=t),fi(e)&&Wp(e[ee],e),n=e&&e[en]}e=n}}function W1(t,e,n,r){let i=Lt+r,s=n.length;r>0&&(n[i-1][en]=e),r<s-Lt?(e[en]=n[i],BC(n,Lt+r,e)):(n.push(e),e[en]=null),e[et]=n;let o=e[td];o!==null&&n!==o&&K1(o,e);let a=e[Ta];a!==null&&a.insertView(t),ug(e),e[H]|=128}function K1(t,e){let n=t[Ll],i=e[et][et][En];e[En]!==i&&(t[H]|=Hg.HasTransplantedViews),n===null?t[Ll]=[e]:n.push(e)}function tb(t,e){let n=t[Ll],r=n.indexOf(e);n.splice(r,1)}function yg(t,e){if(t.length<=Lt)return;let n=Lt+e,r=t[n];if(r){let i=r[td];i!==null&&i!==t&&tb(i,r),e>0&&(t[n-1][en]=r[en]);let s=ql(t,Lt+e);H1(r[ee],r);let o=s[Ta];o!==null&&o.detachView(s[ee]),r[et]=null,r[en]=null,r[H]&=-129}return r}function nb(t,e){if(!(e[H]&256)){let n=e[tt];n.destroyNode&&od(t,e,n,3,null,null),z1(e)}}function Wp(t,e){if(!(e[H]&256)){e[H]&=-129,e[H]|=256,e[mi]&&VI(e[mi]),Y1(t,e),Q1(t,e),e[ee].type===1&&e[tt].destroy();let n=e[td];if(n!==null&&Jn(e[et])){n!==e[et]&&tb(n,e);let r=e[Ta];r!==null&&r.detachView(t)}B1(e)}}function Q1(t,e){let n=t.cleanup,r=e[Ca];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[Ca]=null);let i=e[Ea];if(i!==null){e[Ea]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function Y1(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof _i)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],u=s[o+1];vn(4,a,u);try{u.call(a)}finally{vn(5,a,u)}}else{vn(4,i,s);try{s.call(i)}finally{vn(5,i,s)}}}}}function Z1(t,e,n){return X1(t,e.parent,n)}function X1(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[Xn];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===wn.None||s===wn.Emulated)return null}return rn(r,n)}}function Gl(t,e,n,r,i){t.insertBefore(e,n,r,i)}function rb(t,e,n){t.appendChild(e,n)}function CD(t,e,n,r,i){r!==null?Gl(t,e,n,r,i):rb(t,e,n)}function J1(t,e,n,r){t.removeChild(e,n,r)}function om(t,e){return t.parentNode(e)}function eF(t,e){return t.nextSibling(e)}function tF(t,e,n){return rF(t,e,n)}function nF(t,e,n){return t.type&40?rn(t,n):null}var rF=nF,bD;function am(t,e,n,r){let i=Z1(t,r,e),s=e[tt],o=r.parent||e[nn],a=tF(o,r,e);if(i!=null)if(Array.isArray(n))for(let u=0;u<n.length;u++)CD(s,i,n[u],a,!1);else CD(s,i,n,a,!1);bD!==void 0&&bD(s,r,e,n,i)}function Nl(t,e){if(e!==null){let n=e.type;if(n&3)return rn(e,t);if(n&4)return vg(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return Nl(t,r);{let i=t[e.index];return Jn(i)?vg(-1,i):In(i)}}else{if(n&32)return sm(e,t)()||In(t[e.index]);{let r=ib(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Aa(t[En]);return Nl(i,r)}else return Nl(t,e.next)}}}return null}function ib(t,e){if(e!==null){let r=t[En][nn],i=e.projection;return r.projection[i]}return null}function vg(t,e){let n=Lt+t+1;if(n<e.length){let r=e[n],i=r[ee].firstChild;if(i!==null)return Nl(r,i)}return e[yi]}function iF(t,e,n){let r=om(t,e);r&&J1(t,r,e,n)}function um(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],u=n.type;if(o&&e===0&&(a&&wi(In(a),r),n.flags|=2),(n.flags&32)!==32)if(u&8)um(t,e,n.child,r,i,s,!1),Fs(e,t,i,a,s);else if(u&32){let c=sm(n,r),l;for(;l=c();)Fs(e,t,i,l,s);Fs(e,t,i,a,s)}else u&16?sF(t,e,r,n,i,s):Fs(e,t,i,a,s);n=o?n.projectionNext:n.next}}function od(t,e,n,r,i,s){um(n,r,t.firstChild,e,i,s,!1)}function sF(t,e,n,r,i,s){let o=n[En],u=o[nn].projection[r.projection];if(Array.isArray(u))for(let c=0;c<u.length;c++){let l=u[c];Fs(e,t,i,l,s)}else{let c=u,l=o[et];ZC(r)&&(c.flags|=128),um(t,e,c,l,i,s,!0)}}function oF(t,e,n,r,i){let s=n[yi],o=In(n);s!==o&&Fs(e,t,r,s,i);for(let a=Lt;a<n.length;a++){let u=n[a];od(u[ee],u,t,e,r,s)}}function aF(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:Qn.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Qn.Important),t.setStyle(n,r,i,s))}}function uF(t,e,n){t.setAttribute(e,"style",n)}function sb(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function ob(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&og(t,e,r),i!==null&&sb(t,e,i),s!==null&&uF(t,e,s)}var _g=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${WO})`}};function cm(t){return t instanceof _g?t.changingThisBreaksApplicationSecurity:t}var wg=class{};var cF="h",lF="b";var dF=()=>null;function lm(t,e,n=!1){return dF(t,e,n)}var Eg=class{},zl=class{};function hF(t){let e=Error(`No component factory found for ${yt(t)}.`);return e[fF]=t,e}var fF="ngComponent";var Ig=class{resolveComponentFactory(e){throw hF(e)}},ad=(()=>{let e=class e{};e.NULL=new Ig;let t=e;return t})();function pF(){return ud(Bt(),Oe())}function ud(t,e){return new Mr(rn(t,e))}var Mr=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=pF;let t=e;return t})();var Ma=class{},bi=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>gF();let t=e;return t})();function gF(){let t=Oe(),e=Bt(),n=xr(e.index,t);return(fi(n)?n:t)[tt]}var mF=(()=>{let e=class e{};e.\u0275prov=L({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),Kp={};function ab(t){return vF(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function yF(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function vF(t){return t!==null&&(typeof t=="function"||typeof t=="object")}var Dg=class{constructor(){}supports(e){return ab(e)}create(e){return new Cg(e)}},_F=(t,e)=>e,Cg=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||_F}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<TD(r,i,s)?n:r,a=TD(o,i,s),u=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let c=a-i,l=u-i;if(c!=l){for(let h=0;h<c;h++){let f=h<s.length?s[h]:s[h]=0,m=f+h;l<=m&&m<c&&(s[h]=f+1)}let d=o.previousIndex;s[d]=l-c}}a!==u&&e(o,a,u)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!ab(e))throw new U(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,yF(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new bg(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new Wl),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Wl),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},bg=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Tg=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},Wl=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new Tg,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function TD(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function SD(){return new dm([new Dg])}var dm=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||SD()),deps:[[e,new UC,new Ua]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new U(901,!1)}};e.\u0275prov=L({token:e,providedIn:"root",factory:SD});let t=e;return t})();function Kl(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(In(s)),Jn(s)&&wF(s,r);let o=n.type;if(o&8)Kl(t,e,n.child,r);else if(o&32){let a=sm(n,e),u;for(;u=a();)r.push(u)}else if(o&16){let a=ib(e,n);if(Array.isArray(a))r.push(...a);else{let u=Aa(e[En]);Kl(u[ee],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function wF(t,e){for(let n=Lt;n<t.length;n++){let r=t[n],i=r[ee].firstChild;i!==null&&Kl(r[ee],r,i,e)}t[yi]!==t[Xn]&&e.push(t[yi])}var ub=[];function EF(t){return t[mi]??IF(t)}function IF(t){let e=ub.pop()??Object.create(CF);return e.lView=t,e}function DF(t){t.lView[mi]!==t&&(t.lView=null,ub.push(t))}var CF=ae(x({},OI),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Sa(t.lView)},consumerOnSignalRead(){this.lView[mi]=this}});function cb(t){return db(t[ba])}function lb(t){return db(t[en])}function db(t){for(;t!==null&&!Jn(t);)t=t[en];return t}var bF="ngOriginalError";function Qp(t){return t[bF]}var Yn=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&Qp(e);for(;n&&Qp(n);)n=Qp(n);return n||null}},hb=new k("",{providedIn:"root",factory:()=>R(Yn).handleError.bind(void 0)});var fb=!1,TF=new k("",{providedIn:"root",factory:()=>fb});var Ti={};function cd(t=1){pb(Dn(),Oe(),Ws()+t,!1)}function pb(t,e,n,r){if(!r)if((e[H]&3)===3){let s=t.preOrderCheckHooks;s!==null&&xl(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Ml(e,s,0,n)}vi(n)}function ge(t,e=Z.Default){let n=Oe();if(n===null)return S(t,e);let r=Bt();return FC(r,n,ut(t),e)}function gb(t,e,n,r,i,s){let o=Et(null);try{let a=null;i&It.SignalBased&&(a=e[r][PI]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&It.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):lC(e,a,r,s)}finally{Et(o)}}function SF(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)vi(~i);else{let s=i,o=n[++r],a=n[++r];Jk(o,s);let u=e[s];a(2,u)}}}finally{vi(-1)}}function ld(t,e,n,r,i,s,o,a,u,c,l){let d=e.blueprint.slice();return d[Xn]=i,d[H]=r|4|128|8|64,(c!==null||t&&t[H]&2048)&&(d[H]|=2048),mC(d),d[et]=d[Va]=t,d[Kn]=n,d[br]=o||t&&t[br],d[tt]=a||t&&t[tt],d[js]=u||t&&t[js]||null,d[nn]=s,d[nd]=L1(),d[Fl]=l,d[aC]=c,d[En]=e.type==2?t[En]:d,d}function dd(t,e,n,r,i){let s=t.data[e];if(s===null)s=AF(t,e,n,r,i),Xk()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=Wk();s.injectorIndex=o===null?-1:o.injectorIndex}return La(s,!0),s}function AF(t,e,n,r,i){let s=_C(),o=wC(),a=o?s:s&&s.parent,u=t.data[e]=PF(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=u),s!==null&&(o?s.child==null&&u.parent!==null&&(s.child=u):s.next===null&&(s.next=u,u.prev=s)),u}function mb(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function yb(t,e,n,r,i){let s=Ws(),o=r&2;try{vi(-1),o&&e.length>Tr&&pb(t,e,Tr,!1),vn(o?2:0,i),n(r,i)}finally{vi(s),vn(o?3:1,i)}}function vb(t,e,n){if(cC(e)){let r=Et(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{Et(r)}}}function _b(t,e,n){vC()&&(BF(t,e,n,rn(n,e)),(n.flags&64)===64&&Cb(t,e,n))}function wb(t,e,n=rn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function Eb(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=hm(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function hm(t,e,n,r,i,s,o,a,u,c,l){let d=Tr+r,h=d+i,f=xF(d,h),m=typeof c=="function"?c():c;return f[ee]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:m,incompleteFirstPass:!1,ssrId:l}}function xF(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:Ti);return n}function MF(t,e,n,r){let s=r.get(TF,fb)||n===wn.ShadowDom,o=t.selectRootElement(e,s);return RF(o),o}function RF(t){NF(t)}var NF=()=>null;function PF(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return Hk()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function AD(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,u=It.None;Array.isArray(o)?(a=o[0],u=o[1]):a=o;let c=s;if(i!==null){if(!i.hasOwnProperty(s))continue;c=i[s]}t===0?xD(r,n,c,a,u):xD(r,n,c,a)}return r}function xD(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function OF(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],u=null,c=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,m=h?h.outputs:null;u=AD(0,d.inputs,l,u,f),c=AD(1,d.outputs,l,c,m);let v=u!==null&&o!==null&&!eC(e)?QF(u,l,o):null;a.push(v)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=c}function kF(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function FF(t,e,n,r,i,s,o,a){let u=rn(e,n),c=e.inputs,l;!a&&c!=null&&(l=c[r])?(fm(t,n,l,r,i),rd(e)&&VF(n,e.index)):e.type&3?(r=kF(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(u,r,i)):e.type&12}function VF(t,e){let n=xr(e,t);n[H]&16||(n[H]|=64)}function Ib(t,e,n,r){if(vC()){let i=r===null?null:{"":-1},s=$F(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&Db(t,e,n,o,i,a),i&&qF(n,r,i)}n.mergedAttrs=Da(n.mergedAttrs,n.attrs)}function Db(t,e,n,r,i,s){for(let c=0;c<r.length;c++)dg($l(n,e),t,r[c].type);GF(n,t.data.length,r.length);for(let c=0;c<r.length;c++){let l=r[c];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,u=mb(t,e,r.length,null);for(let c=0;c<r.length;c++){let l=r[c];n.mergedAttrs=Da(n.mergedAttrs,l.hostAttrs),zF(t,n,e,u,l),HF(u,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}OF(t,n,s)}function LF(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;jF(o)!=a&&o.push(a),o.push(n,r,s)}}function jF(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function BF(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;rd(n)&&WF(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||$l(n,e),wi(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let u=t.data[a],c=Us(e,t,a,n);if(wi(c,e),o!==null&&KF(e,a-i,c,u,n,o),Sr(u)){let l=xr(n.index,e);l[Kn]=Us(e,t,a,n)}}}function Cb(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=e1();try{vi(s);for(let a=r;a<i;a++){let u=t.data[a],c=e[a];cg(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&UF(u,c)}}finally{vi(-1),cg(o)}}function UF(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function $F(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(Ek(e,o.selectors,!1))if(r||(r=[]),Sr(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let u=a.length;Sg(t,e,u)}else r.unshift(o),Sg(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function Sg(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function qF(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new U(-301,!1);r.push(e[i],s)}}}function HF(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Sr(e)&&(n[""]=t)}}function GF(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function zF(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=Bs(i.type,!0)),o=new _i(s,Sr(i),ge);t.blueprint[r]=o,n[r]=o,LF(t,e,r,mb(t,n,i.hostVars,Ti),i)}function WF(t,e,n){let r=rn(e,t),i=Eb(n),s=t[br].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=hd(t,ld(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function KF(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let u=o[a++],c=o[a++],l=o[a++],d=o[a++];gb(r,n,u,c,l,d)}}function QF(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function bb(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function Tb(t,e){let n=t.contentQueries;if(n!==null){let r=Et(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];IC(s),a.contentQueries(2,e[o],o)}}}finally{Et(r)}}}function hd(t,e){return t[ba]?t[mD][en]=e:t[ba]=e,t[mD]=e,e}function Ag(t,e,n){IC(0);let r=Et(null);try{e(t,n)}finally{Et(r)}}function YF(t){return t[Ca]||(t[Ca]=[])}function ZF(t){return t.cleanup||(t.cleanup=[])}function Sb(t,e){let n=t[js],r=n?n.get(Yn,null):null;r&&r.handleError(e)}function fm(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],u=n[s++],c=e[o],l=t.data[o];gb(l,c,r,a,u,i)}}function XF(t,e,n){let r=pC(e,t);q1(t[tt],r,n)}var JF=100;function eV(t,e=!0){let n=t[br],r=n.rendererFactory,i=!1;i||r.begin?.();try{tV(t)}catch(s){throw e&&Sb(t,s),s}finally{i||(r.end?.(),n.inlineEffectRunner?.flush())}}function tV(t){xg(t,0);let e=0;for(;yC(t);){if(e===JF)throw new U(103,!1);e++,xg(t,1)}}function nV(t,e,n,r){let i=e[H];if((i&256)===256)return;let s=!1;!s&&e[br].inlineEffectRunner?.flush(),Wg(e);let o=null,a=null;!s&&rV(t)&&(a=EF(e),o=kI(a));try{mC(e),Yk(t.bindingStartIndex),n!==null&&yb(t,e,n,2,r);let u=(i&3)===3;if(!s)if(u){let d=t.preOrderCheckHooks;d!==null&&xl(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Ml(e,d,0,null),qp(e,0)}if(iV(e),Ab(e,0),t.contentQueries!==null&&Tb(t,e),!s)if(u){let d=t.contentCheckHooks;d!==null&&xl(e,d)}else{let d=t.contentHooks;d!==null&&Ml(e,d,1),qp(e,1)}SF(t,e);let c=t.components;c!==null&&Mb(e,c,0);let l=t.viewQuery;if(l!==null&&Ag(2,l,r),!s)if(u){let d=t.viewCheckHooks;d!==null&&xl(e,d)}else{let d=t.viewHooks;d!==null&&Ml(e,d,2),qp(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[$p]){for(let d of e[$p])d();e[$p]=null}s||(e[H]&=-73)}catch(u){throw Sa(e),u}finally{a!==null&&(FI(a,o),DF(a)),Kg()}}function rV(t){return t.type!==2}function Ab(t,e){for(let n=cb(t);n!==null;n=lb(n))for(let r=Lt;r<n.length;r++){let i=n[r];xb(i,e)}}function iV(t){for(let e=cb(t);e!==null;e=lb(e)){if(!(e[H]&Hg.HasTransplantedViews))continue;let n=e[Ll];for(let r=0;r<n.length;r++){let i=n[r],s=i[et];jk(i)}}}function sV(t,e,n){let r=xr(e,t);xb(r,n)}function xb(t,e){zg(t)&&xg(t,e)}function xg(t,e){let r=t[ee],i=t[H],s=t[mi],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&wp(s)),s&&(s.dirty=!1),t[H]&=-9217,o)nV(r,t,r.template,t[Kn]);else if(i&8192){Ab(t,1);let a=r.components;a!==null&&Mb(t,a,1)}}function Mb(t,e,n){for(let r=0;r<e.length;r++)sV(t,e[r],n)}function pm(t){for(t[br].changeDetectionScheduler?.notify();t;){t[H]|=64;let e=Aa(t);if(Mk(t)&&!e)return t;t=e}return null}var Ei=class{get rootNodes(){let e=this._lView,n=e[ee];return Kl(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Kn]}set context(e){this._lView[Kn]=e}get destroyed(){return(this._lView[H]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[et];if(Jn(e)){let n=e[Vl],r=n?n.indexOf(this):-1;r>-1&&(yg(e,r),ql(n,r))}this._attachedToViewContainer=!1}nb(this._lView[ee],this._lView)}onDestroy(e){Bk(this._lView,e)}markForCheck(){pm(this._cdRefInjectingView||this._lView)}detach(){this._lView[H]&=-129}reattach(){ug(this._lView),this._lView[H]|=128}detectChanges(){this._lView[H]|=1024,eV(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new U(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,eb(this._lView[ee],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new U(902,!1);this._appRef=e,ug(this._lView)}},Ks=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=oV;let t=e;return t})();function oV(t){return aV(Bt(),Oe(),(t&16)===16)}function aV(t,e,n){if(rd(t)&&!n){let r=xr(t.index,e);return new Ei(r,r)}else if(t.type&47){let r=e[En];return new Ei(r,e)}return null}var MD=new Set;function Rb(t){MD.has(t)||(MD.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}var Mg=class extends Ue{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=Yp(s),i&&(i=Yp(i)),o&&(o=Yp(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Se&&e.add(a),a}};function Yp(t){return e=>{setTimeout(t,void 0,e)}}var ct=Mg;function RD(...t){}function uV(){let t=typeof _a.requestAnimationFrame=="function",e=_a[t?"requestAnimationFrame":"setTimeout"],n=_a[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var he=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ct(!1),this.onMicrotaskEmpty=new ct(!1),this.onStable=new ct(!1),this.onError=new ct(!1),typeof Zone>"u")throw new U(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=uV().nativeRequestAnimationFrame,dV(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new U(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new U(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,cV,RD,RD);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},cV={};function gm(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function lV(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(_a,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Rg(t),t.isCheckStableRunning=!0,gm(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Rg(t))}function dV(t){let e=()=>{lV(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(hV(a))return n.invokeTask(i,s,o,a);try{return ND(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),PD(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return ND(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),PD(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,Rg(t),gm(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function Rg(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function ND(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function PD(t){t._nesting--,gm(t)}function hV(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}var Nb=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let s of r)s();return!!this.handler?.execute()||r.length>0}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=L({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function fV(t,e){let n=xr(e,t),r=n[ee];pV(r,n);let i=n[Xn];i!==null&&n[Fl]===null&&(n[Fl]=lm(i,n[js])),mm(r,n,n[Kn])}function pV(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function mm(t,e,n){Wg(e);try{let r=t.viewQuery;r!==null&&Ag(1,r,n);let i=t.template;i!==null&&yb(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Tb(t,e),t.staticViewQueries&&Ag(2,t.viewQuery,n);let s=t.components;s!==null&&gV(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[H]&=-5,Kg()}}function gV(t,e){for(let n=0;n<e.length;n++)fV(t,e[n])}function Ng(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=oD(i,a);else if(s==2){let u=a,c=e[++o];r=oD(r,u+": "+c+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Ql=class extends ad{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=gi(e);return new Ra(n,this.ngModule)}};function OD(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function mV(t){let e=t.toLowerCase();return e==="svg"?Ok:e==="math"?kk:null}var Pg=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=ed(r);let i=this.injector.get(e,Kp,r);return i!==Kp||n===Kp?i:this.parentInjector.get(e,n,r)}},Ra=class extends zl{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=OD(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return OD(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=bk(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){i=i||this.ngModule;let s=i instanceof jt?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let o=s?new Pg(e,s):e,a=o.get(Ma,null);if(a===null)throw new U(407,!1);let u=o.get(mF,null),c=o.get(Nb,null),l=o.get(wg,null),d={rendererFactory:a,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:c,changeDetectionScheduler:l},h=a.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",m=r?MF(h,r,this.componentDef.encapsulation,o):JC(h,f,mV(f)),v=512;this.componentDef.signals?v|=4096:this.componentDef.onPush||(v|=16);let _=null;m!==null&&(_=lm(m,o,!0));let I=hm(0,null,null,1,0,null,null,null,null,null,null),M=ld(null,I,null,v,null,null,d,h,o,null,_);Wg(M);let T,F;try{let B=this.componentDef,z,we=null;B.findHostDirectiveDefs?(z=[],we=new Map,B.findHostDirectiveDefs(B,z,we),z.push(B)):z=[B];let Pt=yV(M,m),pp=vV(Pt,m,B,z,M,d,h);F=gC(I,Tr),m&&EV(h,B,m,r),n!==void 0&&IV(F,this.ngContentSelectors,n),T=wV(pp,B,z,we,M,[DV]),mm(I,M,null)}finally{Kg()}return new Og(this.componentType,T,ud(F,M),M,F)}},Og=class extends Eg{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Ei(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;fm(s[ee],s,i,e,n),this.previousInputValues.set(e,n);let o=xr(this._tNode.index,s);pm(o)}}get injector(){return new pi(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function yV(t,e){let n=t[ee],r=Tr;return t[r]=e,dd(n,r,2,"#host",null)}function vV(t,e,n,r,i,s,o){let a=i[ee];_V(r,t,e,o);let u=null;e!==null&&(u=lm(e,i[js]));let c=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=ld(i,Eb(n),null,l,i[t.index],t,s,c,null,null,u);return a.firstCreatePass&&Sg(a,t,r.length-1),hd(i,d),i[t.index]=d}function _V(t,e,n,r){for(let i of t)e.mergedAttrs=Da(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(Ng(e,e.mergedAttrs,!0),n!==null&&ob(r,n,e))}function wV(t,e,n,r,i,s){let o=Bt(),a=i[ee],u=rn(o,i);Db(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=Us(i,a,d,o);wi(h,i)}Cb(a,i,o),u&&wi(u,i);let c=Us(i,a,o.directiveStart+o.componentOffset,o);if(t[Kn]=i[Kn]=c,s!==null)for(let l of s)l(c,e);return vb(a,o,t),c}function EV(t,e,n,r){if(r)og(t,n,["ng-version","17.1.1"]);else{let{attrs:i,classes:s}=Tk(e.selectors[0]);i&&og(t,n,i),s&&s.length>0&&sb(t,n,s.join(" "))}}function IV(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function DV(){let t=Bt();Zg(Oe()[ee],t)}function CV(t){return Object.getPrototypeOf(t.prototype).constructor}function Qs(t){let e=CV(t.type),n=!0,r=[t];for(;e;){let i;if(Sr(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new U(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Sl(t.inputs),o.inputTransforms=Sl(t.inputTransforms),o.declaredInputs=Sl(t.declaredInputs),o.outputs=Sl(t.outputs);let a=i.hostBindings;a&&xV(t,a);let u=i.viewQuery,c=i.contentQueries;if(u&&SV(t,u),c&&AV(t,c),bV(t,i),KO(t.outputs,i.outputs),Sr(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===Qs&&(n=!1)}}e=Object.getPrototypeOf(e)}TV(r)}function bV(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function TV(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Da(i.hostAttrs,n=Da(n,i.hostAttrs))}}function Sl(t){return t===Ls?{}:t===Vt?[]:t}function SV(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function AV(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function xV(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}var k8=new RegExp(`^(\\d+)*(${lF}|${cF})*(.*)`);var MV=()=>null;function kD(t,e){return MV(t,e)}function RV(t,e,n,r){let i=e.tView,o=t[H]&4096?4096:16,a=ld(t,i,n,o,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),u=t[e.index];a[td]=u;let c=t[Ta];return c!==null&&(a[Ta]=c.createEmbeddedView(i)),mm(i,a,n),a}function FD(t,e){return!e||e.firstChild===null||ZC(t)}function NV(t,e,n,r=!0){let i=e[ee];if(W1(i,e,t,n),r){let o=vg(n,t),a=e[tt],u=om(a,t[yi]);u!==null&&G1(i,t[nn],a,e,u,o)}let s=e[Fl];s!==null&&s.firstChild!==null&&(s.firstChild=null)}var $a=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=PV;let t=e;return t})();function PV(){let t=Bt();return kV(t,Oe())}var OV=$a,Pb=class extends OV{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return ud(this._hostTNode,this._hostLView)}get injector(){return new pi(this._hostTNode,this._hostLView)}get parentInjector(){let e=Xg(this._hostTNode,this._hostLView);if(MC(e)){let n=Ul(e,this._hostLView),r=Bl(e),i=n[ee].data[r+8];return new pi(i,n)}else return new pi(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=VD(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-Lt}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=kD(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,FD(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!w1(e),a;if(o)a=n;else{let m=n||{};a=m.index,r=m.injector,i=m.projectableNodes,s=m.environmentInjector||m.ngModuleRef}let u=o?e:new Ra(gi(e)),c=r||this.parentInjector;if(!s&&u.ngModule==null){let v=(o?c:this.parentInjector).get(jt,null);v&&(s=v)}let l=gi(u.componentType??{}),d=kD(this._lContainer,l?.id??null),h=d?.firstChild??null,f=u.create(c,i,h,s);return this.insertImpl(f.hostView,a,FD(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(Lk(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[et],c=new Pb(u,u[nn],u[et]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return NV(o,i,s,r),e.attachToViewContainerRef(),BC(Zp(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=VD(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=yg(this._lContainer,n);r&&(ql(Zp(this._lContainer),n),nb(r[ee],r))}detach(e){let n=this._adjustIndex(e,-1),r=yg(this._lContainer,n);return r&&ql(Zp(this._lContainer),n)!=null?new Ei(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function VD(t){return t[Vl]}function Zp(t){return t[Vl]||(t[Vl]=[])}function kV(t,e){let n,r=e[t.index];return Jn(r)?n=r:(n=bb(r,e,null,t),e[t.index]=n,hd(e,n)),VV(n,e,t,r),new Pb(n,t,e)}function FV(t,e){let n=t[tt],r=n.createComment(""),i=rn(e,t),s=om(n,i);return Gl(n,s,r,eF(n,i),!1),r}var VV=BV,LV=()=>!1;function jV(t,e,n){return LV(t,e,n)}function BV(t,e,n,r){if(t[yi])return;let i;n.type&8?i=In(r):i=FV(e,n),t[yi]=i}function UV(t,e,n){return t[e]=n}function Na(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function $V(t,e,n,r){let i=Na(t,e,n);return Na(t,e+1,r)||i}function qV(t,e,n,r,i,s,o,a,u){let c=e.consts,l=dd(e,t,4,o||null,jl(c,a));Ib(e,n,l,jl(c,u)),Zg(e,l);let d=l.tView=hm(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function ym(t,e,n,r,i,s,o,a){let u=Oe(),c=Dn(),l=t+Tr,d=c.firstCreatePass?qV(l,c,u,e,n,r,i,s,o):c.data[l];La(d,!1);let h=HV(c,u,d,t);Qg()&&am(c,u,h,d),wi(h,u);let f=bb(h,u,h,d);return u[l]=f,hd(u,f),jV(f,d,u),Gg(d)&&_b(c,u,d),o!=null&&wb(u,d,a),ym}var HV=GV;function GV(t,e,n,r){return Yg(!0),e[tt].createComment("")}function zV(t,e,n,r){return Na(t,EC(),n)?e+GD(n)+r:Ti}function Al(t,e){return t<<17|e<<2}function Ii(t){return t>>17&32767}function WV(t){return(t&2)==2}function KV(t,e){return t&131071|e<<17}function kg(t){return t|2}function Hs(t){return(t&131068)>>2}function Xp(t,e){return t&-131069|e<<2}function QV(t){return(t&1)===1}function Fg(t){return t|1}function YV(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Ii(o),u=Hs(o);t[r]=n;let c=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||Ba(d,l)>0)&&(c=!0)}else l=n;if(i)if(u!==0){let h=Ii(t[a+1]);t[r+1]=Al(h,a),h!==0&&(t[h+1]=Xp(t[h+1],r)),t[a+1]=KV(t[a+1],r)}else t[r+1]=Al(a,0),a!==0&&(t[a+1]=Xp(t[a+1],r)),a=r;else t[r+1]=Al(u,0),a===0?a=r:t[u+1]=Xp(t[u+1],r),u=r;c&&(t[r+1]=kg(t[r+1])),LD(t,l,r,!0),LD(t,l,r,!1),ZV(e,l,t,r,s),o=Al(a,u),s?e.classBindings=o:e.styleBindings=o}function ZV(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&Ba(s,e)>=0&&(n[r+1]=Fg(n[r+1]))}function LD(t,e,n,r){let i=t[n+1],s=e===null,o=r?Ii(i):Hs(i),a=!1;for(;o!==0&&(a===!1||s);){let u=t[o],c=t[o+1];XV(u,e)&&(a=!0,t[o+1]=r?Fg(c):kg(c)),o=r?Ii(c):Hs(c)}a&&(t[n+1]=r?kg(i):Fg(i))}function XV(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?Ba(t,e)>=0:!1}function qa(t,e,n){let r=Oe(),i=EC();if(Na(r,i,e)){let s=Dn(),o=r1();FF(s,o,r,t,e,r[tt],n,!1)}return qa}function jD(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";fm(t,n,s[o],o,r)}function vm(t,e){return JV(t,e,null,!0),vm}function JV(t,e,n,r){let i=Oe(),s=Dn(),o=Zk(2);if(s.firstUpdatePass&&tL(s,t,o,r),e!==Ti&&Na(i,o,e)){let a=s.data[Ws()];oL(s,a,i,i[tt],t,i[o+1]=aL(e,n),r,o)}}function eL(t,e){return e>=t.expandoStartIndex}function tL(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[Ws()],o=eL(t,n);uL(s,r)&&e===null&&!o&&(e=!1),e=nL(i,s,e,r),YV(i,s,e,n,o,r)}}function nL(t,e,n,r){let i=t1(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=Jp(null,t,e,n,r),n=Pa(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=Jp(i,t,e,n,r),s===null){let u=rL(t,e,r);u!==void 0&&Array.isArray(u)&&(u=Jp(null,t,e,u[1],r),u=Pa(u,e.attrs,r),iL(t,e,r,u))}else s=sL(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function rL(t,e,n){let r=n?e.classBindings:e.styleBindings;if(Hs(r)!==0)return t[Ii(r)]}function iL(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Ii(i)]=r}function sL(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=Pa(r,o,n)}return Pa(r,e.attrs,n)}function Jp(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=Pa(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function Pa(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),I1(t,o,n?!0:e[++s]))}return t===void 0?null:t}function oL(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let u=t.data,c=u[a+1],l=QV(c)?BD(u,e,n,i,Hs(c),o):void 0;if(!Yl(l)){Yl(s)||WV(c)&&(s=BD(u,null,n,i,a,o));let d=pC(Ws(),n);aF(r,o,d,i,s)}}function BD(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let u=t[i],c=Array.isArray(u),l=c?u[1]:u,d=l===null,h=n[i+1];h===Ti&&(h=d?Vt:void 0);let f=d?Gp(h,r):l===r?h:void 0;if(c&&!Yl(f)&&(f=Gp(u,r)),Yl(f)&&(a=f,o))return a;let m=t[i+1];i=o?Ii(m):Hs(m)}if(e!==null){let u=s?e.residualClasses:e.residualStyles;u!=null&&(a=Gp(u,r))}return a}function Yl(t){return t!==void 0}function aL(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=yt(cm(t)))),t}function uL(t,e){return(t.flags&(e?8:16))!==0}function cL(t,e,n,r,i,s){let o=e.consts,a=jl(o,i),u=dd(e,t,2,r,a);return Ib(e,n,u,jl(o,s)),u.attrs!==null&&Ng(u,u.attrs,!1),u.mergedAttrs!==null&&Ng(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function $t(t,e,n,r){let i=Oe(),s=Dn(),o=Tr+t,a=i[tt],u=s.firstCreatePass?cL(o,s,i,e,n,r):s.data[o],c=lL(s,i,u,a,e,t);i[o]=c;let l=Gg(u);return La(u,!0),ob(a,c,u),(u.flags&32)!==32&&Qg()&&am(s,i,c,u),Uk()===0&&wi(c,i),$k(),l&&(_b(s,i,u),vb(s,u,i)),r!==null&&wb(i,u),$t}function er(){let t=Bt();wC()?Kk():(t=t.parent,La(t,!1));let e=t;Gk(e)&&zk(),qk();let n=Dn();return n.firstCreatePass&&(Zg(n,t),cC(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&u1(e)&&jD(n,e,Oe(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&c1(e)&&jD(n,e,Oe(),e.stylesWithoutHost,!1),er}function Cn(t,e,n,r){return $t(t,e,n,r),er(),Cn}var lL=(t,e,n,r,i,s)=>(Yg(!0),JC(r,i,i1()));var Zl="en-US";var dL=Zl;function hL(t){nk(t,"Expected localeId to be defined"),typeof t=="string"&&(dL=t.toLowerCase().replace(/_/g,"-"))}function Si(t){return!!t&&typeof t.then=="function"}function Ob(t){return!!t&&typeof t.subscribe=="function"}function Rr(t,e,n,r){let i=Oe(),s=Dn(),o=Bt();return pL(s,i,i[tt],o,t,e,r),Rr}function fL(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Ca],u=i[s+2];return a.length>u?a[u]:null}typeof o=="string"&&(s+=2)}return null}function pL(t,e,n,r,i,s,o){let a=Gg(r),c=t.firstCreatePass&&ZF(t),l=e[Kn],d=YF(e),h=!0;if(r.type&3||o){let v=rn(r,e),_=o?o(v):v,I=d.length,M=o?F=>o(In(F[r.index])):r.index,T=null;if(!o&&a&&(T=fL(t,e,i,r.index)),T!==null){let F=T.__ngLastListenerFn__||T;F.__ngNextListenerFn__=s,T.__ngLastListenerFn__=s,h=!1}else{s=$D(r,e,l,s,!1);let F=n.listen(_,i,s);d.push(s,F),c&&c.push(i,M,I,I+1)}}else s=$D(r,e,l,s,!1);let f=r.outputs,m;if(h&&f!==null&&(m=f[i])){let v=m.length;if(v)for(let _=0;_<v;_+=2){let I=m[_],M=m[_+1],B=e[I][M].subscribe(s),z=d.length;d.push(s,B),c&&c.push(i,r.index,z,-(z+1))}}}function UD(t,e,n,r){try{return vn(6,e,n),n(r)!==!1}catch(i){return Sb(t,i),!1}finally{vn(7,e,n)}}function $D(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?xr(t.index,e):e;pm(a);let u=UD(e,n,r,o),c=s.__ngNextListenerFn__;for(;c;)u=UD(e,n,c,o)&&u,c=c.__ngNextListenerFn__;return i&&u===!1&&o.preventDefault(),u}}var _m=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=yL;let t=e;return t})(),gL=_m,mL=class extends gL{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=RV(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new Ei(i)}};function yL(){return vL(Bt(),Oe())}function vL(t,e){return t.type&4?new mL(e,t,ud(t,e)):null}function fd(t,e=""){let n=Oe(),r=Dn(),i=t+Tr,s=r.firstCreatePass?dd(r,i,1,e,null):r.data[i],o=_L(r,n,s,e,t);n[i]=o,Qg()&&am(r,n,o,s),La(s,!1)}var _L=(t,e,n,r,i)=>(Yg(!0),$1(e[tt],r));function wm(t){return kb("",t,""),wm}function kb(t,e,n){let r=Oe(),i=zV(r,t,e,n);return i!==Ti&&XF(r,Ws(),i),kb}function wL(t,e,n){let r=Dn();if(r.firstCreatePass){let i=Sr(t);Vg(n,r.data,r.blueprint,i,!0),Vg(e,r.data,r.blueprint,i,!1)}}function Vg(t,e,n,r,i){if(t=ut(t),Array.isArray(t))for(let s=0;s<t.length;s++)Vg(t[s],e,n,r,i);else{let s=Dn(),o=Oe(),a=Bt(),u=qs(t)?t:ut(t.provide),c=WC(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(qs(t)||!t.multi){let f=new _i(c,i,ge),m=tg(u,e,i?l:l+h,d);m===-1?(dg($l(a,o),s,u),eg(s,t,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[m]=f,o[m]=f)}else{let f=tg(u,e,l+h,d),m=tg(u,e,l,l+h),v=f>=0&&n[f],_=m>=0&&n[m];if(i&&!_||!i&&!v){dg($l(a,o),s,u);let I=DL(i?IL:EL,n.length,i,r,c);!i&&_&&(n[m].providerFactory=I),eg(s,t,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(I),o.push(I)}else{let I=Fb(n[i?m:f],c,!i&&r);eg(s,t,f>-1?f:m,I)}!i&&r&&_&&n[m].componentProviders++}}}function eg(t,e,n,r){let i=qs(e),s=A1(e);if(i||s){let u=(s?ut(e.useClass):e).prototype.ngOnDestroy;if(u){let c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=c.indexOf(n);l===-1?c.push(n,[r,u]):c[l+1].push(r,u)}else c.push(n,u)}}}function Fb(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function tg(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function EL(t,e,n,r){return Lg(this.multi,[])}function IL(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Us(n,n[ee],this.providerFactory.index,r);s=a.slice(0,o),Lg(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],Lg(i,s);return s}function Lg(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function DL(t,e,n,r,i){let s=new _i(t,n,ge);return s.multi=[],s.index=e,s.componentProviders=0,Fb(s,i,r&&!n),s}function Em(t,e=[]){return n=>{n.providersResolver=(r,i)=>wL(r,i?i(t):t,e)}}var Ar=class{},Oa=class{};var jg=class extends Ar{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Ql(this);let i=iC(e);this._bootstrapComponents=YC(i.bootstrap),this._r3Injector=KC(e,n,[{provide:Ar,useValue:this},{provide:ad,useValue:this.componentFactoryResolver},...r],yt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Bg=class extends Oa{constructor(e){super(),this.moduleType=e}create(e){return new jg(this.moduleType,e,[])}};var Xl=class extends Ar{constructor(e){super(),this.componentFactoryResolver=new Ql(this),this.instance=null;let n=new xa([...e.providers,{provide:Ar,useValue:this},{provide:ad,useValue:this.componentFactoryResolver}],e.parent||tm(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Im(t,e,n=null){return new Xl({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var CL=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=HC(!1,r.type),s=i.length>0?Im([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=L({token:e,providedIn:"environment",factory:()=>new e(S(jt))});let t=e;return t})();function Ys(t){Rb("NgStandalone"),t.getStandaloneInjector=e=>e.get(CL).getOrCreateStandaloneInjector(t)}function Vb(t,e,n,r,i){return TL(Oe(),Qk(),t,e,n,r,i)}function bL(t,e){let n=t[e];return n===Ti?void 0:n}function TL(t,e,n,r,i,s,o){let a=e+n;return $V(t,a,i,s)?UV(t,a+2,o?r.call(o,i,s):r(i,s)):bL(t,a+2)}var Zn=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},Lb=new Zn("17.1.1");var pd=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Ug=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Dm=(()=>{let e=class e{compileModuleSync(r){return new Bg(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=iC(r),o=YC(s.declarations).reduce((a,u)=>{let c=gi(u);return c&&a.push(new Ra(c)),a},[]);return new Ug(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var gd=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new $e(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var jb=new k("");var Bb=new k("Application Initializer"),Ub=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=R(Bb,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Si(o))r.push(o);else if(Ob(o)){let a=new Promise((u,c)=>{o.subscribe({complete:u,error:c})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Cm=new k("appBootstrapListener");function SL(){LI(()=>{throw new U(600,!1)})}function AL(t){return t.isBoundToModule}function xL(t,e,n){try{let r=n();return Si(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}var Ha=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=R(hb),this.afterRenderEffectManager=R(Nb),this.componentTypes=[],this.components=[],this.isStable=R(gd).hasPendingTasks.pipe(V(r=>!r)),this._injector=R(jt)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof zl;if(!this._injector.get(Ub).done){let f=!s&&rC(r),m=!1;throw new U(405,m)}let a;s?a=r:a=this._injector.get(ad).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let u=AL(a)?void 0:this._injector.get(Ar),c=i||a.selector,l=a.create(Ci.NULL,[],c,u),d=l.location.nativeElement,h=l.injector.get(jb,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),ng(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new U(101,!1);try{this._runningTick=!0;for(let r of this._views)r.detectChanges()}catch(r){this.internalErrorHandler(r)}finally{try{let r=this.afterRenderEffectManager.execute()}catch(r){this.internalErrorHandler(r)}this._runningTick=!1}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;ng(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(Cm,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>ng(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new U(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ng(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}var ML=(()=>{let e=class e{constructor(){this.zone=R(he),this.applicationRef=R(Ha)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function RL(t){return[{provide:he,useFactory:t},{provide:$s,multi:!0,useFactory:()=>{let e=R(ML,{optional:!0});return()=>e.initialize()}},{provide:$s,multi:!0,useFactory:()=>{let e=R(kL);return()=>{e.initialize()}}},{provide:hb,useFactory:NL}]}function NL(){let t=R(he),e=R(Yn);return n=>t.runOutsideAngular(()=>e.handleError(n))}function PL(t){let e=RL(()=>new he(OL(t)));return id([[],e])}function OL(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var kL=(()=>{let e=class e{constructor(){this.subscription=new Se,this.initialized=!1,this.zone=R(he),this.pendingTasks=R(gd)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{he.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{he.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function FL(){return typeof $localize<"u"&&$localize.locale||Zl}var bm=new k("LocaleId",{providedIn:"root",factory:()=>R(bm,Z.Optional|Z.SkipSelf)||FL()});var $b=new k("PlatformDestroyListeners");var Pl=null;function VL(t=[],e){return Ci.create({name:e,providers:[{provide:sd,useValue:"platform"},{provide:$b,useValue:new Set([()=>Pl=null])},...t]})}function LL(t=[]){if(Pl)return Pl;let e=VL(t);return Pl=e,SL(),jL(e),e}function jL(t){t.get(rm,null)?.forEach(n=>n())}function Tm(){return!1}function qb(t){try{let{rootComponent:e,appProviders:n,platformProviders:r}=t,i=LL(r),s=[PL(),...n||[]],a=new Xl({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1}).injector,u=a.get(he);return u.run(()=>{a.resolveInjectorInitializers();let c=a.get(Yn,null),l;u.runOutsideAngular(()=>{l=u.onError.subscribe({next:f=>{c.handleError(f)}})});let d=()=>a.destroy(),h=i.get($b);return h.add(d),a.onDestroy(()=>{l.unsubscribe(),h.delete(d)}),xL(c,u,()=>{let f=a.get(Ub);return f.runInitializers(),f.donePromise.then(()=>{let m=a.get(bm,Zl);hL(m||Zl);let v=a.get(Ha);return e!==void 0&&v.bootstrap(e),v})})})}catch(e){return Promise.reject(e)}}function md(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}var Am=null;function tr(){return Am}function Kb(t){Am||(Am=t)}var yd=class{},bt=new k("DocumentToken"),Qb=(()=>{let e=class e{historyGo(r){throw new Error("Not implemented")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:()=>R($L),providedIn:"platform"});let t=e;return t})();var $L=(()=>{let e=class e extends Qb{constructor(){super(),this._doc=R(bt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return tr().getBaseHref(this._doc)}onPopState(r){let i=tr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=tr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function Yb(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function Hb(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function Ai(t){return t&&t[0]!=="?"?"?"+t:t}var _d=(()=>{let e=class e{historyGo(r){throw new Error("Not implemented")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:()=>R(Zb),providedIn:"root"});let t=e;return t})(),qL=new k("appBaseHref"),Zb=(()=>{let e=class e extends _d{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??R(bt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return Yb(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Ai(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Ai(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Ai(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(S(Qb),S(qL,8))},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Ga=(()=>{let e=class e{constructor(r){this._subject=new ct,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=zL(Hb(Gb(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Ai(i))}normalize(r){return e.stripTrailingSlash(GL(this._basePath,Gb(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Ai(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Ai(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Ai,e.joinWithSlash=Yb,e.stripTrailingSlash=Hb,e.\u0275fac=function(i){return new(i||e)(S(_d))},e.\u0275prov=L({token:e,factory:()=>HL(),providedIn:"root"});let t=e;return t})();function HL(){return new Ga(S(_d))}function GL(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function Gb(t){return t.replace(/\/index.html$/,"")}function zL(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function Xb(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var Sm=/\s+/,zb=[],Jb=(()=>{let e=class e{constructor(r,i){this._ngEl=r,this._renderer=i,this.initialClasses=zb,this.stateMap=new Map}set klass(r){this.initialClasses=r!=null?r.trim().split(Sm):zb}set ngClass(r){this.rawClass=typeof r=="string"?r.trim().split(Sm):r}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let r=this.rawClass;if(Array.isArray(r)||r instanceof Set)for(let i of r)this._updateState(i,!0);else if(r!=null)for(let i of Object.keys(r))this._updateState(i,!!r[i]);this._applyStateDiff()}_updateState(r,i){let s=this.stateMap.get(r);s!==void 0?(s.enabled!==i&&(s.changed=!0,s.enabled=i),s.touched=!0):this.stateMap.set(r,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let r of this.stateMap){let i=r[0],s=r[1];s.changed?(this._toggleClass(i,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),s.touched=!1}}_toggleClass(r,i){r=r.trim(),r.length>0&&r.split(Sm).forEach(s=>{i?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}};e.\u0275fac=function(i){return new(i||e)(ge(Mr),ge(bi))},e.\u0275dir=tn({type:e,selectors:[["","ngClass",""]],inputs:{klass:[It.None,"class","klass"],ngClass:"ngClass"},standalone:!0});let t=e;return t})();var xm=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},e0=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new xm(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let u=i.get(o);i.move(u,a),Wb(u,s)}});for(let s=0,o=i.length;s<o;s++){let u=i.get(s).context;u.index=s,u.count=o,u.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);Wb(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(ge($a),ge(_m),ge(dm))},e.\u0275dir=tn({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function Wb(t,e){t.context.$implicit=e.item}var Mm=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ct({type:e}),e.\u0275inj=Dt({});let t=e;return t})(),t0="browser",WL="server";function xi(t){return t===WL}var vd=class{};var Pm=class extends yd{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Om=class t extends Pm{static makeCurrent(){Kb(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=QL();return n==null?null:YL(n)}resetBaseElement(){za=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Xb(document.cookie,e)}},za=null;function QL(){return za=za||document.querySelector("base"),za?za.getAttribute("href"):null}function YL(t){return new URL(t,document.baseURI).pathname}var ZL=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac});let t=e;return t})(),km=new k("EventManagerPlugins"),s0=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new U(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(S(km),S(he))},e.\u0275prov=L({token:e,factory:e.\u0275fac});let t=e;return t})(),wd=class{constructor(e){this._doc=e}},Rm="ng-app-id",o0=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=xi(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${Rm}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(Rm),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Rm,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(S(bt),S(nm),S(im,8),S(Ut))},e.\u0275prov=L({token:e,factory:e.\u0275fac});let t=e;return t})(),Nm={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Vm=/%COMP%/g,a0="%COMP%",XL=`_nghost-${a0}`,JL=`_ngcontent-${a0}`,e2=!0,t2=new k("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>e2});function n2(t){return JL.replace(Vm,t)}function r2(t){return XL.replace(Vm,t)}function u0(t,e){return e.map(n=>n.replace(Vm,t))}var n0=(()=>{let e=class e{constructor(r,i,s,o,a,u,c,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=u,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=xi(u),this.defaultRenderer=new Wa(r,a,c,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===wn.ShadowDom&&(i=ae(x({},i),{encapsulation:wn.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Ed?s.applyToHost(r):s instanceof Ka&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,u=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case wn.Emulated:o=new Ed(c,l,i,this.appId,d,a,u,h);break;case wn.ShadowDom:return new Fm(c,l,r,i,a,u,this.nonce,h);default:o=new Ka(c,l,i,d,a,u,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(S(s0),S(o0),S(nm),S(t2),S(bt),S(Ut),S(he),S(im))},e.\u0275prov=L({token:e,factory:e.\u0275fac});let t=e;return t})(),Wa=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Nm[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(r0(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(r0(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new U(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=Nm[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=Nm[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Qn.DashCase|Qn.Important)?e.style.setProperty(n,r,i&Qn.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Qn.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=tr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function r0(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var Fm=class extends Wa{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=u0(i.id,i.styles);for(let l of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ka=class extends Wa{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?u0(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Ed=class extends Ka{constructor(e,n,r,i,s,o,a,u){let c=i+"-"+r.id;super(e,n,r,s,o,a,u,c),this.contentAttr=n2(c),this.hostAttr=r2(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},i2=(()=>{let e=class e extends wd{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(S(bt))},e.\u0275prov=L({token:e,factory:e.\u0275fac});let t=e;return t})(),i0=["alt","control","meta","shift"],s2={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},o2={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},a2=(()=>{let e=class e extends wd{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>tr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",u=i.indexOf("code");if(u>-1&&(i.splice(u,1),a="code."),i0.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=s,c.fullKey=a,c}static matchEventFullKeyCode(r,i){let s=s2[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),i0.forEach(a=>{if(a!==s){let u=o2[a];u(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(S(bt))},e.\u0275prov=L({token:e,factory:e.\u0275fac});let t=e;return t})();function c0(t,e){return qb(x({rootComponent:t},u2(e)))}function u2(t){return{appProviders:[...f2,...t?.providers??[]],platformProviders:h2}}function c2(){Om.makeCurrent()}function l2(){return new Yn}function d2(){return QC(document),document}var h2=[{provide:Ut,useValue:t0},{provide:rm,useValue:c2,multi:!0},{provide:bt,useFactory:d2,deps:[]}];var f2=[{provide:sd,useValue:"root"},{provide:Yn,useFactory:l2,deps:[]},{provide:km,useClass:i2,multi:!0,deps:[bt,he,Ut]},{provide:km,useClass:a2,multi:!0,deps:[bt]},n0,o0,s0,{provide:Ma,useExisting:n0},{provide:vd,useClass:ZL,deps:[]},[]];function p2(){return new Lm(S(bt))}var Lm=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(S(bt))},e.\u0275prov=L({token:e,factory:function(i){let s=null;return i?s=new i:s=p2(),s},providedIn:"root"});let t=e;return t})();var K="primary",cu=Symbol("RouteTitle"),qm=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function to(t){return new qm(t)}function y2(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function v2(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!bn(t[n],e[n]))return!1;return!0}function bn(t,e){let n=t?Hm(t):void 0,r=e?Hm(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!g0(t[i],e[i]))return!1;return!0}function Hm(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function g0(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function m0(t){return t.length>0?t[t.length-1]:null}function kr(t){return Op(t)?t:Si(t)?ue(Promise.resolve(t)):j(t)}var _2={exact:v0,subset:_0},y0={exact:w2,subset:E2,ignored:()=>!0};function l0(t,e,n){return _2[n.paths](t.root,e.root,n.matrixParams)&&y0[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function w2(t,e){return bn(t,e)}function v0(t,e,n){if(!Ri(t.segments,e.segments)||!Cd(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!v0(t.children[r],e.children[r],n))return!1;return!0}function E2(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>g0(t[n],e[n]))}function _0(t,e,n){return w0(t,e,e.segments,n)}function w0(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Ri(i,n)||e.hasChildren()||!Cd(i,n,r))}else if(t.segments.length===n.length){if(!Ri(t.segments,n)||!Cd(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!_0(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Ri(t.segments,i)||!Cd(t.segments,i,r)||!t.children[K]?!1:w0(t.children[K],e,s,r)}}function Cd(t,e,n){return e.every((r,i)=>y0[n](t[i].parameters,r.parameters))}var Nr=class{constructor(e=new ce([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=to(this.queryParams),this._queryParamMap}toString(){return C2.serialize(this)}},ce=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return bd(this)}},Mi=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=to(this.parameters),this._parameterMap}toString(){return I0(this)}};function I2(t,e){return Ri(t,e)&&t.every((n,r)=>bn(n.parameters,e[r].parameters))}function Ri(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function D2(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===K&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==K&&(n=n.concat(e(i,r)))}),n}var my=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:()=>new Sd,providedIn:"root"});let t=e;return t})(),Sd=class{parse(e){let n=new zm(e);return new Nr(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${Qa(e.root,!0)}`,r=S2(e.queryParams),i=typeof e.fragment=="string"?`#${b2(e.fragment)}`:"";return`${n}${r}${i}`}},C2=new Sd;function bd(t){return t.segments.map(e=>I0(e)).join("/")}function Qa(t,e){if(!t.hasChildren())return bd(t);if(e){let n=t.children[K]?Qa(t.children[K],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==K&&r.push(`${i}:${Qa(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=D2(t,(r,i)=>i===K?[Qa(t.children[K],!1)]:[`${i}:${Qa(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[K]!=null?`${bd(t)}/${n[0]}`:`${bd(t)}/(${n.join("//")})`}}function E0(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Id(t){return E0(t).replace(/%3B/gi,";")}function b2(t){return encodeURI(t)}function Gm(t){return E0(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Td(t){return decodeURIComponent(t)}function d0(t){return Td(t.replace(/\+/g,"%20"))}function I0(t){return`${Gm(t.path)}${T2(t.parameters)}`}function T2(t){return Object.entries(t).map(([e,n])=>`;${Gm(e)}=${Gm(n)}`).join("")}function S2(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${Id(n)}=${Id(i)}`).join("&"):`${Id(n)}=${Id(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var A2=/^[^\/()?;#]+/;function jm(t){let e=t.match(A2);return e?e[0]:""}var x2=/^[^\/()?;=#]+/;function M2(t){let e=t.match(x2);return e?e[0]:""}var R2=/^[^=?&#]+/;function N2(t){let e=t.match(R2);return e?e[0]:""}var P2=/^[^&#]+/;function O2(t){let e=t.match(P2);return e?e[0]:""}var zm=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ce([],{}):new ce([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[K]=new ce(e,n)),r}parseSegment(){let e=jm(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new U(4009,!1);return this.capture(e),new Mi(Td(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=M2(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=jm(this.remaining);i&&(r=i,this.capture(r))}e[Td(n)]=Td(r)}parseQueryParam(e){let n=N2(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=O2(this.remaining);o&&(r=o,this.capture(r))}let i=d0(n),s=d0(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=jm(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new U(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=K);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[K]:new ce([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new U(4011,!1)}};function D0(t){return t.segments.length>0?new ce([],{[K]:t}):t}function C0(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=C0(i);if(r===K&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new ce(t.segments,e);return k2(n)}function k2(t){if(t.numberOfChildren===1&&t.children[K]){let e=t.children[K];return new ce(t.segments.concat(e.segments),e.children)}return t}function no(t){return t instanceof Nr}function F2(t,e,n=null,r=null){let i=b0(t);return T0(i,e,n,r)}function b0(t){let e;function n(s){let o={};for(let u of s.children){let c=n(u);o[u.outlet]=c}let a=new ce(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=D0(r);return e??i}function T0(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return Bm(i,i,i,n,r);let s=V2(e);if(s.toRoot())return Bm(i,i,new ce([],{}),n,r);let o=L2(s,i,t),a=o.processChildren?Xa(o.segmentGroup,o.index,s.commands):A0(o.segmentGroup,o.index,s.commands);return Bm(i,o.segmentGroup,a,n,r)}function Ad(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function tu(t){return typeof t=="object"&&t!=null&&t.outlets}function Bm(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([u,c])=>{s[u]=Array.isArray(c)?c.map(l=>`${l}`):`${c}`});let o;t===e?o=n:o=S0(t,e,n);let a=D0(C0(o));return new Nr(a,s,i)}function S0(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=S0(s,e,n)}),new ce(t.segments,r)}var xd=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&Ad(r[0]))throw new U(4003,!1);let i=r.find(tu);if(i&&i!==m0(r))throw new U(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function V2(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new xd(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,c])=>{a[u]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new xd(n,e,r)}var Js=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function L2(t,e,n){if(t.isAbsolute)return new Js(e,!0,0);if(!n)return new Js(e,!1,NaN);if(n.parent===null)return new Js(n,!0,0);let r=Ad(t.commands[0])?0:1,i=n.segments.length-1+r;return j2(n,i,t.numberOfDoubleDots)}function j2(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new U(4005,!1);i=r.segments.length}return new Js(r,!1,i-s)}function B2(t){return tu(t[0])?t[0].outlets:{[K]:t}}function A0(t,e,n){if(t??=new ce([],{}),t.segments.length===0&&t.hasChildren())return Xa(t,e,n);let r=U2(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new ce(t.segments.slice(0,r.pathIndex),{});return s.children[K]=new ce(t.segments.slice(r.pathIndex),t.children),Xa(s,0,i)}else return r.match&&i.length===0?new ce(t.segments,{}):r.match&&!t.hasChildren()?Wm(t,e,n):r.match?Xa(t,0,i):Wm(t,e,n)}function Xa(t,e,n){if(n.length===0)return new ce(t.segments,{});{let r=B2(n),i={};if(Object.keys(r).some(s=>s!==K)&&t.children[K]&&t.numberOfChildren===1&&t.children[K].segments.length===0){let s=Xa(t.children[K],e,n);return new ce(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=A0(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new ce(t.segments,i)}}function U2(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(tu(a))break;let u=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&u===void 0)break;if(u&&c&&typeof c=="object"&&c.outlets===void 0){if(!f0(u,c,o))return s;r+=2}else{if(!f0(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Wm(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(tu(s)){let u=$2(s.outlets);return new ce(r,u)}if(i===0&&Ad(n[0])){let u=t.segments[e];r.push(new Mi(u.path,h0(n[0]))),i++;continue}let o=tu(s)?s.outlets[K]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&Ad(a)?(r.push(new Mi(o,h0(a))),i+=2):(r.push(new Mi(o,{})),i++)}return new ce(r,{})}function $2(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=Wm(new ce([],{}),0,r))}),e}function h0(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function f0(t,e,n){return t==n.path&&bn(e,n.parameters)}var Ja="imperative",Qe=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(Qe||{}),Ht=class{constructor(e,n){this.id=e,this.url=n}},nu=class extends Ht{constructor(e,n,r="imperative",i=null){super(e,n),this.type=Qe.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ni=class extends Ht{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=Qe.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},qt=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(qt||{}),Km=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(Km||{}),Pr=class extends Ht{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=Qe.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Pi=class extends Ht{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=Qe.NavigationSkipped}},ru=class extends Ht{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=Qe.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Md=class extends Ht{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Qe.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Qm=class extends Ht{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Qe.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ym=class extends Ht{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Qe.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Zm=class extends Ht{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Qe.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Xm=class extends Ht{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Qe.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Jm=class{constructor(e){this.route=e,this.type=Qe.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},ey=class{constructor(e){this.route=e,this.type=Qe.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},ty=class{constructor(e){this.snapshot=e,this.type=Qe.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ny=class{constructor(e){this.snapshot=e,this.type=Qe.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ry=class{constructor(e){this.snapshot=e,this.type=Qe.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},iy=class{constructor(e){this.snapshot=e,this.type=Qe.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var iu=class{},su=class{constructor(e){this.url=e}};var sy=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Fd,this.attachRef=null}},Fd=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new sy,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Rd=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=oy(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=oy(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=ay(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return ay(e,this._root).map(n=>n.value)}};function oy(t,e){if(t===e.value)return e;for(let n of e.children){let r=oy(t,n);if(r)return r}return null}function ay(t,e){if(t===e.value)return[e];for(let n of e.children){let r=ay(t,n);if(r.length)return r.unshift(e),r}return[]}var Tt=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Xs(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var Nd=class extends Rd{constructor(e,n){super(e),this.snapshot=n,vy(this,e)}toString(){return this.snapshot.toString()}};function x0(t){let e=q2(t),n=new $e([new Mi("",{})]),r=new $e({}),i=new $e({}),s=new $e({}),o=new $e(""),a=new Or(n,r,s,o,i,K,t,e.root);return a.snapshot=e.root,new Nd(new Tt(a,[]),e)}function q2(t){let e={},n={},r={},i="",s=new ou([],e,r,i,n,K,t,null,{});return new Pd("",new Tt(s,[]))}var Or=class{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(V(c=>c[cu]))??j(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(V(e=>to(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(V(e=>to(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function yy(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:x(x({},e.params),t.params),data:x(x({},e.data),t.data),resolve:x(x(x(x({},t.data),e.data),i?.data),t._resolvedData)}:r={params:x({},t.params),data:x({},t.data),resolve:x(x({},t.data),t._resolvedData??{})},i&&R0(i)&&(r.resolve[cu]=i.title),r}var ou=class{get title(){return this.data?.[cu]}constructor(e,n,r,i,s,o,a,u,c){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=to(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=to(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},Pd=class extends Rd{constructor(e,n){super(n),this.url=e,vy(this,n)}toString(){return M0(this._root)}};function vy(t,e){e.value._routerState=t,e.children.forEach(n=>vy(t,n))}function M0(t){let e=t.children.length>0?` { ${t.children.map(M0).join(", ")} } `:"";return`${t.value}${e}`}function Um(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,bn(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),bn(e.params,n.params)||t.paramsSubject.next(n.params),v2(e.url,n.url)||t.urlSubject.next(n.url),bn(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function uy(t,e){let n=bn(t.params,e.params)&&I2(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||uy(t.parent,e.parent))}function R0(t){return typeof t.title=="string"||t.title===null}var _y=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=K,this.activateEvents=new ct,this.deactivateEvents=new ct,this.attachEvents=new ct,this.detachEvents=new ct,this.parentContexts=R(Fd),this.location=R($a),this.changeDetector=R(Ks),this.environmentInjector=R(jt),this.inputBinder=R(wy,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new U(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new U(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new U(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new U(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new cy(r,u,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=tn({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[zs]});let t=e;return t})(),cy=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Or?this.route:e===Fd?this.childContexts:this.parent.get(e,n)}},wy=new k("");function H2(t,e,n){let r=au(t,e._root,n?n._root:void 0);return new Nd(r,e)}function au(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=G2(t,e,n);return new Tt(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>au(t,a)),o}}let r=z2(e.value),i=e.children.map(s=>au(t,s));return new Tt(r,i)}}function G2(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return au(t,r,i);return au(t,r)})}function z2(t){return new Or(new $e(t.url),new $e(t.params),new $e(t.queryParams),new $e(t.fragment),new $e(t.data),t.outlet,t.component,t)}var N0="ngNavigationCancelingError";function P0(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=no(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=O0(!1,qt.Redirect,e);return i.url=n,i.navigationBehaviorOptions=r,i}function O0(t,e,n){let r=new Error("NavigationCancelingError: "+(t||""));return r[N0]=!0,r.cancellationCode=e,n&&(r.url=n),r}function W2(t){return k0(t)&&no(t.url)}function k0(t){return t&&t[N0]}var K2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Gs({type:e,selectors:[["ng-component"]],standalone:!0,features:[Ys],decls:1,vars:0,template:function(i,s){i&1&&Cn(0,"router-outlet")},dependencies:[_y],encapsulation:2});let t=e;return t})();function Q2(t,e){return t.providers&&!t._injector&&(t._injector=Im(t.providers,e,`Route: ${t.path}`)),t._injector??e}function Ey(t){let e=t.children&&t.children.map(Ey),n=e?ae(x({},t),{children:e}):x({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==K&&(n.component=K2),n}function Tn(t){return t.outlet||K}function Y2(t,e){let n=t.filter(r=>Tn(r)===e);return n.push(...t.filter(r=>Tn(r)!==e)),n}function lu(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var Z2=(t,e,n,r)=>V(i=>(new ly(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),ly=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Um(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=Xs(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Xs(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Xs(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=Xs(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new iy(s.value.snapshot))}),e.children.length&&this.forwardEvent(new ny(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(Um(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Um(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=lu(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Od=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},eo=class{constructor(e,n){this.component=e,this.route=n}};function X2(t,e,n){let r=t._root,i=e?e._root:null;return Ya(r,i,n,[r.value])}function J2(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function io(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!zD(t)?t:e.get(t):r}function Ya(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Xs(e);return t.children.forEach(o=>{ej(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>eu(a,n.getContext(o),i)),i}function ej(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=tj(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new Od(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Ya(t,e,a?a.children:null,r,i):Ya(t,e,n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new eo(a.outlet.component,o))}else o&&eu(e,a,i),i.canActivateChecks.push(new Od(r)),s.component?Ya(t,null,a?a.children:null,r,i):Ya(t,null,n,r,i);return i}function tj(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Ri(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Ri(t.url,e.url)||!bn(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!uy(t,e)||!bn(t.queryParams,e.queryParams);case"paramsChange":default:return!uy(t,e)}}function eu(t,e,n){let r=Xs(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?eu(o,e.children.getContext(s),n):eu(o,null,n):eu(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new eo(e.outlet.component,i)):n.canDeactivateChecks.push(new eo(null,i)):n.canDeactivateChecks.push(new eo(null,i))}function du(t){return typeof t=="function"}function nj(t){return typeof t=="boolean"}function rj(t){return t&&du(t.canLoad)}function ij(t){return t&&du(t.canActivate)}function sj(t){return t&&du(t.canActivateChild)}function oj(t){return t&&du(t.canDeactivate)}function aj(t){return t&&du(t.canMatch)}function F0(t){return t instanceof zn||t?.name==="EmptyError"}var Dd=Symbol("INITIAL_VALUE");function ro(){return Ae(t=>El(t.map(e=>e.pipe(Wn(1),hi(Dd)))).pipe(V(e=>{for(let n of e)if(n!==!0){if(n===Dd)return Dd;if(n===!1||n instanceof Nr)return n}return!0}),Je(e=>e!==Dd),Wn(1)))}function uj(t,e){return qe(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?j(ae(x({},n),{guardsResult:!0})):cj(o,r,i,t).pipe(qe(a=>a&&nj(a)?lj(r,s,t,e):j(a)),V(a=>ae(x({},n),{guardsResult:a})))})}function cj(t,e,n,r){return ue(t).pipe(qe(i=>gj(i.component,i.route,n,e,r)),kt(i=>i!==!0,!0))}function lj(t,e,n,r){return ue(e).pipe(Ns(i=>Rs(hj(i.route.parent,r),dj(i.route,r),pj(t,i.path,n),fj(t,i.route,n))),kt(i=>i!==!0,!0))}function dj(t,e){return t!==null&&e&&e(new ry(t)),j(!0)}function hj(t,e){return t!==null&&e&&e(new ty(t)),j(!0)}function fj(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return j(!0);let i=r.map(s=>Il(()=>{let o=lu(e)??n,a=io(s,o),u=ij(a)?a.canActivate(e,t):Di(o,()=>a(e,t));return kr(u).pipe(kt())}));return j(i).pipe(ro())}function pj(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>J2(o)).filter(o=>o!==null).map(o=>Il(()=>{let a=o.guards.map(u=>{let c=lu(o.node)??n,l=io(u,c),d=sj(l)?l.canActivateChild(r,t):Di(c,()=>l(r,t));return kr(d).pipe(kt())});return j(a).pipe(ro())}));return j(s).pipe(ro())}function gj(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return j(!0);let o=s.map(a=>{let u=lu(e)??i,c=io(a,u),l=oj(c)?c.canDeactivate(t,e,n,r):Di(u,()=>c(t,e,n,r));return kr(l).pipe(kt())});return j(o).pipe(ro())}function mj(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return j(!0);let s=i.map(o=>{let a=io(o,t),u=rj(a)?a.canLoad(e,n):Di(t,()=>a(e,n));return kr(u)});return j(s).pipe(ro(),V0(r))}function V0(t){return Ap(Pe(e=>{if(no(e))throw P0(t,e)}),V(e=>e===!0))}function yj(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return j(!0);let s=i.map(o=>{let a=io(o,t),u=aj(a)?a.canMatch(e,n):Di(t,()=>a(e,n));return kr(u)});return j(s).pipe(ro(),V0(r))}var uu=class{constructor(e){this.segmentGroup=e||null}},kd=class extends Error{constructor(e){super(),this.urlTree=e}};function Zs(t){return Ms(new uu(t))}function vj(t){return Ms(new U(4e3,!1))}function _j(t){return Ms(O0(!1,qt.GuardRejected))}var dy=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return j(r);if(i.numberOfChildren>1||!i.children[K])return vj(e.redirectTo);i=i.children[K]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new kd(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new Nr(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new ce(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new U(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},hy={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function wj(t,e,n,r,i){let s=Iy(t,e,n);return s.matched?(r=Q2(e,r),yj(r,e,n,i).pipe(V(o=>o===!0?s:x({},hy)))):j(s)}function Iy(t,e,n){if(e.path==="**")return Ej(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?x({},hy):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||y2)(n,t,e);if(!i)return x({},hy);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?x(x({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function Ej(t){return{matched:!0,parameters:t.length>0?m0(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function p0(t,e,n,r){return n.length>0&&Cj(t,n,r)?{segmentGroup:new ce(e,Dj(r,new ce(n,t.children))),slicedSegments:[]}:n.length===0&&bj(t,n,r)?{segmentGroup:new ce(t.segments,Ij(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new ce(t.segments,t.children),slicedSegments:n}}function Ij(t,e,n,r){let i={};for(let s of n)if(Vd(t,e,s)&&!r[Tn(s)]){let o=new ce([],{});i[Tn(s)]=o}return x(x({},r),i)}function Dj(t,e){let n={};n[K]=e;for(let r of t)if(r.path===""&&Tn(r)!==K){let i=new ce([],{});n[Tn(r)]=i}return n}function Cj(t,e,n){return n.some(r=>Vd(t,e,r)&&Tn(r)!==K)}function bj(t,e,n){return n.some(r=>Vd(t,e,r))}function Vd(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function Tj(t,e,n,r){return Tn(t)!==r&&(r===K||!Vd(e,n,t))?!1:Iy(e,t,n).matched}function Sj(t,e,n){return e.length===0&&!t.children[n]}var fy=class{};function Aj(t,e,n,r,i,s,o="emptyOnly"){return new py(t,e,n,r,i,o,s).recognize()}var xj=31,py=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new dy(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new U(4002,`'${e.segmentGroup}'`)}recognize(){let e=p0(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(V(n=>{let r=new ou([],Object.freeze({}),Object.freeze(x({},this.urlTree.queryParams)),this.urlTree.fragment,{},K,this.rootComponentType,null,{}),i=new Tt(r,n),s=new Pd("",i),o=F2(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,K).pipe(Ir(r=>{if(r instanceof kd)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof uu?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=yy(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(V(s=>s instanceof Tt?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ue(i).pipe(Ns(s=>{let o=r.children[s],a=Y2(n,s);return this.processSegmentGroup(e,a,o,s)}),di((s,o)=>(s.push(...o),s)),Dr(null),jp(),qe(s=>{if(s===null)return Zs(r);let o=L0(s);return Mj(o),j(o)}))}processSegment(e,n,r,i,s,o){return ue(n).pipe(Ns(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(Ir(u=>{if(u instanceof uu)return j(null);throw u}))),kt(a=>!!a),Ir(a=>{if(F0(a))return Sj(r,i,s)?j(new fy):Zs(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return Tj(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):Zs(i):Zs(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:u,positionalParamSegments:c,remainingSegments:l}=Iy(n,i,s);if(!a)return Zs(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>xj&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,c);return this.applyRedirects.lineralizeSegments(i,d).pipe(qe(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=wj(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Ae(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Ae(({routes:u})=>{let c=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new ou(l,h,Object.freeze(x({},this.urlTree.queryParams)),this.urlTree.fragment,Nj(r),Tn(r),r.component??r._loadedComponent??null,r,Pj(r)),{segmentGroup:m,slicedSegments:v}=p0(n,l,d,u);if(v.length===0&&m.hasChildren())return this.processChildren(c,u,m).pipe(V(I=>I===null?null:new Tt(f,I)));if(u.length===0&&v.length===0)return j(new Tt(f,[]));let _=Tn(r)===s;return this.processSegment(c,u,m,v,_?K:s,!0).pipe(V(I=>new Tt(f,I instanceof Tt?[I]:[])))}))):Zs(n)))}getChildConfig(e,n,r){return n.children?j({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?j({routes:n._loadedRoutes,injector:n._loadedInjector}):mj(e,n,r,this.urlSerializer).pipe(qe(i=>i?this.configLoader.loadChildren(e,n).pipe(Pe(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):_j(n))):j({routes:[],injector:e})}};function Mj(t){t.sort((e,n)=>e.value.outlet===K?-1:n.value.outlet===K?1:e.value.outlet.localeCompare(n.value.outlet))}function Rj(t){let e=t.value.routeConfig;return e&&e.path===""}function L0(t){let e=[],n=new Set;for(let r of t){if(!Rj(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=L0(r.children);e.push(new Tt(r.value,i))}return e.filter(r=>!n.has(r))}function Nj(t){return t.data||{}}function Pj(t){return t.resolve||{}}function Oj(t,e,n,r,i,s){return qe(o=>Aj(t,e,n,r,o.extractedUrl,i,s).pipe(V(({state:a,tree:u})=>ae(x({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function kj(t,e){return qe(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return j(n);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let c of j0(u))o.add(c);let a=0;return ue(o).pipe(Ns(u=>s.has(u)?Fj(u,r,t,e):(u.data=yy(u,u.parent,t).resolve,j(void 0))),Pe(()=>a++),Ps(1),qe(u=>a===o.size?j(n):gt))})}function j0(t){let e=t.children.map(n=>j0(n)).flat();return[t,...e]}function Fj(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!R0(i)&&(s[cu]=i.title),Vj(s,t,e,r).pipe(V(o=>(t._resolvedData=o,t.data=yy(t,t.parent,n).resolve,null)))}function Vj(t,e,n,r){let i=Hm(t);if(i.length===0)return j({});let s={};return ue(i).pipe(qe(o=>Lj(t[o],e,n,r).pipe(kt(),Pe(a=>{s[o]=a}))),Ps(1),Vp(s),Ir(o=>F0(o)?gt:Ms(o)))}function Lj(t,e,n,r){let i=lu(e)??r,s=io(t,i),o=s.resolve?s.resolve(e,n):Di(i,()=>s(e,n));return kr(o)}function $m(t){return Ae(e=>{let n=t(e);return n?ue(n).pipe(V(()=>e)):j(e)})}var B0=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===K);return i}getResolvedTitleForRoute(r){return r.data[cu]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:()=>R(jj),providedIn:"root"});let t=e;return t})(),jj=(()=>{let e=class e extends B0{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(S(Lm))},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Dy=new k("",{providedIn:"root",factory:()=>({})}),Cy=new k("ROUTES"),Bj=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=R(Dm)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return j(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=kr(r.loadComponent()).pipe(V(U0),Pe(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),ma(()=>{this.componentLoaders.delete(r)})),s=new Ts(i,()=>new Ue).pipe(bs());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return j({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=Uj(i,this.compiler,r,this.onLoadEndListener).pipe(ma(()=>{this.childrenLoaders.delete(i)})),a=new Ts(o,()=>new Ue).pipe(bs());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Uj(t,e,n,r){return kr(t.loadChildren()).pipe(V(U0),qe(i=>i instanceof Oa||Array.isArray(i)?j(i):ue(e.compileModuleAsync(i))),V(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Cy,[],{optional:!0,self:!0}).flat()),{routes:o.map(Ey),injector:s}}))}function $j(t){return t&&typeof t=="object"&&"default"in t}function U0(t){return $j(t)?t.default:t}var by=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:()=>R(qj),providedIn:"root"});let t=e;return t})(),qj=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Hj=new k("");var Gj=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ue,this.transitionAbortSubject=new Ue,this.configLoader=R(Bj),this.environmentInjector=R(jt),this.urlSerializer=R(my),this.rootContexts=R(Fd),this.location=R(Ga),this.inputBindingEnabled=R(wy,{optional:!0})!==null,this.titleStrategy=R(B0),this.options=R(Dy,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=R(by),this.createViewTransition=R(Hj,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>j(void 0),this.rootComponentType=null;let r=s=>this.events.next(new Jm(s)),i=s=>this.events.next(new ey(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ae(x(x({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new $e({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Ja,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Je(o=>o.id!==0),V(o=>ae(x({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ae(o=>{this.currentTransition=o;let a=!1,u=!1;return j(o).pipe(Pe(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?ae(x({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Ae(c=>{let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new Pi(c.id,this.urlSerializer.serialize(c.rawUrl),h,Km.IgnoredSameUrlNavigation)),c.resolve(null),gt}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return j(c).pipe(Ae(h=>{let f=this.transitions?.getValue();return this.events.next(new nu(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?gt:Promise.resolve(h)}),Oj(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Pe(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=ae(x({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new Md(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:f,source:m,restoredState:v,extras:_}=c,I=new nu(h,this.urlSerializer.serialize(f),m,v);this.events.next(I);let M=x0(this.rootComponentType).snapshot;return this.currentTransition=o=ae(x({},c),{targetSnapshot:M,urlAfterRedirects:f,extras:ae(x({},_),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,j(o)}else{let h="";return this.events.next(new Pi(c.id,this.urlSerializer.serialize(c.extractedUrl),h,Km.IgnoredByUrlHandlingStrategy)),c.resolve(null),gt}}),Pe(c=>{let l=new Qm(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),V(c=>(this.currentTransition=o=ae(x({},c),{guards:X2(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),uj(this.environmentInjector,c=>this.events.next(c)),Pe(c=>{if(o.guardsResult=c.guardsResult,no(c.guardsResult))throw P0(this.urlSerializer,c.guardsResult);let l=new Ym(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),Je(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",qt.GuardRejected),!1)),$m(c=>{if(c.guards.canActivateChecks.length)return j(c).pipe(Pe(l=>{let d=new Zm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Ae(l=>{let d=!1;return j(l).pipe(kj(this.paramsInheritanceStrategy,this.environmentInjector),Pe({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",qt.NoDataFromResolver)}}))}),Pe(l=>{let d=new Xm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),$m(c=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(Pe(f=>{d.component=f}),V(()=>{})));for(let f of d.children)h.push(...l(f));return h};return El(l(c.targetSnapshot.root)).pipe(Dr(null),Wn(1))}),$m(()=>this.afterPreactivation()),Ae(()=>{let{currentSnapshot:c,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return d?ue(d).pipe(V(()=>o)):j(o)}),V(c=>{let l=H2(r.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=ae(x({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),Pe(()=>{this.events.next(new iu)}),Z2(this.rootContexts,r.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Wn(1),Pe({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ni(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),Up(this.transitionAbortSubject.pipe(Pe(c=>{throw c}))),ma(()=>{!a&&!u&&this.cancelNavigationTransition(o,"",qt.SupersededByNewNavigation),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),Ir(c=>{if(u=!0,k0(c))this.events.next(new Pr(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),W2(c)?this.events.next(new su(c.url)):o.resolve(!1);else{this.events.next(new ru(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(c))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return gt}))}))}cancelNavigationTransition(r,i,s){let o=new Pr(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function zj(t){return t!==Ja}var Wj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:()=>R(Kj),providedIn:"root"});let t=e;return t})(),gy=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},Kj=(()=>{let e=class e extends gy{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ja(e)))(s||e)}})(),e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),$0=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:()=>R(Qj),providedIn:"root"});let t=e;return t})(),Qj=(()=>{let e=class e extends $0{constructor(){super(...arguments),this.location=R(Ga),this.urlSerializer=R(my),this.options=R(Dy,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=R(by),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Nr,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=x0(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof nu)this.stateMemento=this.createStateMemento();else if(r instanceof Pi)this.rawUrlTree=i.initialUrl;else if(r instanceof Md){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof iu?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Pr&&(r.code===qt.GuardRejected||r.code===qt.NoDataFromResolver)?this.restoreHistory(i):r instanceof ru?this.restoreHistory(i,!0):r instanceof Ni&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=x(x({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=x(x({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ja(e)))(s||e)}})(),e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Za=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(Za||{});function Yj(t,e){t.events.pipe(Je(n=>n instanceof Ni||n instanceof Pr||n instanceof ru||n instanceof Pi),V(n=>n instanceof Ni||n instanceof Pi?Za.COMPLETE:(n instanceof Pr?n.code===qt.Redirect||n.code===qt.SupersededByNewNavigation:!1)?Za.REDIRECTING:Za.FAILED),Je(n=>n!==Za.REDIRECTING),Wn(1)).subscribe(()=>{e()})}function Zj(t){throw t}var Xj={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Jj={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},q0=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=R(pd),this.stateManager=R($0),this.options=R(Dy,{optional:!0})||{},this.pendingTasks=R(gd),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=R(Gj),this.urlSerializer=R(my),this.location=R(Ga),this.urlHandlingStrategy=R(by),this._events=new Ue,this.errorHandler=this.options.errorHandler||Zj,this.navigated=!1,this.routeReuseStrategy=R(Wj),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=R(Cy,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!R(wy,{optional:!0}),this.eventsSubscription=new Se,this.isNgZoneEnabled=R(he)instanceof he&&he.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Pr&&i.code!==qt.Redirect&&i.code!==qt.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Ni)this.navigated=!0;else if(i instanceof su){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),u={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||zj(s.source)};this.scheduleNavigation(a,Ja,null,u,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}tB(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Ja,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let c=x({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let u=this.parseUrl(r);this.scheduleNavigation(u,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(Ey),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:a,d=null;switch(u){case"merge":d=x(x({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=b0(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return T0(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=no(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Ja,null,i)}navigate(r,i={skipLocationChange:!1}){return eB(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=x({},Xj):i===!1?s=x({},Jj):s=i,no(r))return l0(this.currentUrlTree,r,s);let o=this.parseUrl(r);return l0(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let u,c,l;a?(u=a.resolve,c=a.reject,l=a.promise):l=new Promise((h,f)=>{u=h,c=f});let d=this.pendingTasks.add();return Yj(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:u,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function eB(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new U(4008,!1)}function tB(t){return!(t instanceof iu)&&!(t instanceof su)}var nB=new k("");function H0(t,...e){return id([{provide:Cy,multi:!0,useValue:t},[],{provide:Or,useFactory:rB,deps:[q0]},{provide:Cm,multi:!0,useFactory:iB},e.map(n=>n.\u0275providers)])}function rB(t){return t.routerState.root}function iB(){let t=R(Ci);return e=>{let n=t.get(Ha);if(e!==n.components[0])return;let r=t.get(q0),i=t.get(sB);t.get(oB)===1&&r.initialNavigation(),t.get(aB,null,Z.Optional)?.setUpPreloading(),t.get(nB,null,Z.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var sB=new k("",{factory:()=>new Ue}),oB=new k("",{providedIn:"root",factory:()=>1});var aB=new k("");var X0=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(ge(bi),ge(Mr))},e.\u0275dir=tn({type:e});let t=e;return t})(),cB=(()=>{let e=class e extends X0{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ja(e)))(s||e)}})(),e.\u0275dir=tn({type:e,features:[Qs]});let t=e;return t})(),J0=new k("NgValueAccessor");var lB={provide:J0,useExisting:ka(()=>Ud),multi:!0};function dB(){let t=tr()?tr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var hB=new k("CompositionEventMode"),Ud=(()=>{let e=class e extends X0{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!dB())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(ge(bi),ge(Mr),ge(hB,8))},e.\u0275dir=tn({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&Rr("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[Em([lB]),Qs]});let t=e;return t})();var fB=new k("NgValidators"),pB=new k("NgAsyncValidators");function eT(t){return t!=null}function tT(t){return Si(t)?ue(t):t}function nT(t){let e={};return t.forEach(n=>{e=n!=null?x(x({},e),n):e}),Object.keys(e).length===0?null:e}function rT(t,e){return e.map(n=>n(t))}function gB(t){return!t.validate}function iT(t){return t.map(e=>gB(e)?e:n=>e.validate(n))}function mB(t){if(!t)return null;let e=t.filter(eT);return e.length==0?null:function(n){return nT(rT(n,e))}}function sT(t){return t!=null?mB(iT(t)):null}function yB(t){if(!t)return null;let e=t.filter(eT);return e.length==0?null:function(n){let r=rT(n,e).map(tT);return kp(r).pipe(V(nT))}}function oT(t){return t!=null?yB(iT(t)):null}function G0(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function vB(t){return t._rawValidators}function _B(t){return t._rawAsyncValidators}function Ty(t){return t?Array.isArray(t)?t:[t]:[]}function jd(t,e){return Array.isArray(t)?t.includes(e):t===e}function z0(t,e){let n=Ty(e);return Ty(t).forEach(i=>{jd(n,i)||n.push(i)}),n}function W0(t,e){return Ty(e).filter(n=>!jd(t,n))}var Bd=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=sT(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=oT(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Sy=class extends Bd{get formDirective(){return null}get path(){return null}},pu=class extends Bd{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Ay=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},wB={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},bK=ae(x({},wB),{"[class.ng-submitted]":"isSubmitted"}),aT=(()=>{let e=class e extends Ay{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(ge(pu,2))},e.\u0275dir=tn({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&vm("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Qs]});let t=e;return t})();var hu="VALID",Ld="INVALID",so="PENDING",fu="DISABLED";function EB(t){return($d(t)?t.validators:t)||null}function IB(t){return Array.isArray(t)?sT(t):t||null}function DB(t,e){return($d(e)?e.asyncValidators:t)||null}function CB(t){return Array.isArray(t)?oT(t):t||null}function $d(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}var xy=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===hu}get invalid(){return this.status===Ld}get pending(){return this.status==so}get disabled(){return this.status===fu}get enabled(){return this.status!==fu}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(z0(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(z0(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(W0(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(W0(e,this._rawAsyncValidators))}hasValidator(e){return jd(this._rawValidators,e)}hasAsyncValidator(e){return jd(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=so,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=fu,this.errors=null,this._forEachChild(r=>{r.disable(ae(x({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ae(x({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=hu,this._forEachChild(r=>{r.enable(ae(x({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ae(x({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===hu||this.status===so)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?fu:hu}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=so,this._hasOwnPendingAsyncValidator=!0;let n=tT(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new ct,this.statusChanges=new ct}_calculateStatus(){return this._allControlsDisabled()?fu:this.errors?Ld:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(so)?so:this._anyControlsHaveStatus(Ld)?Ld:hu}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){$d(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=IB(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=CB(this._rawAsyncValidators)}};var uT=new k("CallSetDisabledState",{providedIn:"root",factory:()=>My}),My="always";function bB(t,e){return[...e.path,t]}function TB(t,e,n=My){AB(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),xB(t,e),RB(t,e),MB(t,e),SB(t,e)}function K0(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function SB(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function AB(t,e){let n=vB(t);e.validator!==null?t.setValidators(G0(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=_B(t);e.asyncValidator!==null?t.setAsyncValidators(G0(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();K0(e._rawValidators,i),K0(e._rawAsyncValidators,i)}function xB(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&cT(t,e)})}function MB(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&cT(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function cT(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function RB(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function NB(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function PB(t){return Object.getPrototypeOf(t.constructor)===cB}function OB(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===Ud?n=s:PB(s)?r=s:i=s}),i||r||n||null}function Q0(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Y0(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var kB=class extends xy{constructor(e=null,n,r){super(EB(n),DB(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),$d(n)&&(n.nonNullable||n.initialValueIsDefault)&&(Y0(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Q0(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Q0(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Y0(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var FB={provide:pu,useExisting:ka(()=>Ry)},Z0=Promise.resolve(),Ry=(()=>{let e=class e extends pu{constructor(r,i,s,o,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this.control=new kB,this._registered=!1,this.name="",this.update=new ct,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=OB(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),NB(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){TB(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){Z0.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&md(i);Z0.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?bB(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(ge(Sy,9),ge(fB,10),ge(pB,10),ge(J0,10),ge(Ks,8),ge(uT,8))},e.\u0275dir=tn({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[It.None,"disabled","isDisabled"],model:[It.None,"ngModel","model"],options:[It.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Em([FB]),Qs,zs]});let t=e;return t})();var VB=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ct({type:e}),e.\u0275inj=Dt({});let t=e;return t})();var LB=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ct({type:e}),e.\u0275inj=Dt({imports:[VB]});let t=e;return t})();var lT=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:uT,useValue:r.callSetDisabledState??My}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ct({type:e}),e.\u0275inj=Dt({imports:[LB]});let t=e;return t})();var Oi={LF:`
`,NULL:"\0"};var gu=class t{constructor(e){let{command:n,headers:r,body:i,binaryBody:s,escapeHeaderValues:o,skipContentLengthHeader:a}=e;this.command=n,this.headers=Object.assign({},r||{}),s?(this._binaryBody=s,this.isBinaryBody=!0):(this._body=i||"",this.isBinaryBody=!1),this.escapeHeaderValues=o||!1,this.skipContentLengthHeader=a||!1}get body(){return!this._body&&this.isBinaryBody&&(this._body=new TextDecoder().decode(this._binaryBody)),this._body||""}get binaryBody(){return!this._binaryBody&&!this.isBinaryBody&&(this._binaryBody=new TextEncoder().encode(this._body)),this._binaryBody}static fromRawFrame(e,n){let r={},i=s=>s.replace(/^\s+|\s+$/g,"");for(let s of e.headers.reverse()){let o=s.indexOf(":"),a=i(s[0]),u=i(s[1]);n&&e.command!=="CONNECT"&&e.command!=="CONNECTED"&&(u=t.hdrValueUnEscape(u)),r[a]=u}return new t({command:e.command,headers:r,binaryBody:e.binaryBody,escapeHeaderValues:n})}toString(){return this.serializeCmdAndHeaders()}serialize(){let e=this.serializeCmdAndHeaders();return this.isBinaryBody?t.toUnit8Array(e,this._binaryBody).buffer:e+this._body+Oi.NULL}serializeCmdAndHeaders(){let e=[this.command];this.skipContentLengthHeader&&delete this.headers["content-length"];for(let n of Object.keys(this.headers||{})){let r=this.headers[n];this.escapeHeaderValues&&this.command!=="CONNECT"&&this.command!=="CONNECTED"?e.push(`${n}:${t.hdrValueEscape(`${r}`)}`):e.push(`${n}:${r}`)}return(this.isBinaryBody||!this.isBodyEmpty()&&!this.skipContentLengthHeader)&&e.push(`content-length:${this.bodyLength()}`),e.join(Oi.LF)+Oi.LF+Oi.LF}isBodyEmpty(){return this.bodyLength()===0}bodyLength(){let e=this.binaryBody;return e?e.length:0}static sizeOfUTF8(e){return e?new TextEncoder().encode(e).length:0}static toUnit8Array(e,n){let r=new TextEncoder().encode(e),i=new Uint8Array([0]),s=new Uint8Array(r.length+n.length+i.length);return s.set(r),s.set(n,r.length),s.set(i,r.length+n.length),s}static marshall(e){return new t(e).serialize()}static hdrValueEscape(e){return e.replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/:/g,"\\c")}static hdrValueUnEscape(e){return e.replace(/\\r/g,"\r").replace(/\\n/g,`
`).replace(/\\c/g,":").replace(/\\\\/g,"\\")}};var qd=class{constructor(e,n){this.onFrame=e,this.onIncomingPing=n,this._encoder=new TextEncoder,this._decoder=new TextDecoder,this._token=[],this._initState()}parseChunk(e,n=!1){let r;if(typeof e=="string"?r=this._encoder.encode(e):r=new Uint8Array(e),n&&r[r.length-1]!==0){let i=new Uint8Array(r.length+1);i.set(r,0),i[r.length]=0,r=i}for(let i=0;i<r.length;i++){let s=r[i];this._onByte(s)}}_collectFrame(e){if(e!==0&&e!==13){if(e===10){this.onIncomingPing();return}this._onByte=this._collectCommand,this._reinjectByte(e)}}_collectCommand(e){if(e!==13){if(e===10){this._results.command=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaders;return}this._consumeByte(e)}}_collectHeaders(e){if(e!==13){if(e===10){this._setupCollectBody();return}this._onByte=this._collectHeaderKey,this._reinjectByte(e)}}_reinjectByte(e){this._onByte(e)}_collectHeaderKey(e){if(e===58){this._headerKey=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaderValue;return}this._consumeByte(e)}_collectHeaderValue(e){if(e!==13){if(e===10){this._results.headers.push([this._headerKey,this._consumeTokenAsUTF8()]),this._headerKey=void 0,this._onByte=this._collectHeaders;return}this._consumeByte(e)}}_setupCollectBody(){let e=this._results.headers.filter(n=>n[0]==="content-length")[0];e?(this._bodyBytesRemaining=parseInt(e[1],10),this._onByte=this._collectBodyFixedSize):this._onByte=this._collectBodyNullTerminated}_collectBodyNullTerminated(e){if(e===0){this._retrievedBody();return}this._consumeByte(e)}_collectBodyFixedSize(e){if(this._bodyBytesRemaining--===0){this._retrievedBody();return}this._consumeByte(e)}_retrievedBody(){this._results.binaryBody=this._consumeTokenAsRaw();try{this.onFrame(this._results)}catch(e){console.log("Ignoring an exception thrown by a frame handler. Original exception: ",e)}this._initState()}_consumeByte(e){this._token.push(e)}_consumeTokenAsUTF8(){return this._decoder.decode(this._consumeTokenAsRaw())}_consumeTokenAsRaw(){let e=new Uint8Array(this._token);return this._token=[],e}_initState(){this._results={command:void 0,headers:[],binaryBody:void 0},this._token=[],this._headerKey=void 0,this._onByte=this._collectFrame}};var on;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.OPEN=1]="OPEN",t[t.CLOSING=2]="CLOSING",t[t.CLOSED=3]="CLOSED"})(on=on||(on={}));var St;(function(t){t[t.ACTIVE=0]="ACTIVE",t[t.DEACTIVATING=1]="DEACTIVATING",t[t.INACTIVE=2]="INACTIVE"})(St=St||(St={}));var xe=class{constructor(e){this.versions=e}supportedVersions(){return this.versions.join(",")}protocolVersions(){return this.versions.map(e=>`v${e.replace(".","")}.stomp`)}};xe.V1_0="1.0";xe.V1_1="1.1";xe.V1_2="1.2";xe.default=new xe([xe.V1_2,xe.V1_1,xe.V1_0]);function dT(t,e){t.terminate=function(){let n=()=>{};this.onerror=n,this.onmessage=n,this.onopen=n;let r=new Date,i=Math.random().toString().substring(2,8),s=this.onclose;this.onclose=o=>{let a=new Date().getTime()-r.getTime();e(`Discarded socket (#${i})  closed after ${a}ms, with code/reason: ${o.code}/${o.reason}`)},this.close(),s?.call(t,{code:4001,reason:`Quick discarding socket (#${i}) without waiting for the shutdown sequence.`,wasClean:!1})}}var Hd=class{constructor(e,n,r){this._client=e,this._webSocket=n,this._connected=!1,this._serverFrameHandlers={CONNECTED:i=>{this.debug(`connected to server ${i.headers.server}`),this._connected=!0,this._connectedVersion=i.headers.version,this._connectedVersion===xe.V1_2&&(this._escapeHeaderValues=!0),this._setupHeartbeat(i.headers),this.onConnect(i)},MESSAGE:i=>{let s=i.headers.subscription,o=this._subscriptions[s]||this.onUnhandledMessage,a=i,u=this,c=this._connectedVersion===xe.V1_2?a.headers.ack:a.headers["message-id"];a.ack=(l={})=>u.ack(c,s,l),a.nack=(l={})=>u.nack(c,s,l),o(a)},RECEIPT:i=>{let s=this._receiptWatchers[i.headers["receipt-id"]];s?(s(i),delete this._receiptWatchers[i.headers["receipt-id"]]):this.onUnhandledReceipt(i)},ERROR:i=>{this.onStompError(i)}},this._counter=0,this._subscriptions={},this._receiptWatchers={},this._partialData="",this._escapeHeaderValues=!1,this._lastServerActivityTS=Date.now(),this.debug=r.debug,this.stompVersions=r.stompVersions,this.connectHeaders=r.connectHeaders,this.disconnectHeaders=r.disconnectHeaders,this.heartbeatIncoming=r.heartbeatIncoming,this.heartbeatOutgoing=r.heartbeatOutgoing,this.splitLargeFrames=r.splitLargeFrames,this.maxWebSocketChunkSize=r.maxWebSocketChunkSize,this.forceBinaryWSFrames=r.forceBinaryWSFrames,this.logRawCommunication=r.logRawCommunication,this.appendMissingNULLonIncoming=r.appendMissingNULLonIncoming,this.discardWebsocketOnCommFailure=r.discardWebsocketOnCommFailure,this.onConnect=r.onConnect,this.onDisconnect=r.onDisconnect,this.onStompError=r.onStompError,this.onWebSocketClose=r.onWebSocketClose,this.onWebSocketError=r.onWebSocketError,this.onUnhandledMessage=r.onUnhandledMessage,this.onUnhandledReceipt=r.onUnhandledReceipt,this.onUnhandledFrame=r.onUnhandledFrame}get connectedVersion(){return this._connectedVersion}get connected(){return this._connected}start(){let e=new qd(n=>{let r=gu.fromRawFrame(n,this._escapeHeaderValues);this.logRawCommunication||this.debug(`<<< ${r}`),(this._serverFrameHandlers[r.command]||this.onUnhandledFrame)(r)},()=>{this.debug("<<< PONG")});this._webSocket.onmessage=n=>{if(this.debug("Received data"),this._lastServerActivityTS=Date.now(),this.logRawCommunication){let r=n.data instanceof ArrayBuffer?new TextDecoder().decode(n.data):n.data;this.debug(`<<< ${r}`)}e.parseChunk(n.data,this.appendMissingNULLonIncoming)},this._webSocket.onclose=n=>{this.debug(`Connection closed to ${this._webSocket.url}`),this._cleanUp(),this.onWebSocketClose(n)},this._webSocket.onerror=n=>{this.onWebSocketError(n)},this._webSocket.onopen=()=>{let n=Object.assign({},this.connectHeaders);this.debug("Web Socket Opened..."),n["accept-version"]=this.stompVersions.supportedVersions(),n["heart-beat"]=[this.heartbeatOutgoing,this.heartbeatIncoming].join(","),this._transmit({command:"CONNECT",headers:n})}}_setupHeartbeat(e){if(e.version!==xe.V1_1&&e.version!==xe.V1_2||!e["heart-beat"])return;let[n,r]=e["heart-beat"].split(",").map(i=>parseInt(i,10));if(this.heartbeatOutgoing!==0&&r!==0){let i=Math.max(this.heartbeatOutgoing,r);this.debug(`send PING every ${i}ms`),this._pinger=setInterval(()=>{this._webSocket.readyState===on.OPEN&&(this._webSocket.send(Oi.LF),this.debug(">>> PING"))},i)}if(this.heartbeatIncoming!==0&&n!==0){let i=Math.max(this.heartbeatIncoming,n);this.debug(`check PONG every ${i}ms`),this._ponger=setInterval(()=>{let s=Date.now()-this._lastServerActivityTS;s>i*2&&(this.debug(`did not receive server activity for the last ${s}ms`),this._closeOrDiscardWebsocket())},i)}}_closeOrDiscardWebsocket(){this.discardWebsocketOnCommFailure?(this.debug("Discarding websocket, the underlying socket may linger for a while"),this.discardWebsocket()):(this.debug("Issuing close on the websocket"),this._closeWebsocket())}forceDisconnect(){this._webSocket&&(this._webSocket.readyState===on.CONNECTING||this._webSocket.readyState===on.OPEN)&&this._closeOrDiscardWebsocket()}_closeWebsocket(){this._webSocket.onmessage=()=>{},this._webSocket.close()}discardWebsocket(){typeof this._webSocket.terminate!="function"&&dT(this._webSocket,e=>this.debug(e)),this._webSocket.terminate()}_transmit(e){let{command:n,headers:r,body:i,binaryBody:s,skipContentLengthHeader:o}=e,a=new gu({command:n,headers:r,body:i,binaryBody:s,escapeHeaderValues:this._escapeHeaderValues,skipContentLengthHeader:o}),u=a.serialize();if(this.logRawCommunication?this.debug(`>>> ${u}`):this.debug(`>>> ${a}`),this.forceBinaryWSFrames&&typeof u=="string"&&(u=new TextEncoder().encode(u)),typeof u!="string"||!this.splitLargeFrames)this._webSocket.send(u);else{let c=u;for(;c.length>0;){let l=c.substring(0,this.maxWebSocketChunkSize);c=c.substring(this.maxWebSocketChunkSize),this._webSocket.send(l),this.debug(`chunk sent = ${l.length}, remaining = ${c.length}`)}}}dispose(){if(this.connected)try{let e=Object.assign({},this.disconnectHeaders);e.receipt||(e.receipt=`close-${this._counter++}`),this.watchForReceipt(e.receipt,n=>{this._closeWebsocket(),this._cleanUp(),this.onDisconnect(n)}),this._transmit({command:"DISCONNECT",headers:e})}catch(e){this.debug(`Ignoring error during disconnect ${e}`)}else(this._webSocket.readyState===on.CONNECTING||this._webSocket.readyState===on.OPEN)&&this._closeWebsocket()}_cleanUp(){this._connected=!1,this._pinger&&(clearInterval(this._pinger),this._pinger=void 0),this._ponger&&(clearInterval(this._ponger),this._ponger=void 0)}publish(e){let{destination:n,headers:r,body:i,binaryBody:s,skipContentLengthHeader:o}=e,a=Object.assign({destination:n},r);this._transmit({command:"SEND",headers:a,body:i,binaryBody:s,skipContentLengthHeader:o})}watchForReceipt(e,n){this._receiptWatchers[e]=n}subscribe(e,n,r={}){r=Object.assign({},r),r.id||(r.id=`sub-${this._counter++}`),r.destination=e,this._subscriptions[r.id]=n,this._transmit({command:"SUBSCRIBE",headers:r});let i=this;return{id:r.id,unsubscribe(s){return i.unsubscribe(r.id,s)}}}unsubscribe(e,n={}){n=Object.assign({},n),delete this._subscriptions[e],n.id=e,this._transmit({command:"UNSUBSCRIBE",headers:n})}begin(e){let n=e||`tx-${this._counter++}`;this._transmit({command:"BEGIN",headers:{transaction:n}});let r=this;return{id:n,commit(){r.commit(n)},abort(){r.abort(n)}}}commit(e){this._transmit({command:"COMMIT",headers:{transaction:e}})}abort(e){this._transmit({command:"ABORT",headers:{transaction:e}})}ack(e,n,r={}){r=Object.assign({},r),this._connectedVersion===xe.V1_2?r.id=e:r["message-id"]=e,r.subscription=n,this._transmit({command:"ACK",headers:r})}nack(e,n,r={}){return r=Object.assign({},r),this._connectedVersion===xe.V1_2?r.id=e:r["message-id"]=e,r.subscription=n,this._transmit({command:"NACK",headers:r})}};var Gd=class{constructor(e={}){this.stompVersions=xe.default,this.connectionTimeout=0,this.reconnectDelay=5e3,this.heartbeatIncoming=1e4,this.heartbeatOutgoing=1e4,this.splitLargeFrames=!1,this.maxWebSocketChunkSize=8*1024,this.forceBinaryWSFrames=!1,this.appendMissingNULLonIncoming=!1,this.discardWebsocketOnCommFailure=!1,this.state=St.INACTIVE;let n=()=>{};this.debug=n,this.beforeConnect=n,this.onConnect=n,this.onDisconnect=n,this.onUnhandledMessage=n,this.onUnhandledReceipt=n,this.onUnhandledFrame=n,this.onStompError=n,this.onWebSocketClose=n,this.onWebSocketError=n,this.logRawCommunication=!1,this.onChangeState=n,this.connectHeaders={},this._disconnectHeaders={},this.configure(e)}get webSocket(){return this._stompHandler?._webSocket}get disconnectHeaders(){return this._disconnectHeaders}set disconnectHeaders(e){this._disconnectHeaders=e,this._stompHandler&&(this._stompHandler.disconnectHeaders=this._disconnectHeaders)}get connected(){return!!this._stompHandler&&this._stompHandler.connected}get connectedVersion(){return this._stompHandler?this._stompHandler.connectedVersion:void 0}get active(){return this.state===St.ACTIVE}_changeState(e){this.state=e,this.onChangeState(e)}configure(e){Object.assign(this,e)}activate(){let e=()=>{if(this.active){this.debug("Already ACTIVE, ignoring request to activate");return}this._changeState(St.ACTIVE),this._connect()};this.state===St.DEACTIVATING?(this.debug("Waiting for deactivation to finish before activating"),this.deactivate().then(()=>{e()})):e()}_connect(){return y(this,null,function*(){if(yield this.beforeConnect(),this._stompHandler){this.debug("There is already a stompHandler, skipping the call to connect");return}if(!this.active){this.debug("Client has been marked inactive, will not attempt to connect");return}this.connectionTimeout>0&&(this._connectionWatcher&&clearTimeout(this._connectionWatcher),this._connectionWatcher=setTimeout(()=>{this.connected||(this.debug(`Connection not established in ${this.connectionTimeout}ms, closing socket`),this.forceDisconnect())},this.connectionTimeout)),this.debug("Opening Web Socket...");let e=this._createWebSocket();this._stompHandler=new Hd(this,e,{debug:this.debug,stompVersions:this.stompVersions,connectHeaders:this.connectHeaders,disconnectHeaders:this._disconnectHeaders,heartbeatIncoming:this.heartbeatIncoming,heartbeatOutgoing:this.heartbeatOutgoing,splitLargeFrames:this.splitLargeFrames,maxWebSocketChunkSize:this.maxWebSocketChunkSize,forceBinaryWSFrames:this.forceBinaryWSFrames,logRawCommunication:this.logRawCommunication,appendMissingNULLonIncoming:this.appendMissingNULLonIncoming,discardWebsocketOnCommFailure:this.discardWebsocketOnCommFailure,onConnect:n=>{if(this._connectionWatcher&&(clearTimeout(this._connectionWatcher),this._connectionWatcher=void 0),!this.active){this.debug("STOMP got connected while deactivate was issued, will disconnect now"),this._disposeStompHandler();return}this.onConnect(n)},onDisconnect:n=>{this.onDisconnect(n)},onStompError:n=>{this.onStompError(n)},onWebSocketClose:n=>{this._stompHandler=void 0,this.state===St.DEACTIVATING&&this._changeState(St.INACTIVE),this.onWebSocketClose(n),this.active&&this._schedule_reconnect()},onWebSocketError:n=>{this.onWebSocketError(n)},onUnhandledMessage:n=>{this.onUnhandledMessage(n)},onUnhandledReceipt:n=>{this.onUnhandledReceipt(n)},onUnhandledFrame:n=>{this.onUnhandledFrame(n)}}),this._stompHandler.start()})}_createWebSocket(){let e;if(this.webSocketFactory)e=this.webSocketFactory();else if(this.brokerURL)e=new WebSocket(this.brokerURL,this.stompVersions.protocolVersions());else throw new Error("Either brokerURL or webSocketFactory must be provided");return e.binaryType="arraybuffer",e}_schedule_reconnect(){this.reconnectDelay>0&&(this.debug(`STOMP: scheduling reconnection in ${this.reconnectDelay}ms`),this._reconnector=setTimeout(()=>{this._connect()},this.reconnectDelay))}deactivate(){return y(this,arguments,function*(e={}){let n=e.force||!1,r=this.active,i;if(this.state===St.INACTIVE)return this.debug("Already INACTIVE, nothing more to do"),Promise.resolve();if(this._changeState(St.DEACTIVATING),this._reconnector&&(clearTimeout(this._reconnector),this._reconnector=void 0),this._stompHandler&&this.webSocket.readyState!==on.CLOSED){let s=this._stompHandler.onWebSocketClose;i=new Promise((o,a)=>{this._stompHandler.onWebSocketClose=u=>{s(u),o()}})}else return this._changeState(St.INACTIVE),Promise.resolve();return n?this._stompHandler?.discardWebsocket():r&&this._disposeStompHandler(),i})}forceDisconnect(){this._stompHandler&&this._stompHandler.forceDisconnect()}_disposeStompHandler(){this._stompHandler&&this._stompHandler.dispose()}publish(e){this._checkConnection(),this._stompHandler.publish(e)}_checkConnection(){if(!this.connected)throw new TypeError("There is no underlying STOMP connection")}watchForReceipt(e,n){this._checkConnection(),this._stompHandler.watchForReceipt(e,n)}subscribe(e,n,r={}){return this._checkConnection(),this._stompHandler.subscribe(e,n,r)}unsubscribe(e,n={}){this._checkConnection(),this._stompHandler.unsubscribe(e,n)}begin(e){return this._checkConnection(),this._stompHandler.begin(e)}commit(e){this._checkConnection(),this._stompHandler.commit(e)}abort(e){this._checkConnection(),this._stompHandler.abort(e)}ack(e,n,r={}){this._checkConnection(),this._stompHandler.ack(e,n,r)}nack(e,n,r={}){this._checkConnection(),this._stompHandler.nack(e,n,r)}};var zd=class{constructor(e){this.client=e}get outgoing(){return this.client.heartbeatOutgoing}set outgoing(e){this.client.heartbeatOutgoing=e}get incoming(){return this.client.heartbeatIncoming}set incoming(e){this.client.heartbeatIncoming=e}};var mu=class extends Gd{constructor(e){super(),this.maxWebSocketFrameSize=16*1024,this._heartbeatInfo=new zd(this),this.reconnect_delay=0,this.webSocketFactory=e,this.debug=(...n)=>{console.log(...n)}}_parseConnect(...e){let n,r,i,s={};if(e.length<2)throw new Error("Connect requires at least 2 arguments");if(typeof e[1]=="function")[s,r,i,n]=e;else switch(e.length){case 6:[s.login,s.passcode,r,i,n,s.host]=e;break;default:[s.login,s.passcode,r,i,n]=e}return[s,r,i,n]}connect(...e){let n=this._parseConnect(...e);n[0]&&(this.connectHeaders=n[0]),n[1]&&(this.onConnect=n[1]),n[2]&&(this.onStompError=n[2]),n[3]&&(this.onWebSocketClose=n[3]),super.activate()}disconnect(e,n={}){e&&(this.onDisconnect=e),this.disconnectHeaders=n,super.deactivate()}send(e,n={},r=""){n=Object.assign({},n);let i=n["content-length"]===!1;i&&delete n["content-length"],this.publish({destination:e,headers:n,body:r,skipContentLengthHeader:i})}set reconnect_delay(e){this.reconnectDelay=e}get ws(){return this.webSocket}get version(){return this.connectedVersion}get onreceive(){return this.onUnhandledMessage}set onreceive(e){this.onUnhandledMessage=e}get onreceipt(){return this.onUnhandledReceipt}set onreceipt(e){this.onUnhandledReceipt=e}get heartbeat(){return this._heartbeatInfo}set heartbeat(e){this.heartbeatIncoming=e.incoming,this.heartbeatOutgoing=e.outgoing}};var hT=(()=>{class t{static client(n,r){r==null&&(r=xe.default.protocolVersions());let i=()=>{let s=t.WebSocketClass||WebSocket;return new s(n,r)};return new mu(i)}static over(n){let r;return typeof n=="function"?r=n:(console.warn("Stomp.over did not receive a factory, auto reconnect will not work. Please see https://stomp-js.github.io/api-docs/latest/classes/Stomp.html#over"),r=()=>n),new mu(r)}}return t.WebSocketClass=null,t})();var JA=wO(XA());var ex=(()=>{let e=class e{constructor(){this.messageSubject=new $e([]),this.initConnectionSocket()}initConnectionSocket(){let r="//localhost:3000/chat-socket",i=new JA.default(r);this.stompCliente=hT.over(i)}joinRoom(r){this.stompCliente.connect({},()=>{this.stompCliente.subscribe(`/topic/${r}`,i=>{let s=JSON.parse(i.body),o=this.messageSubject.getValue();o.push(s),this.messageSubject.next([...o])})})}showMessageOutput(r){var i=document.getElementById("response");let s=document.createElement("p");s.style.wordWrap="break-word",s.appendChild(document.createTextNode(r.from+": "+i?.appendChild(s)))}sendMessage(r,i){this.stompCliente.send(`/app/chat/${r}`,{},JSON.stringify(i))}getMessageSubject(){return this.messageSubject.asObservable()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var G$=(t,e)=>({left:t,right:e});function z$(t,e){if(t&1&&($t(0,"li",17),Cn(1,"div",18),$t(2,"div",19)(3,"div",16),fd(4),er()()()),t&2){let n=e.$implicit;qa("ngClass",Vb(2,G$,n.message_side==="receiver",n.message_side==="sender")),cd(4),wm(n.message)}}var tx=(()=>{let e=class e{constructor(r,i){this.chatServices=r,this.route=i,this.messageInput="",this.userId="",this.messageList=[{message:"hola",user:"",state:""}]}ngOnInit(){this.userId=this.route.snapshot.params.userId,this.chatServices.joinRoom(this.userId),this.listenerMessage()}sendMessage(){console.log("22222222::::::::::_"+this.userId);let r={message:this.messageInput,user:this.userId,state:this.userId+" send"};this.chatServices.sendMessage(this.userId,r),this.messageInput=""}listenerMessage(){this.chatServices.getMessageSubject().subscribe(r=>{this.messageList=r.map(i=>ae(x({},i),{message_side:i.user===this.userId?"sender":"receiver"}))})}};e.\u0275fac=function(i){return new(i||e)(ge(ex),ge(Or))},e.\u0275cmp=Gs({type:e,selectors:[["app-chat"]],standalone:!0,features:[Ys],decls:19,vars:2,consts:[[1,"chat_window"],[1,"title","d-flex","align-items-center"],["src","https://png.pngtree.com/png-vector/20221018/ourmid/pngtree-whatsapp-phone-icon-png-image_6315989.png","width","45px","height","45px"],[1,"wsp",3,"click"],[1,"top_menu"],[1,"buttons"],[1,"button","close"],[1,"button","minimize"],[1,"button","maximize"],[1,"messages"],["class","message right",3,"ngClass",4,"ngFor","ngForOf"],[1,"bottom_wrapper","clearfix"],[1,"message_input_wrapper"],["placeholder","Message...","name","messageInput",1,"message_input",3,"ngModel","ngModelChange"],[1,"send_message",3,"click"],[1,"icon"],[1,"text"],[1,"message","right",3,"ngClass"],[1,"avatar"],[1,"text_wrapper"]],template:function(i,s){i&1&&($t(0,"div",0)(1,"div",1),Cn(2,"img",2),$t(3,"h3",3),Rr("click",function(){return s.listenerMessage()}),fd(4,"WhatsApp"),er()(),$t(5,"div",4)(6,"div",5),Cn(7,"div",6)(8,"div",7)(9,"div",8),er()(),$t(10,"ul",9),ym(11,z$,5,5,"li",10),er(),$t(12,"div",11)(13,"div",12)(14,"input",13),Rr("ngModelChange",function(a){return s.messageInput=a}),er()(),$t(15,"div",14),Rr("click",function(){return s.sendMessage()}),Cn(16,"div",15),$t(17,"div",16),fd(18,"Send"),er()()()()),i&2&&(cd(11),qa("ngForOf",s.messageList),cd(3),qa("ngModel",s.messageInput))},dependencies:[Mm,Jb,e0,lT,Ud,aT,Ry],styles:['.chat_window[_ngcontent-%COMP%]{position:absolute;width:calc(100% - 20px);max-width:600px;height:510px;border-radius:20px;left:50%;top:50%;transform:translate(-50%) translateY(-50%);box-shadow:0 15px 30px #00000026;background-color:#080808;overflow:hidden;-webkit-transform:translateX(-50%) translateY(-50%);-moz-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);-o-transform:translateX(-50%) translateY(-50%)}.top_menu[_ngcontent-%COMP%]{background-color:#04463a;height:45px;width:100%;padding:5px}.top_menu[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{margin:3px 0 0 10px;position:absolute}.top_menu[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:50%;display:inline-block;margin-right:10px;position:relative}.top_menu[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button.close[_ngcontent-%COMP%]{background-color:#f5886e}.top_menu[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button.minimize[_ngcontent-%COMP%]{background-color:#fdbf68;cursor:pointer}.top_menu[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button.maximize[_ngcontent-%COMP%]{background-color:#a3d063;cursor:pointer}.title[_ngcontent-%COMP%]{color:#e2e2e2;font-size:20px;padding:8px;background-color:#008069}.wsp[_ngcontent-%COMP%]{margin-left:35px}.messages[_ngcontent-%COMP%]{position:relative;list-style:none;padding:20px 10px 0;margin:0;height:330px;overflow:scroll}.messages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{clear:both;overflow:hidden;margin-bottom:20px;transition:all .5s linear;opacity:1}.messages[_ngcontent-%COMP%]   .message.left[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{background-color:#37b4ee5d;float:left}.messages[_ngcontent-%COMP%]   .message.left[_ngcontent-%COMP%]   .text_wrapper[_ngcontent-%COMP%]{background-color:#37b4ee5d;margin-left:20px}.messages[_ngcontent-%COMP%]   .message.left[_ngcontent-%COMP%]   .text_wrapper[_ngcontent-%COMP%]:after, .messages[_ngcontent-%COMP%]   .message.left[_ngcontent-%COMP%]   .text_wrapper[_ngcontent-%COMP%]:before{right:100%;border-right-color:#073f585d}.messages[_ngcontent-%COMP%]   .message.left[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:#e0e0e0}.messages[_ngcontent-%COMP%]   .message.right[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{background-color:#008069;float:right}.messages[_ngcontent-%COMP%]   .message.right[_ngcontent-%COMP%]   .text_wrapper[_ngcontent-%COMP%]{background-color:#00a884;margin-right:20px;float:right}.messages[_ngcontent-%COMP%]   .message.right[_ngcontent-%COMP%]   .text_wrapper[_ngcontent-%COMP%]:after, .messages[_ngcontent-%COMP%]   .message.right[_ngcontent-%COMP%]   .text_wrapper[_ngcontent-%COMP%]:before{left:100%;border-left-color:#003d30}.messages[_ngcontent-%COMP%]   .message.right[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:#fff}.messages[_ngcontent-%COMP%]   .message.appeared[_ngcontent-%COMP%]{opacity:1}.messages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;display:inline-block}.messages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .text_wrapper[_ngcontent-%COMP%]{display:inline-block;padding:15px;border-radius:8px;width:calc(100% - 220px);min-width:100px;position:relative}.messages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .text_wrapper[_ngcontent-%COMP%]:after, .messages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .text_wrapper[_ngcontent-%COMP%]:before{top:18px;border:solid transparent;content:" ";height:0;width:0;position:absolute;pointer-events:none}.messages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .text_wrapper[_ngcontent-%COMP%]:after{border-width:13px;margin-top:0}.messages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .text_wrapper[_ngcontent-%COMP%]:before{border-width:15px;margin-top:-2px}.messages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .text_wrapper[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:18px;font-weight:300}.bottom_wrapper[_ngcontent-%COMP%]{position:relative;width:100%;background-color:#008069;padding:20px;position:absolute;bottom:0}.bottom_wrapper[_ngcontent-%COMP%]   .message_input_wrapper[_ngcontent-%COMP%]{display:inline-block;height:50px;border-radius:25px;border:1px solid #d8d8d8;width:calc(100% - 160px);position:relative;padding:0 20px}.bottom_wrapper[_ngcontent-%COMP%]   .message_input_wrapper[_ngcontent-%COMP%]   .message_input[_ngcontent-%COMP%]{border:none;height:100%;box-sizing:border-box;width:calc(100% - 40px);position:absolute;outline-width:0;color:#e7e7e7}.message_input[_ngcontent-%COMP%]{background-color:#008069;color:#fff}.message_input[_ngcontent-%COMP%]::placeholder{color:#ccc}.bottom_wrapper[_ngcontent-%COMP%]   .send_message[_ngcontent-%COMP%]{width:140px;height:50px;display:inline-block;border-radius:50px;background-color:#a3d063;border:2px solid #a3d063;color:#fff;cursor:pointer;transition:all .2s linear;text-align:center;float:right}.bottom_wrapper[_ngcontent-%COMP%]   .send_message[_ngcontent-%COMP%]:hover{color:#a3d063;background-color:#fff}.bottom_wrapper[_ngcontent-%COMP%]   .send_message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:18px;font-weight:300;display:inline-block;line-height:48px}.message_template[_ngcontent-%COMP%]{display:none}'],changeDetection:0});let t=e;return t})();var nx=[{path:"",redirectTo:"chat/",pathMatch:"full"},{path:"chat/:userId",component:tx},{path:"**",redirectTo:"chat/"}];var rx={providers:[H0(nx)]};var W$="firebase",K$="10.7.2";Er(W$,K$,"app");var go=new Zn("ANGULARFIRE2_VERSION");var Q$=(t,e)=>{let n=e?[e]:RI(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},qi=class{constructor(){return Q$(Y$)}},Y$="app-check";function Ev(){}var fh=class{zone;delegate;constructor(e,n=Np){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},Iv=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ev,{},Ev,Ev)),n.pipe(Pe({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},ph=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new fh(Zone.current)),this.insideAngular=n.run(()=>new fh(Zone.current,pa)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(S(he))};static \u0275prov=L({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Z$(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function _t(t){return X$(Z$())(t)}function X$(t){return function(n){return n=n.lift(new Iv(t.ngZone)),n.pipe(Xt(t.outsideAngular),Ot(t.insideAngular))}}var J$="firebase",eq="10.7.2";pt.registerVersion(J$,eq,"app-compat");var tq=["ngOnDestroy"],ox=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(tq.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let u=a?.[s];return typeof u=="function"?u.bind(a):u?.then?u.then(c=>n.run(()=>c)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,c)=>o.then(l=>{let d=l?.(...c);return r?.spy?.apply&&r.spy.apply(s,c,d),d})})})});var gh=class{constructor(e){return e}},mo=new k("angularfire2.app.options"),yo=new k("angularfire2.app.name");function ku(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=pt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>pt.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;nq("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new gh(o)}var nq=(t,...e)=>{Tm()&&typeof console<"u"&&console[t](...e)},rq={provide:gh,useFactory:ku,deps:[mo,he,[new Ua,yo]]},ax=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:mo,useValue:n},{provide:yo,useValue:r}]}}constructor(n){pt.registerVersion("angularfire",go.full,"core"),pt.registerVersion("angularfire",go.full,"app-compat"),pt.registerVersion("angular",Lb.full,n.toString())}static \u0275fac=function(r){return new(r||t)(S(Ut))};static \u0275mod=Ct({type:t});static \u0275inj=Dt({providers:[rq]})}return t})();function mh(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return iq(i,o)||(sx("error",`${e} was already initialized on the ${n} Firebase App with different settings.${sq?" You may need to reload as Firebase is not HMR aware.":""}`),sx("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function iq(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var sq=typeof module<"u"&&!!module.hot,sx=(t,...e)=>{Tm()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var uq=new Map,cq={activated:!1,tokenObservers:[]},lq={initialized:!1,enabled:!1};function cn(t){return uq.get(t)||Object.assign({},cq)}function hx(){return lq}var dq="https://content-firebaseappcheck.googleapis.com/v1";var hq="exchangeDebugToken",ux={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},BY=24*60*60*1e3;var Cv=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return y(this,null,function*(){this.stop();try{this.pending=new mp,this.pending.promise.catch(n=>{}),yield fq(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new mp,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function fq(t){return new Promise(e=>{setTimeout(e,t)})}var pq={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},jr=new xI("appCheck","AppCheck",pq);function fx(t){if(!cn(t).activated)throw jr.create("use-before-activation",{appName:t.name})}function px(r,i){return y(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(t,a)}catch(f){throw jr.create("fetch-network-error",{originalErrorMessage:f?.message})}if(u.status!==200)throw jr.create("fetch-status-error",{httpStatus:u.status});let c;try{c=yield u.json()}catch(f){throw jr.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=c.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw jr.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function gx(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${dq}/projects/${n}/apps/${r}:${hq}?key=${i}`,body:{debug_token:e}}}var gq="firebase-app-check-database",mq=1,bv="firebase-app-check-store";var yh=null;function yq(){return yh||(yh=new Promise((t,e)=>{try{let n=indexedDB.open(gq,mq);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(jr.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(bv,{keyPath:"compositeKey"})}}}catch(n){e(jr.create("storage-open",{originalErrorMessage:n?.message}))}}),yh)}function vq(t,e){return _q(wq(t),e)}function _q(t,e){return y(this,null,function*(){let r=(yield yq()).transaction(bv,"readwrite"),s=r.objectStore(bv).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var c;a(jr.create("storage-set",{originalErrorMessage:(c=u.target.error)===null||c===void 0?void 0:c.message}))}})})}function wq(t){return`${t.options.appId}-${t.name}`}var Tv=new Yc("@firebase/app-check");function Dv(t,e){return Qc()?vq(t,e).catch(n=>{Tv.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function mx(){return hx().enabled}function yx(){return y(this,null,function*(){let t=hx();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Eq={error:"UNKNOWN_ERROR"};function Iq(t){return TI.encodeString(JSON.stringify(t),!1)}function Sv(t,e=!1){return y(this,null,function*(){let n=t.app;fx(n);let r=cn(n),i=r.token,s;if(i&&!Fu(i)&&(r.token=void 0,i=void 0),!i){let u=yield r.cachedTokenPromise;u&&(Fu(u)?i=u:yield Dv(n,void 0))}if(!e&&i&&Fu(i))return{token:i.token};let o=!1;if(mx()){r.exchangeTokenPromise||(r.exchangeTokenPromise=px(gx(n,yield yx()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let u=yield r.exchangeTokenPromise;return yield Dv(n,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield cn(n).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?Tv.warn(u.message):Tv.error(u),s=u}let a;return i?s?Fu(i)?a={token:i.token,internalError:s}:a=lx(s):(a={token:i.token},r.token=i,yield Dv(n,i)):a=lx(s),o&&Tq(n,a),a})}function Dq(t){return y(this,null,function*(){let e=t.app;fx(e);let{provider:n}=cn(e);if(mx()){let r=yield yx(),{token:i}=yield px(gx(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function Cq(t,e,n,r){let{app:i}=t,s=cn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Fu(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),cx(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>cx(t))}function vx(t,e){let n=cn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function cx(t){let{app:e}=t,n=cn(e),r=n.tokenRefresher;r||(r=bq(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function bq(t){let{app:e}=t;return new Cv(()=>y(this,null,function*(){let n=cn(e),r;if(n.token?r=yield Sv(t,!0):r=yield Sv(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=cn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},ux.RETRIAL_MIN_WAIT,ux.RETRIAL_MAX_WAIT)}function Tq(t,e){let n=cn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Fu(t){return t.expireTimeMillis-Date.now()>0}function lx(t){return{token:Iq(Eq),error:t}}var Av=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=cn(this.app);for(let n of e)vx(this.app,n.next);return Promise.resolve()}};function Sq(t,e){return new Av(t,e)}function Aq(t){return{getToken:e=>Sv(t,e),getLimitedUseToken:()=>Dq(t),addTokenListener:e=>Cq(t,"INTERNAL",e),removeTokenListener:e=>vx(t.app,e)}}var xq="@firebase/app-check",Mq="0.8.1";var Rq="app-check",dx="app-check-internal";function Nq(){la(new ai(Rq,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return Sq(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(dx).initialize()})),la(new ai(dx,t=>{let e=t.getProvider("app-check").getImmediate();return Aq(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Er(xq,Mq)}Nq();var Pq=["localhost","0.0.0.0","127.0.0.1"],XY=typeof window<"u"&&Pq.includes(window.location.hostname);var xv=new k("angularfire2.auth.use-emulator"),Mv=new k("angularfire2.auth.settings"),Rv=new k("angularfire2.auth.tenant-id"),Nv=new k("angularfire2.auth.langugage-code"),Pv=new k("angularfire2.auth.use-device-language"),Ov=new k("angularfire.auth.persistence"),kv=(t,e,n,r,i,s,o,a)=>mh(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(let[c,l]of Object.entries(o))u.settings[c]=l;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]),wx=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,c,l,d,h,f){let m=new Ue,v=j(void 0).pipe(Ot(o.outsideAngular),Ae(()=>s.runOutsideAngular(()=>import("./chunk-XR5TVM7T.js"))),V(()=>ku(n,s,r)),V(_=>kv(_,s,a,c,l,d,u,h)),Cl({bufferSize:1,refCount:!1}));if(xi(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=j(null);else{v.pipe(kt()).subscribe();let _=v.pipe(Ae(T=>T.getRedirectResult().then(F=>F,()=>null)),_t,Cl({bufferSize:1,refCount:!1})),I=v.pipe(Ae(T=>new X(F=>({unsubscribe:s.runOutsideAngular(()=>T.onAuthStateChanged(B=>F.next(B),B=>F.error(B),()=>F.complete()))})))),M=v.pipe(Ae(T=>new X(F=>({unsubscribe:s.runOutsideAngular(()=>T.onIdTokenChanged(B=>F.next(B),B=>F.error(B),()=>F.complete()))}))));this.authState=_.pipe(bl(I),Xt(o.outsideAngular),Ot(o.insideAngular)),this.user=_.pipe(bl(M),Xt(o.outsideAngular),Ot(o.insideAngular)),this.idToken=this.user.pipe(Ae(T=>T?ue(T.getIdToken()):j(null))),this.idTokenResult=this.user.pipe(Ae(T=>T?ue(T.getIdTokenResult()):j(null))),this.credential=Fp(_,m,this.authState.pipe(Je(T=>!T))).pipe(V(T=>T?.user?T:null),Xt(o.outsideAngular),Ot(o.insideAngular))}return ox(this,v,s,{spy:{apply:(_,I,M)=>{(_.startsWith("signIn")||_.startsWith("createUser"))&&M.then(T=>m.next(T))}}})}static \u0275fac=function(r){return new(r||t)(S(mo),S(yo,8),S(Ut),S(he),S(ph),S(xv,8),S(Mv,8),S(Rv,8),S(Nv,8),S(Pv,8),S(Ov,8),S(qi,8))};static \u0275prov=L({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var kq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dn={},C,r_=r_||{},q=kq||self;function Rh(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Yu(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Fq(t){return Object.prototype.hasOwnProperty.call(t,Fv)&&t[Fv]||(t[Fv]=++Vq)}var Fv="closure_uid_"+(1e9*Math.random()>>>0),Vq=0;function Lq(t,e,n){return t.call.apply(t.bind,arguments)}function jq(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function rt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?rt=Lq:rt=jq,rt.apply(null,arguments)}function vh(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function ze(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Br(){this.s=this.s,this.o=this.o}var Bq=0;Br.prototype.s=!1;Br.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),Bq!=0)&&Fq(this)};Br.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Px=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function i_(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function Ex(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(Rh(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function it(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}it.prototype.h=function(){this.defaultPrevented=!0};var Uq=function(){if(!q.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};q.addEventListener("test",n,e),q.removeEventListener("test",n,e)}catch{}return t}();function $u(t){return/^[\s\xa0]*$/.test(t)}function Nh(){var t=q.navigator;return t&&(t=t.userAgent)?t:""}function Nn(t){return Nh().indexOf(t)!=-1}function s_(t){return s_[" "](t),t}s_[" "]=function(){};function $q(t,e){var n=MH;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var qq=Nn("Opera"),Eo=Nn("Trident")||Nn("MSIE"),Ox=Nn("Edge"),Uv=Ox||Eo,kx=Nn("Gecko")&&!(Nh().toLowerCase().indexOf("webkit")!=-1&&!Nn("Edge"))&&!(Nn("Trident")||Nn("MSIE"))&&!Nn("Edge"),Hq=Nh().toLowerCase().indexOf("webkit")!=-1&&!Nn("Edge");function Fx(){var t=q.document;return t?t.documentMode:void 0}var $v;e:{if(_h="",wh=function(){var t=Nh();if(kx)return/rv:([^\);]+)(\)|;)/.exec(t);if(Ox)return/Edge\/([\d\.]+)/.exec(t);if(Eo)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(Hq)return/WebKit\/(\S+)/.exec(t);if(qq)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),wh&&(_h=wh?wh[1]:""),Eo&&(Eh=Fx(),Eh!=null&&Eh>parseFloat(_h))){$v=String(Eh);break e}$v=_h}var _h,wh,Eh,qv;q.document&&Eo?(Vv=Fx(),qv=Vv||parseInt($v,10)||void 0):qv=void 0;var Vv,Gq=qv;function qu(t,e){if(it.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(kx){e:{try{s_(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:zq[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&qu.$.h.call(this)}}ze(qu,it);var zq={2:"touch",3:"pen",4:"mouse"};qu.prototype.h=function(){qu.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Zu="closure_listenable_"+(1e6*Math.random()|0),Wq=0;function Kq(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++Wq,this.fa=this.ia=!1}function Ph(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function o_(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function Qq(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function Vx(t){let e={};for(let n in t)e[n]=t[n];return e}var Ix="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Lx(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<Ix.length;s++)n=Ix[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Oh(t){this.src=t,this.g={},this.h=0}Oh.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Gv(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new Kq(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Hv(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=Px(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Ph(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Gv(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var a_="closure_lm_"+(1e6*Math.random()|0),Lv={};function jx(t,e,n,r,i){if(r&&r.once)return Ux(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)jx(t,e[s],n,r,i);return null}return n=l_(n),t&&t[Zu]?t.O(e,n,Yu(r)?!!r.capture:!!r,i):Bx(t,e,n,!1,r,i)}function Bx(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Yu(i)?!!i.capture:!!i,a=c_(t);if(a||(t[a_]=a=new Oh(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=Yq(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Uq||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(qx(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Yq(){function t(n){return e.call(t.src,t.listener,n)}let e=Zq;return t}function Ux(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Ux(t,e[s],n,r,i);return null}return n=l_(n),t&&t[Zu]?t.P(e,n,Yu(r)?!!r.capture:!!r,i):Bx(t,e,n,!0,r,i)}function $x(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)$x(t,e[s],n,r,i);else r=Yu(r)?!!r.capture:!!r,n=l_(n),t&&t[Zu]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Gv(s,n,r,i),-1<n&&(Ph(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=c_(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Gv(e,n,r,i)),(n=-1<t?e[t]:null)&&u_(n))}function u_(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Zu])Hv(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(qx(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=c_(e))?(Hv(n,t),n.h==0&&(n.src=null,e[a_]=null)):Ph(t)}}}function qx(t){return t in Lv?Lv[t]:Lv[t]="on"+t}function Zq(t,e){if(t.fa)t=!0;else{e=new qu(e,this);var n=t.listener,r=t.la||t.src;t.ia&&u_(t),t=n.call(r,e)}return t}function c_(t){return t=t[a_],t instanceof Oh?t:null}var jv="__closure_events_fn_"+(1e9*Math.random()>>>0);function l_(t){return typeof t=="function"?t:(t[jv]||(t[jv]=function(e){return t.handleEvent(e)}),t[jv])}function Ge(){Br.call(this),this.i=new Oh(this),this.S=this,this.J=null}ze(Ge,Br);Ge.prototype[Zu]=!0;Ge.prototype.removeEventListener=function(t,e,n,r){$x(this,t,e,n,r)};function Ze(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new it(e,t);else if(e instanceof it)e.target=e.target||t;else{var i=e;e=new it(r,t),Lx(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Ih(o,r,!0,e)&&i}if(o=e.g=t,i=Ih(o,r,!0,e)&&i,i=Ih(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Ih(o,r,!1,e)&&i}Ge.prototype.N=function(){if(Ge.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Ph(n[r]);delete t.g[e],t.h--}}this.J=null};Ge.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Ge.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Ih(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&Hv(t.i,o),i=a.call(u,r)!==!1&&i}}return i&&!r.defaultPrevented}var d_=q.JSON.stringify,zv=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function Xq(){var t=h_;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Wv=class{constructor(){this.h=this.g=null}add(e,n){let r=Hx.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},Hx=new zv(()=>new Kv,t=>t.reset()),Kv=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function Jq(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function eH(t){q.setTimeout(()=>{throw t},0)}var Hu,Gu=!1,h_=new Wv,Gx=()=>{let t=q.Promise.resolve(void 0);Hu=()=>{t.then(tH)}},tH=()=>{for(var t;t=Xq();){try{t.h.call(t.g)}catch(n){eH(n)}var e=Hx;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Gu=!1};function kh(t,e){Ge.call(this),this.h=t||1,this.g=e||q,this.j=rt(this.qb,this),this.l=Date.now()}ze(kh,Ge);C=kh.prototype;C.ga=!1;C.T=null;C.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ze(this,"tick"),this.ga&&(f_(this),this.start()))}};C.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function f_(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}C.N=function(){kh.$.N.call(this),f_(this),delete this.g};function p_(t,e,n){if(typeof t=="function")n&&(t=rt(t,n));else if(t&&typeof t.handleEvent=="function")t=rt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:q.setTimeout(t,e||0)}function zx(t){t.g=p_(()=>{t.g=null,t.i&&(t.i=!1,zx(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var Qv=class extends Br{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:zx(this)}N(){super.N(),this.g&&(q.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function zu(t){Br.call(this),this.h=t,this.g={}}ze(zu,Br);var Dx=[];function Wx(t,e,n,r){Array.isArray(n)||(n&&(Dx[0]=n.toString()),n=Dx);for(var i=0;i<n.length;i++){var s=jx(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Kx(t){o_(t.g,function(e,n){this.g.hasOwnProperty(n)&&u_(e)},t),t.g={}}zu.prototype.N=function(){zu.$.N.call(this),Kx(this)};zu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Fh(){this.g=!0}Fh.prototype.Ea=function(){this.g=!1};function nH(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+c+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function rH(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function _o(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+sH(t,n)+(r?" "+r:"")})}function iH(t,e){t.info(function(){return"TIMEOUT: "+e})}Fh.prototype.info=function(){};function sH(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return d_(n)}catch{return e}}var Wi={},Cx=null;function Vh(){return Cx=Cx||new Ge}Wi.Ta="serverreachability";function Qx(t){it.call(this,Wi.Ta,t)}ze(Qx,it);function Wu(t){let e=Vh();Ze(e,new Qx(e))}Wi.STAT_EVENT="statevent";function Yx(t,e){it.call(this,Wi.STAT_EVENT,t),this.stat=e}ze(Yx,it);function lt(t){let e=Vh();Ze(e,new Yx(e,t))}Wi.Ua="timingevent";function Zx(t,e){it.call(this,Wi.Ua,t),this.size=e}ze(Zx,it);function Xu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return q.setTimeout(function(){t()},e)}var Lh={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Xx={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function g_(){}g_.prototype.h=null;function bx(t){return t.h||(t.h=t.i())}function Jx(){}var Ju={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function m_(){it.call(this,"d")}ze(m_,it);function y_(){it.call(this,"c")}ze(y_,it);var Yv;function jh(){}ze(jh,g_);jh.prototype.g=function(){return new XMLHttpRequest};jh.prototype.i=function(){return{}};Yv=new jh;function ec(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new zu(this),this.P=oH,t=Uv?125:void 0,this.V=new kh(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new eM}function eM(){this.i=null,this.g="",this.h=!1}var oH=45e3,tM={},Zv={};C=ec.prototype;C.setTimeout=function(t){this.P=t};function Xv(t,e,n){t.L=1,t.A=Uh(dr(e)),t.u=n,t.S=!0,nM(t,null)}function nM(t,e){t.G=Date.now(),tc(t),t.B=dr(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),lM(n.i,"t",r),t.o=0,n=t.l.J,t.h=new eM,t.g=RM(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Qv(rt(t.Pa,t,t.g),t.O)),Wx(t.U,t.g,"readystatechange",t.nb),e=t.I?Vx(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Wu(),nH(t.j,t.v,t.B,t.m,t.W,t.u)}C.nb=function(t){t=t.target;let e=this.M;e&&Pn(t)==3?e.l():this.Pa(t)};C.Pa=function(t){try{if(t==this.g)e:{let l=Pn(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||Uv||this.g&&(this.h.h||this.g.ja()||xx(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?Wu(3):Wu(2)),Bh(this);var n=this.g.da();this.ca=n;t:if(rM(this)){var r=xx(this.g);t="";var i=r.length,s=Pn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Hi(this),Uu(this);var o="";break t}this.h.i=new q.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,rH(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$u(a)){var c=a;break t}}c=null}if(n=c)_o(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Jv(this,n);else{this.i=!1,this.s=3,lt(12),Hi(this),Uu(this);break e}}this.S?(iM(this,l,o),Uv&&this.i&&l==3&&(Wx(this.U,this.V,"tick",this.mb),this.V.start())):(_o(this.j,this.m,o,null),Jv(this,o)),l==4&&Hi(this),this.i&&!this.J&&(l==4?SM(this.l,this):(this.i=!1,tc(this)))}else SH(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,lt(12)):(this.s=0,lt(13)),Hi(this),Uu(this)}}}catch{}finally{}};function rM(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function iM(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=aH(t,n),i==Zv){e==4&&(t.s=4,lt(14),r=!1),_o(t.j,t.m,null,"[Incomplete Response]");break}else if(i==tM){t.s=4,lt(15),_o(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else _o(t.j,t.m,i,null),Jv(t,i);rM(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,lt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),D_(e),e.M=!0,lt(11))):(_o(t.j,t.m,n,"[Invalid Chunked Response]"),Hi(t),Uu(t))}C.mb=function(){if(this.g){var t=Pn(this.g),e=this.g.ja();this.o<e.length&&(Bh(this),iM(this,t,e),this.i&&t!=4&&tc(this))}};function aH(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Zv:(n=Number(e.substring(n,r)),isNaN(n)?tM:(r+=1,r+n>e.length?Zv:(e=e.slice(r,r+n),t.o=r+n,e)))}C.cancel=function(){this.J=!0,Hi(this)};function tc(t){t.Y=Date.now()+t.P,sM(t,t.P)}function sM(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Xu(rt(t.lb,t),e)}function Bh(t){t.C&&(q.clearTimeout(t.C),t.C=null)}C.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(iH(this.j,this.B),this.L!=2&&(Wu(),lt(17)),Hi(this),this.s=2,Uu(this)):sM(this,this.Y-t)};function Uu(t){t.l.H==0||t.J||SM(t.l,t)}function Hi(t){Bh(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,f_(t.V),Kx(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Jv(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||e_(n.i,t))){if(!t.K&&e_(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Sh(n),Hh(n);else break e;I_(n),lt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Xu(rt(n.ib,n),6e3));if(1>=fM(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Gi(n,11)}else if((t.K||n.g==t)&&Sh(n),!$u(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];let l=c[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=c[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=c[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let m=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(m){var s=r.i;s.g||m.indexOf("spdy")==-1&&m.indexOf("quic")==-1&&m.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(v_(s,s.h),s.h=null))}if(r.F){let v=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(r.Da=v,ve(r.I,r.F,v))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=MM(r,r.J?r.pa:null,r.Y),o.K){pM(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.C&&(Bh(a),tc(a)),r.g=o}else bM(r);0<n.j.length&&Gh(n)}else c[0]!="stop"&&c[0]!="close"||Gi(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Gi(n,7):E_(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}Wu(4)}catch{}}function uH(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Rh(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function cH(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Rh(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function oM(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Rh(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=cH(t),r=uH(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var aM=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function lH(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function zi(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof zi){this.h=t.h,bh(this,t.j),this.s=t.s,this.g=t.g,Th(this,t.m),this.l=t.l;var e=t.i,n=new Ku;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Tx(this,n),this.o=t.o}else t&&(e=String(t).match(aM))?(this.h=!1,bh(this,e[1]||"",!0),this.s=ju(e[2]||""),this.g=ju(e[3]||"",!0),Th(this,e[4]),this.l=ju(e[5]||"",!0),Tx(this,e[6]||"",!0),this.o=ju(e[7]||"")):(this.h=!1,this.i=new Ku(null,this.h))}zi.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Bu(e,Sx,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Bu(e,Sx,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Bu(n,n.charAt(0)=="/"?fH:hH,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Bu(n,gH)),t.join("")};function dr(t){return new zi(t)}function bh(t,e,n){t.j=n?ju(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Th(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Tx(t,e,n){e instanceof Ku?(t.i=e,mH(t.i,t.h)):(n||(e=Bu(e,pH)),t.i=new Ku(e,t.h))}function ve(t,e,n){t.i.set(e,n)}function Uh(t){return ve(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function ju(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Bu(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,dH),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function dH(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Sx=/[#\/\?@]/g,hH=/[#\?:]/g,fH=/[#\?]/g,pH=/[#\?@]/g,gH=/#/g;function Ku(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ur(t){t.g||(t.g=new Map,t.h=0,t.i&&lH(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}C=Ku.prototype;C.add=function(t,e){Ur(this),this.i=null,t=Io(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function uM(t,e){Ur(t),e=Io(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function cM(t,e){return Ur(t),e=Io(t,e),t.g.has(e)}C.forEach=function(t,e){Ur(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};C.ta=function(){Ur(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};C.Z=function(t){Ur(this);let e=[];if(typeof t=="string")cM(this,t)&&(e=e.concat(this.g.get(Io(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};C.set=function(t,e){return Ur(this),this.i=null,t=Io(this,t),cM(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};C.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function lM(t,e,n){uM(t,e),0<n.length&&(t.i=null,t.g.set(Io(t,e),i_(n)),t.h+=n.length)}C.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Io(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function mH(t,e){e&&!t.j&&(Ur(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(uM(this,r),lM(this,i,n))},t)),t.j=e}var yH=class{constructor(t,e){this.g=t,this.map=e}};function dM(t){this.l=t||vH,q.PerformanceNavigationTiming?(t=q.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(q.g&&q.g.Ka&&q.g.Ka()&&q.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var vH=10;function hM(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function fM(t){return t.h?1:t.g?t.g.size:0}function e_(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function v_(t,e){t.g?t.g.add(e):t.h=e}function pM(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}dM.prototype.cancel=function(){if(this.i=gM(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function gM(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return i_(t.i)}var _H=class{stringify(t){return q.JSON.stringify(t,void 0)}parse(t){return q.JSON.parse(t,void 0)}};function wH(){this.g=new _H}function EH(t,e,n){let r=n||"";try{oM(t,function(i,s){let o=i;Yu(i)&&(o=d_(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function IH(t,e){let n=new Fh;if(q.Image){let r=new Image;r.onload=vh(Dh,n,r,"TestLoadImage: loaded",!0,e),r.onerror=vh(Dh,n,r,"TestLoadImage: error",!1,e),r.onabort=vh(Dh,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=vh(Dh,n,r,"TestLoadImage: timeout",!1,e),q.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Dh(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function nc(t){this.l=t.ec||null,this.j=t.ob||!1}ze(nc,g_);nc.prototype.g=function(){return new $h(this.l,this.j)};nc.prototype.i=function(t){return function(){return t}}({});function $h(t,e){Ge.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=__,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ze($h,Ge);var __=0;C=$h.prototype;C.open=function(t,e){if(this.readyState!=__)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Qu(this)};C.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||q).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};C.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,rc(this)),this.readyState=__};C.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Qu(this)),this.g&&(this.readyState=3,Qu(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof q.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;mM(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function mM(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}C.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?rc(this):Qu(this),this.readyState==3&&mM(this)}};C.Za=function(t){this.g&&(this.response=this.responseText=t,rc(this))};C.Ya=function(t){this.g&&(this.response=t,rc(this))};C.ka=function(){this.g&&rc(this)};function rc(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Qu(t)}C.setRequestHeader=function(t,e){this.v.append(t,e)};C.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};C.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Qu(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty($h.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var DH=q.JSON.parse;function Ce(t){Ge.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=yM,this.L=this.M=!1}ze(Ce,Ge);var yM="",CH=/^https?$/i,bH=["POST","PUT"];C=Ce.prototype;C.Oa=function(t){this.M=t};C.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Yv.g(),this.C=this.u?bx(this.u):bx(Yv),this.g.onreadystatechange=rt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){Ax(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=q.FormData&&t instanceof q.FormData,!(0<=Px(bH,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{wM(this),0<this.B&&((this.L=TH(this.g))?(this.g.timeout=this.B,this.g.ontimeout=rt(this.ua,this)):this.A=p_(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){Ax(this,s)}};function TH(t){return Eo&&typeof t.timeout=="number"&&t.ontimeout!==void 0}C.ua=function(){typeof r_<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ze(this,"timeout"),this.abort(8))};function Ax(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,vM(t),qh(t)}function vM(t){t.F||(t.F=!0,Ze(t,"complete"),Ze(t,"error"))}C.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Ze(this,"complete"),Ze(this,"abort"),qh(this))};C.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),qh(this,!0)),Ce.$.N.call(this)};C.La=function(){this.s||(this.G||this.v||this.l?_M(this):this.kb())};C.kb=function(){_M(this)};function _M(t){if(t.h&&typeof r_<"u"&&(!t.C[1]||Pn(t)!=4||t.da()!=2)){if(t.v&&Pn(t)==4)p_(t.La,0,t);else if(Ze(t,"readystatechange"),Pn(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(aM)[1]||null;!i&&q.self&&q.self.location&&(i=q.self.location.protocol.slice(0,-1)),r=!CH.test(i?i.toLowerCase():"")}n=r}if(n)Ze(t,"complete"),Ze(t,"success");else{t.m=6;try{var s=2<Pn(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",vM(t)}}finally{qh(t)}}}}function qh(t,e){if(t.g){wM(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Ze(t,"ready");try{n.onreadystatechange=r}catch{}}}function wM(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(q.clearTimeout(t.A),t.A=null)}C.isActive=function(){return!!this.g};function Pn(t){return t.g?t.g.readyState:0}C.da=function(){try{return 2<Pn(this)?this.g.status:-1}catch{return-1}};C.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};C.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),DH(e)}};function xx(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case yM:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function SH(t){let e={};t=(t.g&&2<=Pn(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if($u(t[r]))continue;var n=Jq(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}Qq(e,function(r){return r.join(", ")})}C.Ia=function(){return this.m};C.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function EM(t){let e="";return o_(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function w_(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=EM(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):ve(t,e,n))}function Vu(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function IM(t){this.Ga=0,this.j=[],this.l=new Fh,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Vu("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Vu("baseRetryDelayMs",5e3,t),this.hb=Vu("retryDelaySeedMs",1e4,t),this.eb=Vu("forwardChannelMaxRetries",2,t),this.xa=Vu("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new dM(t&&t.concurrentRequestLimit),this.Ja=new wH,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}C=IM.prototype;C.ra=8;C.H=1;function E_(t){if(DM(t),t.H==3){var e=t.W++,n=dr(t.I);if(ve(n,"SID",t.K),ve(n,"RID",e),ve(n,"TYPE","terminate"),ic(t,n),e=new ec(t,t.l,e),e.L=2,e.A=Uh(dr(n)),n=!1,q.navigator&&q.navigator.sendBeacon)try{n=q.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&q.Image&&(new Image().src=e.A,n=!0),n||(e.g=RM(e.l,null),e.g.ha(e.A)),e.G=Date.now(),tc(e)}xM(t)}function Hh(t){t.g&&(D_(t),t.g.cancel(),t.g=null)}function DM(t){Hh(t),t.u&&(q.clearTimeout(t.u),t.u=null),Sh(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&q.clearTimeout(t.m),t.m=null)}function Gh(t){if(!hM(t.i)&&!t.m){t.m=!0;var e=t.Na;Hu||Gx(),Gu||(Hu(),Gu=!0),h_.add(e,t),t.C=0}}function AH(t,e){return fM(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Xu(rt(t.Na,t,e),AM(t,t.C)),t.C++,!0)}C.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new ec(this,this.l,t),s=this.s;if(this.U&&(s?(s=Vx(s),Lx(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=CM(this,i,e),n=dr(this.I),ve(n,"RID",t),ve(n,"CVER",22),this.F&&ve(n,"X-HTTP-Session-Id",this.F),ic(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(EM(s)))+"&"+e:this.o&&w_(n,this.o,s)),v_(this.i,i),this.bb&&ve(n,"TYPE","init"),this.P?(ve(n,"$req",e),ve(n,"SID","null"),i.aa=!0,Xv(i,n,null)):Xv(i,n,e),this.H=2}}else this.H==3&&(t?Mx(this,t):this.j.length==0||hM(this.i)||Mx(this))};function Mx(t,e){var n;e?n=e.m:n=t.W++;let r=dr(t.I);ve(r,"SID",t.K),ve(r,"RID",n),ve(r,"AID",t.V),ic(t,r),t.o&&t.s&&w_(r,t.o,t.s),n=new ec(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=CM(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),v_(t.i,n),Xv(n,r,e)}function ic(t,e){t.na&&o_(t.na,function(n,r){ve(e,r,n)}),t.h&&oM({},function(n,r){ve(e,r,n)})}function CM(t,e,n){n=Math.min(t.j.length,n);var r=t.h?rt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let c=i[u].g,l=i[u].map;if(c-=s,0>c)s=Math.max(0,i[u].g-100),a=!1;else try{EH(l,o,"req"+c+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function bM(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Hu||Gx(),Gu||(Hu(),Gu=!0),h_.add(e,t),t.A=0}}function I_(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Xu(rt(t.Ma,t),AM(t,t.A)),t.A++,!0)}C.Ma=function(){if(this.u=null,TM(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Xu(rt(this.jb,this),t)}};C.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,lt(10),Hh(this),TM(this))};function D_(t){t.B!=null&&(q.clearTimeout(t.B),t.B=null)}function TM(t){t.g=new ec(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=dr(t.wa);ve(e,"RID","rpc"),ve(e,"SID",t.K),ve(e,"AID",t.V),ve(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&ve(e,"TO",t.qa),ve(e,"TYPE","xmlhttp"),ic(t,e),t.o&&t.s&&w_(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Uh(dr(e)),n.u=null,n.S=!0,nM(n,t)}C.ib=function(){this.v!=null&&(this.v=null,Hh(this),I_(this),lt(19))};function Sh(t){t.v!=null&&(q.clearTimeout(t.v),t.v=null)}function SM(t,e){var n=null;if(t.g==e){Sh(t),D_(t),t.g=null;var r=2}else if(e_(t.i,e))n=e.F,pM(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=Vh(),Ze(r,new Zx(r,n)),Gh(t)}else bM(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&AH(t,e)||r==2&&I_(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Gi(t,5);break;case 4:Gi(t,10);break;case 3:Gi(t,6);break;default:Gi(t,2)}}}function AM(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Gi(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=rt(t.pb,t);n||(n=new zi("//www.google.com/images/cleardot.gif"),q.location&&q.location.protocol=="http"||bh(n,"https"),Uh(n)),IH(n.toString(),r)}else lt(2);t.H=0,t.h&&t.h.za(e),xM(t),DM(t)}C.pb=function(t){t?(this.l.info("Successfully pinged google.com"),lt(2)):(this.l.info("Failed to ping google.com"),lt(1))};function xM(t){if(t.H=0,t.ma=[],t.h){let e=gM(t.i);(e.length!=0||t.j.length!=0)&&(Ex(t.ma,e),Ex(t.ma,t.j),t.i.i.length=0,i_(t.j),t.j.length=0),t.h.ya()}}function MM(t,e,n){var r=n instanceof zi?dr(n):new zi(n);if(r.g!="")e&&(r.g=e+"."+r.g),Th(r,r.m);else{var i=q.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new zi(null);r&&bh(s,r),e&&(s.g=e),i&&Th(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&ve(r,n,e),ve(r,"VER",t.ra),ic(t,r),r}function RM(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new Ce(new nc({ob:n})):new Ce(t.va),e.Oa(t.J),e}C.isActive=function(){return!!this.h&&this.h.isActive(this)};function NM(){}C=NM.prototype;C.Ba=function(){};C.Aa=function(){};C.za=function(){};C.ya=function(){};C.isActive=function(){return!0};C.Va=function(){};function Ah(){if(Eo&&!(10<=Number(Gq)))throw Error("Environmental error: no available transport.")}Ah.prototype.g=function(t,e){return new Mt(t,e)};function Mt(t,e){Ge.call(this),this.g=new IM(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!$u(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!$u(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Do(this)}ze(Mt,Ge);Mt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;lt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=MM(t,null,t.Y),Gh(t)};Mt.prototype.close=function(){E_(this.g)};Mt.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=d_(t),t=n);e.j.push(new yH(e.fb++,t)),e.H==3&&Gh(e)};Mt.prototype.N=function(){this.g.h=null,delete this.j,E_(this.g),delete this.g,Mt.$.N.call(this)};function PM(t){m_.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}ze(PM,m_);function OM(){y_.call(this),this.status=1}ze(OM,y_);function Do(t){this.g=t}ze(Do,NM);Do.prototype.Ba=function(){Ze(this.g,"a")};Do.prototype.Aa=function(t){Ze(this.g,new PM(t))};Do.prototype.za=function(t){Ze(this.g,new OM)};Do.prototype.ya=function(){Ze(this.g,"b")};function xH(){this.blockSize=-1}function ln(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}ze(ln,xH);ln.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Bv(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}ln.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)Bv(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Bv(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Bv(this,r),i=0;break}}this.h=i,this.i+=e};ln.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function le(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var MH={};function C_(t){return-128<=t&&128>t?$q(t,function(e){return new le([e|0],0>e?-1:0)}):new le([t|0],0>t?-1:0)}function On(t){if(isNaN(t)||!isFinite(t))return wo;if(0>t)return Ye(On(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=t_;return new le(e,0)}function kM(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Ye(kM(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=On(Math.pow(e,8)),r=wo,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=On(Math.pow(e,s)),r=r.R(s).add(On(o))):(r=r.R(n),r=r.add(On(o)))}return r}var t_=4294967296,wo=C_(0),n_=C_(1),Rx=C_(16777216);C=le.prototype;C.ea=function(){if(zt(this))return-Ye(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:t_+r)*e,e*=t_}return t};C.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(lr(this))return"0";if(zt(this))return"-"+Ye(this).toString(t);for(var e=On(Math.pow(t,6)),n=this,r="";;){var i=Mh(n,e).g;n=xh(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,lr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};C.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function lr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function zt(t){return t.h==-1}C.X=function(t){return t=xh(this,t),zt(t)?-1:lr(t)?0:1};function Ye(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new le(n,~t.h).add(n_)}C.abs=function(){return zt(this)?Ye(this):this};C.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new le(n,n[n.length-1]&-2147483648?-1:0)};function xh(t,e){return t.add(Ye(e))}C.R=function(t){if(lr(this)||lr(t))return wo;if(zt(this))return zt(t)?Ye(this).R(Ye(t)):Ye(Ye(this).R(t));if(zt(t))return Ye(this.R(Ye(t)));if(0>this.X(Rx)&&0>t.X(Rx))return On(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,u=t.D(i)&65535;n[2*r+2*i]+=o*u,Ch(n,2*r+2*i),n[2*r+2*i+1]+=s*u,Ch(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Ch(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Ch(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new le(n,0)};function Ch(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Lu(t,e){this.g=t,this.h=e}function Mh(t,e){if(lr(e))throw Error("division by zero");if(lr(t))return new Lu(wo,wo);if(zt(t))return e=Mh(Ye(t),e),new Lu(Ye(e.g),Ye(e.h));if(zt(e))return e=Mh(t,Ye(e)),new Lu(Ye(e.g),e.h);if(30<t.g.length){if(zt(t)||zt(e))throw Error("slowDivide_ only works with positive integers.");for(var n=n_,r=e;0>=r.X(t);)n=Nx(n),r=Nx(r);var i=vo(n,1),s=vo(r,1);for(r=vo(r,2),n=vo(n,2);!lr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=vo(r,1),n=vo(n,1)}return e=xh(t,i.R(e)),new Lu(i,e)}for(i=wo;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=On(n),o=s.R(e);zt(o)||0<o.X(t);)n-=r,s=On(n),o=s.R(e);lr(s)&&(s=n_),i=i.add(s),t=xh(t,o)}return new Lu(i,t)}C.gb=function(t){return Mh(this,t).h};C.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new le(n,this.h&t.h)};C.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new le(n,this.h|t.h)};C.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new le(n,this.h^t.h)};function Nx(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new le(n,t.h)}function vo(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new le(i,t.h)}Ah.prototype.createWebChannel=Ah.prototype.g;Mt.prototype.send=Mt.prototype.u;Mt.prototype.open=Mt.prototype.m;Mt.prototype.close=Mt.prototype.close;Lh.NO_ERROR=0;Lh.TIMEOUT=8;Lh.HTTP_ERROR=6;Xx.COMPLETE="complete";Jx.EventType=Ju;Ju.OPEN="a";Ju.CLOSE="b";Ju.ERROR="c";Ju.MESSAGE="d";Ge.prototype.listen=Ge.prototype.O;Ce.prototype.listenOnce=Ce.prototype.P;Ce.prototype.getLastError=Ce.prototype.Sa;Ce.prototype.getLastErrorCode=Ce.prototype.Ia;Ce.prototype.getStatus=Ce.prototype.da;Ce.prototype.getResponseJson=Ce.prototype.Wa;Ce.prototype.getResponseText=Ce.prototype.ja;Ce.prototype.send=Ce.prototype.ha;Ce.prototype.setWithCredentials=Ce.prototype.Oa;ln.prototype.digest=ln.prototype.l;ln.prototype.reset=ln.prototype.reset;ln.prototype.update=ln.prototype.j;le.prototype.add=le.prototype.add;le.prototype.multiply=le.prototype.R;le.prototype.modulo=le.prototype.gb;le.prototype.compare=le.prototype.X;le.prototype.toNumber=le.prototype.ea;le.prototype.toString=le.prototype.toString;le.prototype.getBits=le.prototype.D;le.fromNumber=On;le.fromString=kM;var FM=dn.createWebChannelTransport=function(){return new Ah},VM=dn.getStatEventTarget=function(){return Vh()},zh=dn.ErrorCode=Lh,LM=dn.EventType=Xx,jM=dn.Event=Wi,b_=dn.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},pZ=dn.FetchXmlHttpFactory=nc,sc=dn.WebChannel=Jx,BM=dn.XhrIo=Ce,UM=dn.Md5=ln,Ki=dn.Integer=le;var $M="@firebase/firestore";var Le=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Le.UNAUTHENTICATED=new Le(null),Le.GOOGLE_CREDENTIALS=new Le("google-credentials-uid"),Le.FIRST_PARTY=new Le("first-party-uid"),Le.MOCK_USER=new Le("mock-user");var Jo="10.7.2";var Kr=new Yc("@firebase/firestore");function Ao(){return Kr.logLevel}function UR(t){Kr.setLogLevel(t)}function E(t,...e){if(Kr.logLevel<=mn.DEBUG){let n=e.map(SE);Kr.debug(`Firestore (${Jo}): ${t}`,...n)}}function Me(t,...e){if(Kr.logLevel<=mn.ERROR){let n=e.map(SE);Kr.error(`Firestore (${Jo}): ${t}`,...n)}}function Kt(t,...e){if(Kr.logLevel<=mn.WARN){let n=e.map(SE);Kr.warn(`Firestore (${Jo}): ${t}`,...n)}}function SE(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function A(t="Unexpected state"){let e=`FIRESTORE (${Jo}) INTERNAL ASSERTION FAILED: `+t;throw Me(e),new Error(e)}function N(t,e){t||A()}function $R(t,e){t||A()}function b(t,e){return t}var g={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},w=class extends AI{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var je=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var rf=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},M_=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Le.UNAUTHENTICATED))}shutdown(){}},R_=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},N_=class{constructor(e){this.t=e,this.currentUser=Le.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve(),s=new je;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new je,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>y(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{E("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(E("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new je)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(E("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(N(typeof r.accessToken=="string"),new rf(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return N(e===null||typeof e=="string"),new Le(e)}},P_=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Le.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},O_=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new P_(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Le.FIRST_PARTY))}shutdown(){}invalidateToken(){}},k_=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},F_=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&E("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,E("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{E("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):E("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(N(typeof n.token=="string"),this.R=n.token,new k_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function RH(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var sf=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=RH(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function G(t,e){return t<e?-1:t>e?1:0}function Vo(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function qR(t){return t+"\0"}var De=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new w(g.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new w(g.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new w(g.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new w(g.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?G(this.nanoseconds,e.nanoseconds):G(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var O=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new De(0,0))}static max(){return new t(new De(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var of=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&A(),r===void 0?r=e.length-n:r>e.length-n&&A(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},ne=class t extends of{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new w(g.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},NH=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Re=class t extends of{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return NH.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new w(g.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new w(g.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new w(g.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new w(g.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var D=class t{constructor(e){this.path=e}static fromPath(e){return new t(ne.fromString(e))}static fromName(e){return new t(ne.fromString(e).popFirst(5))}static empty(){return new t(ne.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ne.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ne.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new ne(e.slice()))}};var Lo=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function V_(t){return t.fields.find(e=>e.kind===2)}function Yi(t){return t.fields.filter(e=>e.kind!==2)}Lo.UNKNOWN_ID=-1;var Oo=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var yc=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,Qt.min())}};function HR(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=O.fromTimestamp(r===1e9?new De(n+1,0):new De(n,r));return new Qt(i,D.empty(),e)}function GR(t){return new Qt(t.readTime,t.key,-1)}var Qt=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(O.min(),D.empty(),-1)}static max(){return new t(O.max(),D.empty(),-1)}};function AE(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=D.comparator(t.documentKey,e.documentKey),n!==0?n:G(t.largestBatchId,e.largestBatchId))}var zR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",af=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function ii(t){return y(this,null,function*(){if(t.code!==g.FAILED_PRECONDITION||t.message!==zR)throw t;E("LocalStore","Unexpectedly lost primary lease")})}var p=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&A(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let u=0;u<s;u++){let c=u;n(e[c]).next(l=>{o[c]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var uf=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new je,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new ns(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=xE(r.target.error);this.V.reject(new ns(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new ns(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(E("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new j_(n)}},pr=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(ca())===12.2&&Me("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return E("SimpleDb","Removing database:",e),Zi(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Qc())return!1;if(t.C())return!0;let e=ca(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return y(this,null,function*(){return this.db||(E("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new ns(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new w(g.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new w(g.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new ns(e,o))},i.onupgradeneeded=s=>{E("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{E("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db})}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return y(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=uf.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),p.reject(c))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,c=u.name!=="FirebaseError"&&o<3;if(E("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}},L_=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Zi(this.k.delete())}},ns=class extends w{constructor(e,n){super(g.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function si(t){return t.name==="IndexedDbTransactionError"}var j_=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(E("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(E("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Zi(r)}add(e){return E("SimpleDb","ADD",this.store.name,e,e),Zi(this.store.add(e))}get(e){return Zi(this.store.get(e)).next(n=>(n===void 0&&(n=null),E("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return E("SimpleDb","DELETE",this.store.name,e),Zi(this.store.delete(e))}count(){return E("SimpleDb","COUNT",this.store.name),Zi(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new p((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,u)=>{o.push(u)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new p((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){E("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new p((r,i)=>{n.onerror=s=>{let o=xE(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new p((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let u=new L_(a),c=n(a.primaryKey,a.value,u);if(c instanceof p){let l=c.catch(d=>(u.done(),p.reject(d)));r.push(l)}u.isDone?i():u.$===null?a.continue():a.continue(u.$)}}).next(()=>p.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function Zi(t){return new p((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=xE(r.target.error);n(i)}})}var qM=!1;function xE(t){let e=pr.S(ca());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new w("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return qM||(qM=!0,setTimeout(()=>{throw r},0)),r}}return t}var B_=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){E("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>y(this,null,function*(){this.task=null;try{E("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){si(n)?E("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield ii(n)}yield this.ee(6e4)}))}},U_=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return y(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return p.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return E("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(E("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=GR(s);AE(o,r)>0&&(r=o)}),new Qt(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var Rt=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function Bc(t){return t==null}function vc(t){return t===0&&1/t==-1/0}function WR(t){return typeof t=="number"&&Number.isInteger(t)&&!vc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function dt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=HM(e)),e=PH(t.get(n),e);return HM(e)}function PH(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function HM(t){return t+""}function kn(t){let e=t.length;if(N(e>=2),e===2)return N(t.charAt(0)===""&&t.charAt(1)===""),ne.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&A(),t.charAt(o+1)){case"":let a=t.substring(s,o),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:A()}s=o+2}return new ne(r)}var GM=["userId","batchId"];function Zh(t,e){return[t,dt(e)]}function KR(t,e,n){return[t,dt(e),n]}var OH={},kH=["prefixPath","collectionGroup","readTime","documentId"],FH=["prefixPath","collectionGroup","documentId"],VH=["collectionGroup","readTime","prefixPath","documentId"],LH=["canonicalId","targetId"],jH=["targetId","path"],BH=["path","targetId"],UH=["collectionId","parent"],$H=["indexId","uid"],qH=["uid","sequenceNumber"],HH=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],GH=["indexId","uid","orderedDocumentKey"],zH=["userId","collectionPath","documentId"],WH=["userId","collectionPath","largestBatchId"],KH=["userId","collectionGroup","largestBatchId"],QR=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],QH=[...QR,"documentOverlays"],YR=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],ZR=YR,YH=[...ZR,"indexConfiguration","indexState","indexEntries"];var _c=class extends af{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function Ke(t,e){let n=b(t);return pr.M(n.ae,e)}function zM(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ps(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function XR(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var _e=class t{constructor(e,n){this.comparator=e,this.root=n||Vn.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Vn.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Po(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Po(this.root,e,this.comparator,!1)}getReverseIterator(){return new Po(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Po(this.root,e,this.comparator,!0)}},Po=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Vn=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw A();let e=this.left.check();if(e!==this.right.check())throw A();return e+(this.isRed()?0:1)}};Vn.EMPTY=null,Vn.RED=!0,Vn.BLACK=!1;Vn.EMPTY=new class{constructor(){this.size=0}get key(){throw A()}get value(){throw A()}get color(){throw A()}get left(){throw A()}get right(){throw A()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Vn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var pe=class t{constructor(e){this.comparator=e,this.data=new _e(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new cf(this.data.getIterator())}getIteratorFrom(e){return new cf(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},cf=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Co(t){return t.hasNext()?t.getNext():void 0}var Nt=class t{constructor(e){this.fields=e,e.sort(Re.comparator)}static empty(){return new t([])}unionWith(e){let n=new pe(Re.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Vo(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var lf=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function JR(){return typeof atob<"u"}var We=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new lf("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return G(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};We.EMPTY_BYTE_STRING=new We("");var ZH=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qr(t){if(N(!!t),typeof t=="string"){let e=0,n=ZH.exec(t);if(N(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:be(t.seconds),nanos:be(t.nanos)}}function be(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Yr(t){return typeof t=="string"?We.fromBase64String(t):We.fromUint8Array(t)}function ep(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function ME(t){let e=t.mapValue.fields.__previous_value__;return ep(e)?ME(e):e}function wc(t){let e=Qr(t.mapValue.fields.__local_write_time__.timestampValue);return new De(e.seconds,e.nanos)}var $_=class{constructor(e,n,r,i,s,o,a,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}},Zr=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var zr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Xh={nullValue:"NULL_VALUE"};function rs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ep(t)?4:eN(t)?9007199254740991:10:A()}function Bn(t,e){if(t===e)return!0;let n=rs(t);if(n!==rs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return wc(t).isEqual(wc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Qr(i.timestampValue),a=Qr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Yr(i.bytesValue).isEqual(Yr(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return be(i.geoPointValue.latitude)===be(s.geoPointValue.latitude)&&be(i.geoPointValue.longitude)===be(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return be(i.integerValue)===be(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=be(i.doubleValue),a=be(s.doubleValue);return o===a?vc(o)===vc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Vo(t.arrayValue.values||[],e.arrayValue.values||[],Bn);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(zM(o)!==zM(a))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!Bn(o[u],a[u])))return!1;return!0}(t,e);default:return A()}}function Ec(t,e){return(t.values||[]).find(n=>Bn(n,e))!==void 0}function Xr(t,e){if(t===e)return 0;let n=rs(t),r=rs(e);if(n!==r)return G(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return G(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=be(s.integerValue||s.doubleValue),u=be(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return WM(t.timestampValue,e.timestampValue);case 4:return WM(wc(t),wc(e));case 5:return G(t.stringValue,e.stringValue);case 6:return function(s,o){let a=Yr(s),u=Yr(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){let l=G(a[c],u[c]);if(l!==0)return l}return G(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=G(be(s.latitude),be(o.latitude));return a!==0?a:G(be(s.longitude),be(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],u=o.values||[];for(let c=0;c<a.length&&c<u.length;++c){let l=Xr(a[c],u[c]);if(l)return l}return G(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===zr.mapValue&&o===zr.mapValue)return 0;if(s===zr.mapValue)return 1;if(o===zr.mapValue)return-1;let a=s.fields||{},u=Object.keys(a),c=o.fields||{},l=Object.keys(c);u.sort(),l.sort();for(let d=0;d<u.length&&d<l.length;++d){let h=G(u[d],l[d]);if(h!==0)return h;let f=Xr(a[u[d]],c[l[d]]);if(f!==0)return f}return G(u.length,l.length)}(t.mapValue,e.mapValue);default:throw A()}}function WM(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return G(t,e);let n=Qr(t),r=Qr(e),i=G(n.seconds,r.seconds);return i!==0?i:G(n.nanos,r.nanos)}function jo(t){return q_(t)}function q_(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Qr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Yr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return D.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=q_(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${q_(n.fields[o])}`;return i+"}"}(t.mapValue):A()}function is(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function H_(t){return!!t&&"integerValue"in t}function Ic(t){return!!t&&"arrayValue"in t}function KM(t){return!!t&&"nullValue"in t}function QM(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Jh(t){return!!t&&"mapValue"in t}function hc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return ps(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=hc(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=hc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function eN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function XH(t){return"nullValue"in t?Xh:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?is(Zr.empty(),D.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:A()}function JH(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?is(Zr.empty(),D.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?zr:A()}function YM(t,e){let n=Xr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function ZM(t,e){let n=Xr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var ot=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Jh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=hc(n)}setAll(e){let n=Re.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=hc(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Jh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Bn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Jh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ps(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(hc(this.value))}};function tN(t){let e=[];return ps(t.fields,(n,r)=>{let i=new Re([n]);if(Jh(r)){let s=tN(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Nt(e)}var Be=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,O.min(),O.min(),O.min(),ot.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,O.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,O.min(),O.min(),ot.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,O.min(),O.min(),ot.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(O.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ot.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ot.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=O.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Un=class{constructor(e,n){this.position=e,this.inclusive=n}};function XM(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=D.comparator(D.fromName(o.referenceValue),n.key):r=Xr(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function JM(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Bn(t.position[n],e.position[n]))return!1;return!0}var ss=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function e4(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var df=class{},J=class t extends df{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new W_(e,n,r):n==="array-contains"?new Y_(e,r):n==="in"?new hf(e,r):n==="not-in"?new Z_(e,r):n==="array-contains-any"?new X_(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new K_(e,r):new Q_(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Xr(n,this.value)):n!==null&&rs(this.value)===rs(n)&&this.matchesComparison(Xr(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return A()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},de=class t extends df{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return Bo(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function Bo(t){return t.op==="and"}function G_(t){return t.op==="or"}function RE(t){return nN(t)&&Bo(t)}function nN(t){for(let e of t.filters)if(e instanceof de)return!1;return!0}function z_(t){if(t instanceof J)return t.field.canonicalString()+t.op.toString()+jo(t.value);if(RE(t))return t.filters.map(e=>z_(e)).join(",");{let e=t.filters.map(n=>z_(n)).join(",");return`${t.op}(${e})`}}function rN(t,e){return t instanceof J?function(r,i){return i instanceof J&&r.op===i.op&&r.field.isEqual(i.field)&&Bn(r.value,i.value)}(t,e):t instanceof de?function(r,i){return i instanceof de&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&rN(o,i.filters[a]),!0):!1}(t,e):void A()}function iN(t,e){let n=t.filters.concat(e);return de.create(n,t.op)}function sN(t){return t instanceof J?function(n){return`${n.field.canonicalString()} ${n.op} ${jo(n.value)}`}(t):t instanceof de?function(n){return n.op.toString()+" {"+n.getFilters().map(sN).join(" ,")+"}"}(t):"Filter"}var W_=class extends J{constructor(e,n,r){super(e,n,r),this.key=D.fromName(r.referenceValue)}matches(e){let n=D.comparator(e.key,this.key);return this.matchesComparison(n)}},K_=class extends J{constructor(e,n){super(e,"in",n),this.keys=oN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},Q_=class extends J{constructor(e,n){super(e,"not-in",n),this.keys=oN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function oN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>D.fromName(r.referenceValue))}var Y_=class extends J{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return Ic(n)&&Ec(n.arrayValue,this.value)}},hf=class extends J{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Ec(this.value.arrayValue,n)}},Z_=class extends J{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ec(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Ec(this.value.arrayValue,n)}},X_=class extends J{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!Ic(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ec(this.value.arrayValue,r))}};var J_=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function ew(t,e=null,n=[],r=[],i=null,s=null,o=null){return new J_(t,e,n,r,i,s,o)}function os(t){let e=b(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>z_(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Bc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>jo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>jo(r)).join(",")),e.ce=n}return e.ce}function Uc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!e4(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!rN(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!JM(t.startAt,e.startAt)&&JM(t.endAt,e.endAt)}function ff(t){return D.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function pf(t,e){return t.filters.filter(n=>n instanceof J&&n.field.isEqual(e))}function eR(t,e,n){let r=Xh,i=!0;for(let s of pf(t,e)){let o=Xh,a=!0;switch(s.op){case"<":case"<=":o=XH(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Xh}YM({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];YM({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function tR(t,e,n){let r=zr,i=!0;for(let s of pf(t,e)){let o=zr,a=!0;switch(s.op){case">=":case">":o=JH(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=zr}ZM({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];ZM({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var hn=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function aN(t,e,n,r,i,s,o,a){return new hn(t,e,n,r,i,s,o,a)}function ea(t){return new hn(t)}function nR(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function NE(t){return t.collectionGroup!==null}function ko(t){let e=b(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new pe(Re.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new ss(s,r))}),n.has(Re.keyField().canonicalString())||e.le.push(new ss(Re.keyField(),r))}return e.le}function ht(t){let e=b(t);return e.he||(e.he=t4(e,ko(t))),e.he}function t4(t,e){if(t.limitType==="F")return ew(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new ss(i.field,s)});let n=t.endAt?new Un(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Un(t.startAt.position,t.startAt.inclusive):null;return ew(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function tw(t,e){let n=t.filters.concat([e]);return new hn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function gf(t,e,n){return new hn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function $c(t,e){return Uc(ht(t),ht(e))&&t.limitType===e.limitType}function uN(t){return`${os(ht(t))}|lt:${t.limitType}`}function xo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>sN(i)).join(", ")}]`),Bc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>jo(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>jo(i)).join(",")),`Target(${r})`}(ht(t))}; limitType=${t.limitType})`}function qc(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):D.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of ko(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){let c=XM(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,ko(r),i)||r.endAt&&!function(o,a,u){let c=XM(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,ko(r),i))}(t,e)}function cN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function lN(t){return(e,n)=>{let r=!1;for(let i of ko(t)){let s=n4(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function n4(t,e,n){let r=t.field.isKeyField()?D.comparator(e.key,n.key):function(s,o,a){let u=o.data.field(s),c=a.data.field(s);return u!==null&&c!==null?Xr(u,c):A()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return A()}}var $n=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ps(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return XR(this.inner)}size(){return this.innerSize}};var r4=new _e(D.comparator);function wt(){return r4}var dN=new _e(D.comparator);function lc(...t){let e=dN;for(let n of t)e=e.insert(n.key,n);return e}function hN(t){let e=dN;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Fn(){return fc()}function fN(){return fc()}function fc(){return new $n(t=>t.toString(),(t,e)=>t.isEqual(e))}var i4=new _e(D.comparator),s4=new pe(D.comparator);function W(...t){let e=s4;for(let n of t)e=e.add(n);return e}var o4=new pe(G);function PE(){return o4}function pN(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vc(e)?"-0":e}}function gN(t){return{integerValue:""+t}}function mN(t,e){return WR(e)?gN(e):pN(t,e)}var Uo=class{constructor(){this._=void 0}};function a4(t,e,n){return t instanceof Jr?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ep(s)&&(s=ME(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof gr?vN(t,e):t instanceof mr?_N(t,e):function(i,s){let o=yN(i,s),a=rR(o)+rR(i.Ie);return H_(o)&&H_(i.Ie)?gN(a):pN(i.serializer,a)}(t,e)}function u4(t,e,n){return t instanceof gr?vN(t,e):t instanceof mr?_N(t,e):n}function yN(t,e){return t instanceof ei?function(r){return H_(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Jr=class extends Uo{},gr=class extends Uo{constructor(e){super(),this.elements=e}};function vN(t,e){let n=wN(e);for(let r of t.elements)n.some(i=>Bn(i,r))||n.push(r);return{arrayValue:{values:n}}}var mr=class extends Uo{constructor(e){super(),this.elements=e}};function _N(t,e){let n=wN(e);for(let r of t.elements)n=n.filter(i=>!Bn(i,r));return{arrayValue:{values:n}}}var ei=class extends Uo{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function rR(t){return be(t.integerValue||t.doubleValue)}function wN(t){return Ic(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var as=class{constructor(e,n){this.field=e,this.transform=n}};function c4(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof gr&&i instanceof gr||r instanceof mr&&i instanceof mr?Vo(r.elements,i.elements,Bn):r instanceof ei&&i instanceof ei?Bn(r.Ie,i.Ie):r instanceof Jr&&i instanceof Jr}(t.transform,e.transform)}var nw=class{constructor(e,n){this.version=e,this.transformResults=n}},Te=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function ef(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var $o=class{};function EN(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ni(t.key,Te.none()):new ti(t.key,t.data,Te.none());{let n=t.data,r=ot.empty(),i=new pe(Re.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new fn(t.key,r,new Nt(i.toArray()),Te.none())}}function l4(t,e,n){t instanceof ti?function(i,s,o){let a=i.value.clone(),u=sR(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof fn?function(i,s,o){if(!ef(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=sR(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(IN(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function pc(t,e,n,r){return t instanceof ti?function(s,o,a,u){if(!ef(s.precondition,o))return a;let c=s.value.clone(),l=oR(s.fieldTransforms,u,o);return c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof fn?function(s,o,a,u){if(!ef(s.precondition,o))return a;let c=oR(s.fieldTransforms,u,o),l=o.data;return l.setAll(IN(s)),l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return ef(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function d4(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=yN(r.transform,i||null);s!=null&&(n===null&&(n=ot.empty()),n.set(r.field,s))}return n||null}function iR(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Vo(r,i,(s,o)=>c4(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var ti=class extends $o{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},fn=class extends $o{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function IN(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function sR(t,e,n){let r=new Map;N(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,u4(o,a,n[i]))}return r}function oR(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,a4(s,o,e))}return r}var ni=class extends $o{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Dc=class extends $o{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Cc=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&l4(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=pc(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=pc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=fN();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let u=EN(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(O.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),W())}isEqual(e){return this.batchId===e.batchId&&Vo(this.mutations,e.mutations,(n,r)=>iR(n,r))&&Vo(this.baseMutations,e.baseMutations,(n,r)=>iR(n,r))}},rw=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){N(e.mutations.length===r.length);let i=function(){return i4}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var bc=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var iw=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var Fe,te;function DN(t){switch(t){default:return A();case g.CANCELLED:case g.UNKNOWN:case g.DEADLINE_EXCEEDED:case g.RESOURCE_EXHAUSTED:case g.INTERNAL:case g.UNAVAILABLE:case g.UNAUTHENTICATED:return!1;case g.INVALID_ARGUMENT:case g.NOT_FOUND:case g.ALREADY_EXISTS:case g.PERMISSION_DENIED:case g.FAILED_PRECONDITION:case g.ABORTED:case g.OUT_OF_RANGE:case g.UNIMPLEMENTED:case g.DATA_LOSS:return!0}}function CN(t){if(t===void 0)return Me("GRPC error has no .code"),g.UNKNOWN;switch(t){case Fe.OK:return g.OK;case Fe.CANCELLED:return g.CANCELLED;case Fe.UNKNOWN:return g.UNKNOWN;case Fe.DEADLINE_EXCEEDED:return g.DEADLINE_EXCEEDED;case Fe.RESOURCE_EXHAUSTED:return g.RESOURCE_EXHAUSTED;case Fe.INTERNAL:return g.INTERNAL;case Fe.UNAVAILABLE:return g.UNAVAILABLE;case Fe.UNAUTHENTICATED:return g.UNAUTHENTICATED;case Fe.INVALID_ARGUMENT:return g.INVALID_ARGUMENT;case Fe.NOT_FOUND:return g.NOT_FOUND;case Fe.ALREADY_EXISTS:return g.ALREADY_EXISTS;case Fe.PERMISSION_DENIED:return g.PERMISSION_DENIED;case Fe.FAILED_PRECONDITION:return g.FAILED_PRECONDITION;case Fe.ABORTED:return g.ABORTED;case Fe.OUT_OF_RANGE:return g.OUT_OF_RANGE;case Fe.UNIMPLEMENTED:return g.UNIMPLEMENTED;case Fe.DATA_LOSS:return g.DATA_LOSS;default:return A()}}(te=Fe||(Fe={}))[te.OK=0]="OK",te[te.CANCELLED=1]="CANCELLED",te[te.UNKNOWN=2]="UNKNOWN",te[te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",te[te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",te[te.NOT_FOUND=5]="NOT_FOUND",te[te.ALREADY_EXISTS=6]="ALREADY_EXISTS",te[te.PERMISSION_DENIED=7]="PERMISSION_DENIED",te[te.UNAUTHENTICATED=16]="UNAUTHENTICATED",te[te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",te[te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",te[te.ABORTED=10]="ABORTED",te[te.OUT_OF_RANGE=11]="OUT_OF_RANGE",te[te.UNIMPLEMENTED=12]="UNIMPLEMENTED",te[te.INTERNAL=13]="INTERNAL",te[te.UNAVAILABLE=14]="UNAVAILABLE",te[te.DATA_LOSS=15]="DATA_LOSS";var aR=null;function bN(){return new TextEncoder}var h4=new Ki([4294967295,4294967295],0);function uR(t){let e=bN().encode(t),n=new UM;return n.update(e),new Uint8Array(n.digest())}function cR(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ki([n,r],0),new Ki([i,s],0)]}var sw=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ts(`Invalid padding: ${n}`);if(r<0)throw new ts(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ts(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ts(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Ki.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Ki.fromNumber(r)));return i.compare(h4)===1&&(i=new Ki([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=uR(e),[r,i]=cR(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=uR(e),[r,i]=cR(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},ts=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Tc=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,Sc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(O.min(),i,new _e(G),wt(),W())}},Sc=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,W(),W(),W())}};var Fo=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},mf=class{constructor(e,n){this.targetId=e,this.fe=n}},yf=class{constructor(e,n,r=We.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},vf=class{constructor(){this.ge=0,this.pe=dR(),this.ye=We.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=W(),n=W(),r=W();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:A()}}),new Sc(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=dR()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,N(this.ge>=0)}Be(){this.Se=!0,this.we=!0}},ow=class{constructor(e){this.Le=e,this.ke=new Map,this.qe=wt(),this.Qe=lR(),this.Ke=new _e(G)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:A()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(ff(s))if(r===0){let o=new D(s.path);this.We(n,o,Be.newNoDocument(o,O.min()))}else N(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),u=a?this.et(a,e,o):1;if(u!==0){this.He(n);let c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,c)}aR?.tt(function(l,d,h,f,m){var v,_,I,M,T,F;let B={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},z=d.unchangedNames;return z&&(B.bloomFilter={applied:m===0,hashCount:(v=z?.hashCount)!==null&&v!==void 0?v:0,bitmapLength:(M=(I=(_=z?.bits)===null||_===void 0?void 0:_.bitmap)===null||I===void 0?void 0:I.length)!==null&&M!==void 0?M:0,padding:(F=(T=z?.bits)===null||T===void 0?void 0:T.padding)!==null&&F!==void 0?F:0,mightContain:we=>{var Pt;return(Pt=f?.mightContain(we))!==null&&Pt!==void 0&&Pt}}),B}(o,e.fe,this.Le.nt(),a,u))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=Yr(r).toUint8Array()}catch(u){if(u instanceof lf)return Kt("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new sw(o,i,s)}catch(u){return Kt(u instanceof ts?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&ff(a.target)){let u=new D(a.target.path);this.qe.get(u)!==null||this.st(o,u)||this.We(o,u,Be.newNoDocument(u,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=W();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{let c=this.Ye(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new Tc(e,n,this.Ke,this.qe,r);return this.qe=wt(),this.Qe=lR(),this.Ke=new _e(G),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new vf,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new pe(G),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||E("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new vf),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function lR(){return new _e(D.comparator)}function dR(){return new _e(D.comparator)}var f4={asc:"ASCENDING",desc:"DESCENDING"},p4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},g4={and:"AND",or:"OR"},aw=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function uw(t,e){return t.useProto3Json||Bc(e)?e:{value:e}}function qo(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function TN(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function m4(t,e){return qo(t,e.toTimestamp())}function Ne(t){return N(!!t),O.fromTimestamp(function(n){let r=Qr(n);return new De(r.seconds,r.nanos)}(t))}function OE(t,e){return cw(t,e).canonicalString()}function cw(t,e){let n=function(i){return new ne(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function SN(t){let e=ne.fromString(t);return N(VN(e)),e}function Ac(t,e){return OE(t.databaseId,e.path)}function Ln(t,e){let n=SN(e);if(n.get(1)!==t.databaseId.projectId)throw new w(g.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new w(g.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new D(MN(n))}function AN(t,e){return OE(t.databaseId,e)}function xN(t){let e=SN(t);return e.length===4?ne.emptyPath():MN(e)}function lw(t){return new ne(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function MN(t){return N(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function hR(t,e,n){return{name:Ac(t,e),fields:n.value.mapValue.fields}}function RN(t,e,n){let r=Ln(t,e.name),i=Ne(e.updateTime),s=e.createTime?Ne(e.createTime):O.min(),o=new ot({mapValue:{fields:e.fields}}),a=Be.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function y4(t,e){return"found"in e?function(r,i){N(!!i.found),i.found.name,i.found.updateTime;let s=Ln(r,i.found.name),o=Ne(i.found.updateTime),a=i.found.createTime?Ne(i.found.createTime):O.min(),u=new ot({mapValue:{fields:i.found.fields}});return Be.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){N(!!i.missing),N(!!i.readTime);let s=Ln(r,i.missing),o=Ne(i.readTime);return Be.newNoDocument(s,o)}(t,e):A()}function v4(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:A()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?(N(l===void 0||typeof l=="string"),We.fromBase64String(l||"")):(N(l===void 0||l instanceof Uint8Array),We.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){let l=c.code===void 0?g.UNKNOWN:CN(c.code);return new w(l,c.message||"")}(o);n=new yf(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Ln(t,r.document.name),s=Ne(r.document.updateTime),o=r.document.createTime?Ne(r.document.createTime):O.min(),a=new ot({mapValue:{fields:r.document.fields}}),u=Be.newFoundDocument(i,s,o,a),c=r.targetIds||[],l=r.removedTargetIds||[];n=new Fo(c,l,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Ln(t,r.document),s=r.readTime?Ne(r.readTime):O.min(),o=Be.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Fo([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Ln(t,r.document),s=r.removedTargetIds||[];n=new Fo([],s,i,null)}else{if(!("filter"in e))return A();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new iw(i,s),a=r.targetId;n=new mf(a,o)}}return n}function xc(t,e){let n;if(e instanceof ti)n={update:hR(t,e.key,e.value)};else if(e instanceof ni)n={delete:Ac(t,e.key)};else if(e instanceof fn)n={update:hR(t,e.key,e.data),updateMask:C4(e.fieldMask)};else{if(!(e instanceof Dc))return A();n={verify:Ac(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Jr)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof gr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof mr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ei)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw A()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:m4(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:A()}(t,e.precondition)),n}function dw(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?Te.updateTime(Ne(s.updateTime)):s.exists!==void 0?Te.exists(s.exists):Te.none()}(e.currentDocument):Te.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)N(a.setToServerValue==="REQUEST_TIME"),u=new Jr;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];u=new gr(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];u=new mr(l)}else"increment"in a?u=new ei(o,a.increment):A();let c=Re.fromServerFormat(a.fieldPath);return new as(c,u)}(t,i)):[];if(e.update){e.update.name;let i=Ln(t,e.update.name),s=new ot({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(u){let c=u.fieldPaths||[];return new Nt(c.map(l=>Re.fromServerFormat(l)))}(e.updateMask);return new fn(i,s,o,n,r)}return new ti(i,s,n,r)}if(e.delete){let i=Ln(t,e.delete);return new ni(i,n)}if(e.verify){let i=Ln(t,e.verify);return new Dc(i,n)}return A()}function _4(t,e){return t&&t.length>0?(N(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Ne(i.updateTime):Ne(s);return o.isEqual(O.min())&&(o=Ne(s)),new nw(o,i.transformResults||[])}(n,e))):[]}function NN(t,e){return{documents:[AN(t,e.path)]}}function PN(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=AN(t,i);let s=function(c){if(c.length!==0)return FN(de.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(c){if(c.length!==0)return c.map(l=>function(h){return{field:Mo(h.field),direction:E4(h.dir)}}(l))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=uw(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ut:n,parent:i}}function ON(t){let e=xN(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){N(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=kN(d);return h instanceof de&&RE(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(m){return new ss(Ro(m.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,Bc(h)?null:h}(n.limit));let u=null;n.startAt&&(u=function(d){let h=!!d.before,f=d.values||[];return new Un(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){let h=!d.before,f=d.values||[];return new Un(f,h)}(n.endAt)),aN(e,i,o,s,a,"F",u,c)}function w4(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return A()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function kN(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Ro(n.unaryFilter.field);return J.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Ro(n.unaryFilter.field);return J.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Ro(n.unaryFilter.field);return J.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Ro(n.unaryFilter.field);return J.create(o,"!=",{nullValue:"NULL_VALUE"});default:return A()}}(t):t.fieldFilter!==void 0?function(n){return J.create(Ro(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return A()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return de.create(n.compositeFilter.filters.map(r=>kN(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return A()}}(n.compositeFilter.op))}(t):A()}function E4(t){return f4[t]}function I4(t){return p4[t]}function D4(t){return g4[t]}function Mo(t){return{fieldPath:t.canonicalString()}}function Ro(t){return Re.fromServerFormat(t.fieldPath)}function FN(t){return t instanceof J?function(n){if(n.op==="=="){if(QM(n.value))return{unaryFilter:{field:Mo(n.field),op:"IS_NAN"}};if(KM(n.value))return{unaryFilter:{field:Mo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(QM(n.value))return{unaryFilter:{field:Mo(n.field),op:"IS_NOT_NAN"}};if(KM(n.value))return{unaryFilter:{field:Mo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mo(n.field),op:I4(n.op),value:n.value}}}(t):t instanceof de?function(n){let r=n.getFilters().map(i=>FN(i));return r.length===1?r[0]:{compositeFilter:{op:D4(n.op),filters:r}}}(t):A()}function C4(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function VN(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Ho=class t{constructor(e,n,r,i,s=O.min(),o=O.min(),a=We.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var _f=class{constructor(e){this.ct=e}};function b4(t,e){let n;if(e.document)n=RN(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=D.fromSegments(e.noDocument.path),i=cs(e.noDocument.readTime);n=Be.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return A();{let r=D.fromSegments(e.unknownDocument.path),i=cs(e.unknownDocument.version);n=Be.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new De(i[0],i[1]);return O.fromTimestamp(s)}(e.readTime)),n}function fR(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:wf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Ac(s,o.key),fields:o.data.value.mapValue.fields,updateTime:qo(s,o.version.toTimestamp()),createTime:qo(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:us(e.version)};else{if(!e.isUnknownDocument())return A();r.unknownDocument={path:n.path.toArray(),version:us(e.version)}}return r}function wf(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function us(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function cs(t){let e=new De(t.seconds,t.nanoseconds);return O.fromTimestamp(e)}function Xi(t,e){let n=(e.baseMutations||[]).map(s=>dw(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>dw(t.ct,s)),i=De.fromMillis(e.localWriteTimeMs);return new Cc(e.batchId,i,n,r)}function dc(t){let e=cs(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?cs(t.lastLimboFreeSnapshotVersion):O.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return N(s.documents.length===1),ht(ea(xN(s.documents[0])))}(t.query):function(s){return ht(ON(s))}(t.query),new Ho(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,We.fromBase64String(t.resumeToken))}function LN(t,e){let n=us(e.snapshotVersion),r=us(e.lastLimboFreeSnapshotVersion),i;i=ff(e.target)?NN(t.ct,e.target):PN(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:os(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function kE(t){let e=ON({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?gf(e,e.limit,"L"):e}function T_(t,e){return new bc(e.largestBatchId,dw(t.ct,e.overlayMutation))}function pR(t,e){let n=e.path.lastSegment();return[t,dt(e.path.popLast()),n]}function gR(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:us(r.readTime),documentKey:dt(r.documentKey.path),largestBatchId:r.largestBatchId}}var hw=class{getBundleMetadata(e,n){return mR(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:cs(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return mR(e).put(function(i){return{bundleId:i.id,createTime:us(Ne(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return yR(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:kE(s.bundledQuery),readTime:cs(s.readTime)}}(r)})}saveNamedQuery(e,n){return yR(e).put(function(i){return{name:i.name,readTime:us(Ne(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function mR(t){return Ke(t,"bundles")}function yR(t){return Ke(t,"namedQueries")}var Ef=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return oc(e).get(pR(this.userId,n)).next(r=>r?T_(this.serializer,r):null)}getOverlays(e,n){let r=Fn();return p.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new bc(n,o);i.push(this.ht(e,a))}),p.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(dt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(oc(e).H("collectionPathOverlayIndex",a))}),p.waitFor(s)}getOverlaysForCollection(e,n,r){let i=Fn(),s=dt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return oc(e).W("collectionPathOverlayIndex",o).next(a=>{for(let u of a){let c=T_(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=Fn(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return oc(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,c,l)=>{let d=T_(this.serializer,c);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}ht(e,n){return oc(e).put(function(i,s,o){let[a,u,c]=pR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:xc(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function oc(t){return Ke(t,"documentOverlays")}var hr=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(be(e.integerValue));else if("doubleValue"in e){let r=be(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),vc(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(Yr(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?eN(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):A()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),D.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};hr.bt=new hr;function T4(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function vR(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=T4(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var fw=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Bt(e){let n=this.Lt(e),r=vR(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Lt(e),r=vR(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Lt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},pw=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Bt(e)}Tt(){this.Gt.Qt()}},gw=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},Ji=class{constructor(){this.Gt=new fw,this.zt=new pw(this.Gt),this.jt=new gw(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var es=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function $r(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=_R(t.arrayValue,e.arrayValue),n!==0?n:(n=_R(t.directionalValue,e.directionalValue),n!==0?n:D.comparator(t.documentKey,e.documentKey)))}function _R(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var If=class{constructor(e){this.Yt=new pe((n,r)=>Re.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(N(e.collectionGroup===this.collectionId),this.en)return!1;let n=V_(e);if(n!==void 0&&!this.nn(n))return!1;let r=Yi(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[s];if(!this.rn(a,u)||!this.sn(this.Zt[o++],u))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new pe(Re.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Oo(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Oo(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Oo(r.field,r.dir==="asc"?0:1)));return new Lo(Lo.UNKNOWN_ID,this.collectionId,n,yc.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function jN(t){var e,n;if(N(t instanceof J||t instanceof de),t instanceof J){if(t instanceof hf){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>J.create(t.field,"==",s)))||[];return de.create(i,"or")}return t}let r=t.filters.map(i=>jN(i));return de.create(r,t.op)}function S4(t){if(t.getFilters().length===0)return[];let e=vw(jN(t));return N(BN(e)),mw(e)||yw(e)?[e]:e.getFilters()}function mw(t){return t instanceof J}function yw(t){return t instanceof de&&RE(t)}function BN(t){return mw(t)||yw(t)||function(n){if(n instanceof de&&G_(n)){for(let r of n.getFilters())if(!mw(r)&&!yw(r))return!1;return!0}return!1}(t)}function vw(t){if(N(t instanceof J||t instanceof de),t instanceof J)return t;if(t.filters.length===1)return vw(t.filters[0]);let e=t.filters.map(r=>vw(r)),n=de.create(e,t.op);return n=Df(n),BN(n)?n:(N(n instanceof de),N(Bo(n)),N(n.filters.length>1),n.filters.reduce((r,i)=>FE(r,i)))}function FE(t,e){let n;return N(t instanceof J||t instanceof de),N(e instanceof J||e instanceof de),n=t instanceof J?e instanceof J?function(i,s){return de.create([i,s],"and")}(t,e):wR(t,e):e instanceof J?wR(e,t):function(i,s){if(N(i.filters.length>0&&s.filters.length>0),Bo(i)&&Bo(s))return iN(i,s.getFilters());let o=G_(i)?i:s,a=G_(i)?s:i,u=o.filters.map(c=>FE(c,a));return de.create(u,"or")}(t,e),Df(n)}function wR(t,e){if(Bo(e))return iN(e,t.getFilters());{let n=e.filters.map(r=>FE(t,r));return de.create(n,"or")}}function Df(t){if(N(t instanceof J||t instanceof de),t instanceof J)return t;let e=t.getFilters();if(e.length===1)return Df(e[0]);if(nN(t))return t;let n=e.map(i=>Df(i)),r=[];return n.forEach(i=>{i instanceof J?r.push(i):i instanceof de&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:de.create(r,t.op)}var _w=class{constructor(){this._n=new Mc}addToCollectionParentIndex(e,n){return this._n.add(n),p.resolve()}getCollectionParents(e,n){return p.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return p.resolve()}deleteFieldIndex(e,n){return p.resolve()}deleteAllFieldIndexes(e){return p.resolve()}createTargetIndexes(e,n){return p.resolve()}getDocumentsMatchingTarget(e,n){return p.resolve(null)}getIndexType(e,n){return p.resolve(0)}getFieldIndexes(e,n){return p.resolve([])}getNextCollectionGroupToUpdate(e){return p.resolve(null)}getMinOffset(e,n){return p.resolve(Qt.min())}getMinOffsetFromCollectionGroup(e,n){return p.resolve(Qt.min())}updateCollectionGroup(e,n,r){return p.resolve()}updateIndexEntries(e,n){return p.resolve()}},Mc=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new pe(ne.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new pe(ne.comparator)).toArray()}};var Wh=new Uint8Array(0),ww=class{constructor(e,n){this.databaseId=n,this.an=new Mc,this.un=new $n(r=>os(r),(r,i)=>Uc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:dt(i)};return ER(e).put(s)}return p.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[qR(n),""],!1,!0);return ER(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(kn(o.parent))}return r})}addFieldIndex(e,n){let r=ac(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=To(e);return s.next(a=>{o.put(gR(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=ac(e),i=To(e),s=bo(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=ac(e),r=bo(e),i=To(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return p.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new If(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=bo(e),i=!0,s=new Map;return p.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=W(),a=[];return p.forEach(s,(u,c)=>{E("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(F=>`${F.fieldPath}:${F.kind}`).join(",")}`}(u)} to execute ${os(n)}`);let l=function(T,F){let B=V_(F);if(B===void 0)return null;for(let z of pf(T,B.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null}(c,u),d=function(T,F){let B=new Map;for(let z of Yi(F))for(let we of pf(T,z.fieldPath))switch(we.op){case"==":case"in":B.set(z.fieldPath.canonicalString(),we.value);break;case"not-in":case"!=":return B.set(z.fieldPath.canonicalString(),we.value),Array.from(B.values())}return null}(c,u),h=function(T,F){let B=[],z=!0;for(let we of Yi(F)){let Pt=we.kind===0?eR(T,we.fieldPath,T.startAt):tR(T,we.fieldPath,T.startAt);B.push(Pt.value),z&&(z=Pt.inclusive)}return new Un(B,z)}(c,u),f=function(T,F){let B=[],z=!0;for(let we of Yi(F)){let Pt=we.kind===0?tR(T,we.fieldPath,T.endAt):eR(T,we.fieldPath,T.endAt);B.push(Pt.value),z&&(z=Pt.inclusive)}return new Un(B,z)}(c,u),m=this.hn(u,c,h),v=this.hn(u,c,f),_=this.Pn(u,c,d),I=this.In(u.indexId,l,m,h.inclusive,v,f.inclusive,_);return p.forEach(I,M=>r.j(M,n.limit).next(T=>{T.forEach(F=>{let B=D.fromSegments(F.documentKey);o.has(B)||(o=o.add(B),a.push(B))})}))}).next(()=>a)}return p.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=S4(de.create(e.filters,"and")).map(r=>ew(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let u=(n!=null?n.length:1)*Math.max(r.length,s.length),c=u/(n!=null?n.length:1),l=[];for(let d=0;d<u;++d){let h=n?this.Tn(n[d/c]):Wh,f=this.En(e,h,r[d%c],i),m=this.dn(e,h,s[d%c],o),v=a.map(_=>this.En(e,h,_,!0));l.push(...this.createRange(f,m,v))}return l}En(e,n,r,i){let s=new es(e,D.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new es(e,D.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new If(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return p.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new pe(Re.comparator),l=!1;for(let d of u.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:c=c.add(h.field));for(let d of u.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new Ji;for(let i of Yi(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);hr.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new Ji;return hr.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new Ji;return hr.bt.Pt(is(this.databaseId,n),r.Ht(function(s){let o=Yi(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new Ji);let s=0;for(let o of Yi(e)){let a=r[s++];for(let u of i)if(this.Vn(n,o.fieldPath)&&Ic(a))i=this.mn(i,o,a);else{let c=u.Ht(o.kind);hr.bt.Pt(a,c)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let u=new Ji;u.seed(a.Wt()),hr.bt.Pt(o,u.Ht(n.kind)),s.push(u)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof J&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=ac(e),i=To(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return p.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(l,d){let h=d?new yc(d.sequenceNumber,new Qt(cs(d.readTime),new D(kn(d.documentKey)),d.largestBatchId)):yc.empty(),f=l.fields.map(([m,v])=>new Oo(Re.fromServerFormat(m),v));return new Lo(l.indexId,l.collectionGroup,f,h)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:G(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=ac(e),s=To(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>p.forEach(a,u=>s.put(gR(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return p.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?p.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),p.forEach(a,u=>this.pn(e,i,u).next(c=>{let l=this.yn(s,u);return c.isEqual(l)?p.resolve():this.wn(e,s,u,c,l)}))))})}Sn(e,n,r,i){return bo(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return bo(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=bo(e),s=new pe($r);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new es(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new pe($r),i=this.An(n,e);if(i==null)return r;let s=V_(n);if(s!=null){let o=e.data.field(s.fieldPath);if(Ic(o))for(let a of o.arrayValue.values||[])r=r.add(new es(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new es(n.indexId,e.key,Wh,i));return r}wn(e,n,r,i,s){E("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(u,c,l,d,h){let f=u.getIterator(),m=c.getIterator(),v=Co(f),_=Co(m);for(;v||_;){let I=!1,M=!1;if(v&&_){let T=l(v,_);T<0?M=!0:T>0&&(I=!0)}else v!=null?M=!0:I=!0;I?(d(_),_=Co(m)):M?(h(v),v=Co(f)):(v=Co(f),_=Co(m))}}(i,s,$r,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),p.waitFor(o)}gn(e){let n=1;return To(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>$r(o,a)).filter((o,a,u)=>!a||$r(o,u[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=$r(o,e),u=$r(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&u<0)i.push(o),i.push(o.Jt());else if(u>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Wh,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Wh,[]];s.push(IDBKeyRange.bound(a,u))}return s}Dn(e,n){return $r(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(IR)}getMinOffset(e,n){return p.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||A())).next(IR)}};function ER(t){return Ke(t,"collectionParents")}function bo(t){return Ke(t,"indexEntries")}function ac(t){return Ke(t,"indexConfiguration")}function To(t){return Ke(t,"indexState")}function IR(t){N(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;AE(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Qt(e.readTime,e.documentKey,n)}var DR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Wt=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function UN(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,u=r.Y({range:o},(l,d,h)=>(a++,h.delete()));s.push(u.next(()=>{N(a===1)}));let c=[];for(let l of n.mutations){let d=KR(e,l.key.path,n.batchId);s.push(i.delete(d)),c.push(l.key)}return p.waitFor(s).next(()=>c)}function Cf(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw A();e=t.noDocument}return JSON.stringify(e).length}Wt.DEFAULT_COLLECTION_PERCENTILE=10,Wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Wt.DEFAULT=new Wt(41943040,Wt.DEFAULT_COLLECTION_PERCENTILE,Wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Wt.DISABLED=new Wt(-1,0,0);var bf=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){N(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return qr(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=No(e),o=qr(e);return o.add({}).next(a=>{N(typeof a=="number");let u=new Cc(a,n,r,i),c=function(f,m,v){let _=v.baseMutations.map(M=>xc(f.ct,M)),I=v.mutations.map(M=>xc(f.ct,M));return{userId:m,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:_,mutations:I}}(this.serializer,this.userId,u),l=[],d=new pe((h,f)=>G(h.canonicalString(),f.canonicalString()));for(let h of i){let f=KR(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(c)),l.push(s.put(f,OH))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=u.keys()}),p.waitFor(l).next(()=>u)})}lookupMutationBatch(e,n){return qr(e).get(n).next(r=>r?(N(r.userId===this.userId),Xi(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?p.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return qr(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(N(a.batchId>=r),s=Xi(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return qr(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return qr(e).W("userMutationsIndex",n).next(r=>r.map(i=>Xi(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=Zh(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return No(e).Y({range:i},(o,a,u)=>{let[c,l,d]=o,h=kn(l);if(c===this.userId&&n.path.isEqual(h))return qr(e).get(d).next(f=>{if(!f)throw A();N(f.userId===this.userId),s.push(Xi(this.serializer,f))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new pe(G),i=[];return n.forEach(s=>{let o=Zh(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=No(e).Y({range:a},(c,l,d)=>{let[h,f,m]=c,v=kn(f);h===this.userId&&s.path.isEqual(v)?r=r.add(m):d.done()});i.push(u)}),p.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=Zh(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new pe(G);return No(e).Y({range:o},(u,c,l)=>{let[d,h,f]=u,m=kn(h);d===this.userId&&r.isPrefixOf(m)?m.length===i&&(a=a.add(f)):l.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(qr(e).get(s).next(o=>{if(o===null)throw A();N(o.userId===this.userId),r.push(Xi(this.serializer,o))}))}),p.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return UN(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),p.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return p.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return No(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let u=kn(s[1]);i.push(u)}else a.done()}).next(()=>{N(i.length===0)})})}containsKey(e,n){return $N(e,this.userId,n)}xn(e){return qN(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function $N(t,e,n){let r=Zh(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return No(t).Y({range:s,J:!0},(a,u,c)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),c.done()}).next(()=>o)}function qr(t){return Ke(t,"mutations")}function No(t){return Ke(t,"documentMutations")}function qN(t){return Ke(t,"mutationQueues")}var Go=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Bn(){return new t(-1)}};var Ew=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Ln(e).next(n=>{let r=new Go(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(n=>O.fromTimestamp(new De(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ln(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Ln(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>So(e).delete(n.targetId)).next(()=>this.Ln(e)).next(r=>(N(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return So(e).Y((o,a)=>{let u=dc(a);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>p.waitFor(s)).next(()=>i)}forEachTarget(e,n){return So(e).Y((r,i)=>{let s=dc(i);n(s)})}Ln(e){return CR(e).get("targetGlobalKey").next(n=>(N(n!==null),n))}kn(e,n){return CR(e).put("targetGlobalKey",n)}qn(e,n){return So(e).put(LN(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ln(e).next(n=>n.targetCount)}getTargetData(e,n){let r=os(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return So(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{let c=dc(a);Uc(n,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=Hr(e);return n.forEach(o=>{let a=dt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),p.waitFor(i)}removeMatchingKeys(e,n,r){let i=Hr(e);return p.forEach(n,s=>{let o=dt(s.path);return p.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=Hr(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Hr(e),s=W();return i.Y({range:r,J:!0},(o,a,u)=>{let c=kn(o[1]),l=new D(c);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=dt(n.path),i=IDBKeyRange.bound([r],[qR(r)],!1,!0),s=0;return Hr(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}_t(e,n){return So(e).get(n).next(r=>r?dc(r):null)}};function So(t){return Ke(t,"targets")}function CR(t){return Ke(t,"targetGlobal")}function Hr(t){return Ke(t,"targetDocuments")}function bR([t,e],[n,r]){let i=G(t,n);return i===0?G(e,r):i}var Iw=class{constructor(e){this.Kn=e,this.buffer=new pe(bR),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();bR(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},Dw=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){E("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>y(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){si(n)?E("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield ii(n)}yield this.zn(3e5)}))}},Cw=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return p.resolve(Rt._e);let r=new Iw(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(E("LruGarbageCollector","Garbage collection skipped; disabled"),p.resolve(DR)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(E("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),DR):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,u,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(E("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),Ao()<=mn.DEBUG&&E("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${d} documents in `+(c-u)+`ms
Total Duration: ${c-l}ms`),p.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function A4(t,e){return new Cw(t,e)}var bw=class{constructor(e,n){this.db=e,this.garbageCollector=A4(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return Kh(e,r)}removeReference(e,n,r){return Kh(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Kh(e,n)}er(e,n){return function(i,s){let o=!1;return qN(i).Z(a=>$N(i,a,s).next(u=>(u&&(o=!0),p.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let u=this.er(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,O.min()),Hr(e).delete(function(d){return[0,dt(d.path)]}(o))))});i.push(u)}}).next(()=>p.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Kh(e,n)}Xn(e,n){let r=Hr(e),i,s=Rt._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(s!==Rt._e&&n(new D(kn(i)),s),s=c,i=u):s=Rt._e}).next(()=>{s!==Rt._e&&n(new D(kn(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Kh(t,e){return Hr(t).put(function(r,i){return{targetId:0,path:dt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var Tf=class{constructor(){this.changes=new $n(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Be.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?p.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Tw=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Qi(e).put(r)}removeEntry(e,n,r){return Qi(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],wf(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=Be.newInvalidDocument(n);return Qi(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(uc(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:Be.newInvalidDocument(n)};return Qi(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(uc(n))},(i,s)=>{r={document:this.nr(n,s),size:Cf(s)}}).next(()=>r)}getEntries(e,n){let r=wt();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=wt(),i=new _e(D.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,Cf(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return p.resolve();let i=new pe(AR);n.forEach(u=>i=i.add(u));let s=IDBKeyRange.bound(uc(i.first()),uc(i.last())),o=i.getIterator(),a=o.getNext();return Qi(e).Y({index:"documentKeyIndex",range:s},(u,c,l)=>{let d=D.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&AR(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?l.U(uc(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),wf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Qi(e).W(IDBKeyRange.bound(a,u,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let l=wt();for(let d of c){let h=this.nr(D.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(qc(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=wt(),o=SR(n,r),a=SR(n,Qt.max());return Qi(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,l)=>{let d=this.nr(D.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new Sw(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return TR(e).get("remoteDocumentGlobalKey").next(n=>(N(!!n),n))}tr(e,n){return TR(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=b4(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(O.min())))return r}return Be.newInvalidDocument(e)}};function HN(t){return new Tw(t)}var Sw=class extends Tf{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new $n(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new pe((s,o)=>G(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let u=fR(this.ar.serializer,o);i=i.add(s.path.popLast());let c=Cf(u);r+=c-a.size,n.push(this.ar.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){let u=fR(this.ar.serializer,o.convertToNoDocument(O.min()));n.push(this.ar.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),p.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function TR(t){return Ke(t,"remoteDocumentGlobal")}function Qi(t){return Ke(t,"remoteDocumentsV14")}function uc(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function SR(t,e){let n=e.documentKey.path.toArray();return[t,wf(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function AR(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=G(n[s],r[s]),i)return i;return i=G(n.length,r.length),i||(i=G(n[n.length-2],r[r.length-2]),i||G(n[n.length-1],r[r.length-1]))}var Aw=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var Sf=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&pc(r.mutation,i,Nt.empty(),De.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,W()).next(()=>r))}getLocalViewOfDocuments(e,n,r=W()){let i=Fn();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=lc();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=Fn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,W()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=wt(),o=fc(),a=function(){return fc()}();return n.forEach((u,c)=>{let l=r.get(c.key);i.has(c.key)&&(l===void 0||l.mutation instanceof fn)?s=s.insert(c.key,c):l!==void 0?(o.set(c.key,l.mutation.getFieldMask()),pc(l.mutation,c,l.mutation.getFieldMask(),De.now())):o.set(c.key,Nt.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,l)=>o.set(c,l)),n.forEach((c,l)=>{var d;return a.set(c,new Aw(l,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=fc(),i=new _e((o,a)=>o-a),s=W();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(u=>{let c=n.get(u);if(c===null)return;let l=r.get(u)||Nt.empty();l=a.applyToLocalView(c,l),r.set(u,l);let d=(i.get(a.batchId)||W()).add(u);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),c=u.key,l=u.value,d=fN();l.forEach(h=>{if(!s.has(h)){let f=EN(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return p.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return D.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):NE(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):p.resolve(Fn()),a=-1,u=s;return o.next(c=>p.forEach(c,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?p.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{u=u.insert(l,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,W())).next(l=>({batchId:a,changes:hN(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new D(n)).next(r=>{let i=lc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=lc();return this.indexManager.getCollectionParents(e,s).next(a=>p.forEach(a,u=>{let c=function(d,h){return new hn(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,c)=>{let l=c.getKey();o.get(l)===null&&(o=o.insert(l,Be.newInvalidDocument(l)))});let a=lc();return o.forEach((u,c)=>{let l=s.get(u);l!==void 0&&pc(l.mutation,c,Nt.empty(),De.now()),qc(n,c)&&(a=a.insert(u,c))}),a})}};var xw=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return p.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ne(i.createTime)}}(n)),p.resolve()}getNamedQuery(e,n){return p.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:kE(i.bundledQuery),readTime:Ne(i.readTime)}}(n)),p.resolve()}};var Mw=class{constructor(){this.overlays=new _e(D.comparator),this.hr=new Map}getOverlay(e,n){return p.resolve(this.overlays.get(n))}getOverlays(e,n){let r=Fn();return p.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),p.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),p.resolve()}getOverlaysForCollection(e,n,r){let i=Fn(),s=n.length+1,o=new D(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return p.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new _e((c,l)=>c-l),o=this.overlays.getIterator();for(;o.hasNext();){let c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let l=s.get(c.largestBatchId);l===null&&(l=Fn(),s=s.insert(c.largestBatchId,l)),l.set(c.getKey(),c)}}let a=Fn(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,l)=>a.set(c,l)),!(a.size()>=i)););return p.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new bc(n,r));let s=this.hr.get(n);s===void 0&&(s=W(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var Rc=class{constructor(){this.Pr=new pe(Ve.Ir),this.Tr=new pe(Ve.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new Ve(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new Ve(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new D(new ne([])),r=new Ve(n,e),i=new Ve(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new D(new ne([])),r=new Ve(n,e),i=new Ve(n,e+1),s=W();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new Ve(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},Ve=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return D.comparator(e.key,n.key)||G(e.pr,n.pr)}static Er(e,n){return G(e.pr,n.pr)||D.comparator(e.key,n.key)}};var Rw=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new pe(Ve.Ir)}checkEmpty(e){return p.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Cc(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new Ve(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return p.resolve(o)}lookupMutationBatch(e,n){return p.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return p.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return p.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return p.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new Ve(n,0),i=new Ve(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),p.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new pe(G);return n.forEach(i=>{let s=new Ve(i,0),o=new Ve(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),p.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;D.isDocumentKey(s)||(s=s.child(""));let o=new Ve(new D(s),0),a=new pe(G);return this.wr.forEachWhile(u=>{let c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.pr)),!0)},o),p.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){N(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return p.forEach(n.mutations,i=>{let s=new Ve(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new Ve(n,0),i=this.wr.firstAfterOrEqual(r);return p.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,p.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var Nw=class{constructor(e){this.vr=e,this.docs=function(){return new _e(D.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return p.resolve(r?r.document.mutableCopy():Be.newInvalidDocument(n))}getEntries(e,n){let r=wt();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Be.newInvalidDocument(i))}),p.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=wt(),o=n.path,a=new D(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:c,value:{document:l}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||AE(GR(l),r)<=0||(i.has(l.key)||qc(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return p.resolve(s)}getAllFromCollectionGroup(e,n,r,i){A()}Fr(e,n){return p.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Pw(this)}getSize(e){return p.resolve(this.size)}},Pw=class extends Tf{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),p.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var Ow=class{constructor(e){this.persistence=e,this.Mr=new $n(n=>os(n),Uc),this.lastRemoteSnapshotVersion=O.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Rc,this.targetCount=0,this.Br=Go.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),p.resolve()}getLastRemoteSnapshotVersion(e){return p.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return p.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),p.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),p.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Br=new Go(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,p.resolve()}updateTargetData(e,n){return this.qn(n),p.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,p.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),p.waitFor(s).next(()=>i)}getTargetCount(e){return p.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return p.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),p.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),p.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),p.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return p.resolve(r)}containsKey(e,n){return p.resolve(this.Nr.containsKey(n))}};var Af=class{constructor(e,n){this.Lr={},this.overlays={},this.kr=new Rt(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Ow(this),this.indexManager=new _w,this.remoteDocumentCache=function(i){return new Nw(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new _f(n),this.$r=new xw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Mw,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new Rw(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){E("MemoryPersistence","Starting transaction:",e);let i=new kw(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return p.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}},kw=class extends af{constructor(e){super(),this.currentSequenceNumber=e}},xf=class t{constructor(e){this.persistence=e,this.zr=new Rc,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw A()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),p.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),p.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),p.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return p.forEach(this.Jr,r=>{let i=D.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,O.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return p.or([()=>p.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var Fw=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new uf("createOrUpgrade",n);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",GM,{unique:!0}),u.createObjectStore("documentMutations")}(e),xR(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=p.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),xR(e)),o=o.next(()=>function(u){let c=u.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:O.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").W().next(l=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",GM,{unique:!0});let d=c.store("mutations"),h=l.map(f=>d.put(f));return p.waitFor(h)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){let c=u.createObjectStore("documentOverlays",{keyPath:zH});c.createIndex("collectionPathOverlayIndex",WH,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",KH,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){let c=u.createObjectStore("remoteDocumentsV14",{keyPath:kH});c.createIndex("documentKeyIndex",FH),c.createIndex("collectionGroupIndex",VH)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:$H}).createIndex("sequenceNumberIndex",qH,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:HH}).createIndex("documentKeyIndex",GH,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=Cf(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>p.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>p.forEach(a,u=>{N(u.userId===s.userId);let c=Xi(this.serializer,u);return UN(e,s.userId,c).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let u=new ne(o),c=function(d){return[0,dt(d)]}(u);s.push(n.get(c).next(l=>l?p.resolve():(d=>n.put({targetId:0,path:dt(d),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>p.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:UH});let r=n.store("collectionParents"),i=new Mc,s=o=>{if(i.add(o)){let a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:dt(u)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let u=new ne(o);return s(u.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,u],c)=>{let l=kn(a);return s(l.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=dc(i),o=LN(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),u=function(d){return d.document?new D(ne.fromString(d.document.name).popFirst(5)):d.noDocument?D.fromSegments(d.noDocument.path):d.unknownDocument?D.fromSegments(d.unknownDocument.path):A()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>p.waitFor(i))}si(e,n){let r=n.store("mutations"),i=HN(this.serializer),s=new Af(xf.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(u=>{var c;let l=(c=a.get(u.userId))!==null&&c!==void 0?c:W();Xi(this.serializer,u).keys().forEach(d=>l=l.add(d)),a.set(u.userId,l)}),p.forEach(a,(u,c)=>{let l=new Le(c),d=Ef.lt(this.serializer,l),h=s.getIndexManager(l),f=bf.lt(l,this.serializer,h,s.referenceDelegate);return new Sf(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new _c(n,Rt._e),u).next()})})}};function xR(t){t.createObjectStore("targetDocuments",{keyPath:jH}).createIndex("documentTargetsIndex",BH,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",LH,{unique:!0}),t.createObjectStore("targetGlobal")}var S_="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Vw=class t{constructor(e,n,r,i,s,o,a,u,c,l,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=c,this.ai=l,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new w(g.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new bw(this,i),this.Ti=n+"main",this.serializer=new _f(u),this.Ei=new pr(this.Ti,this.ui,new Fw(this.serializer)),this.Qr=new Ew(this.referenceDelegate,this.serializer),this.remoteDocumentCache=HN(this.serializer),this.$r=new hw,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,l===!1&&Me("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new w(g.FAILED_PRECONDITION,S_);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new Rt(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>y(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(n=>y(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>y(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Qh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(si(e))return E("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return E("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return cc(e).get("owner").next(n=>p.resolve(this.Si(n)))}bi(e){return Qh(e).delete(this.clientId)}Di(){return y(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=Ke(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return p.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?p.resolve(!0):cc(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new w(g.FAILED_PRECONDITION,S_);return!1}}return!(!this.networkEnabled||!this.inForeground)||Qh(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&E("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return y(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new _c(e,Rt._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Bi()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>Qh(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return bf.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new ww(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Ef.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){E("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(u){return u===15?YH:u===14?ZR:u===13?YR:u===12?QH:u===11?QR:void A()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new _c(a,this.kr?this.kr.next():Rt._e),n==="readwrite-primary"?this.gi(o).next(u=>!!u||this.pi(o)).next(u=>{if(!u)throw Me(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new w(g.FAILED_PRECONDITION,zR);return r(o)}).next(u=>this.wi(o).next(()=>u)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return cc(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new w(g.FAILED_PRECONDITION,S_)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return cc(e).put("owner",n)}static D(){return pr.D()}yi(e){let n=cc(e);return n.get("owner").next(r=>this.Si(r)?(E("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):p.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(Me(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;yp()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return E("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Me("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Me("Failed to set zombie client id.",e)}}Bi(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function cc(t){return Ke(t,"owner")}function Qh(t){return Ke(t,"clientMetadata")}function VE(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Lw=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=W(),i=W();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var jw=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Mf=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return yp()?8:pr.v(ca())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new jw;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(Ao()<=mn.DEBUG&&E("QueryEngine","SDK will not create cache indexes for query:",xo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),p.resolve()):(Ao()<=mn.DEBUG&&E("QueryEngine","Query:",xo(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Ao()<=mn.DEBUG&&E("QueryEngine","The SDK decides to create cache indexes for query:",xo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ht(n))):p.resolve())}ji(e,n){if(nR(n))return p.resolve(null);let r=ht(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=gf(n,null,"F"),r=ht(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=W(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let c=this.Zi(n,a);return this.Xi(n,c,o,u.readTime)?this.ji(e,gf(n,null,"F")):this.es(e,c,n,u)}))})))}Hi(e,n,r,i){return nR(n)||i.isEqual(O.min())?p.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?p.resolve(null):(Ao()<=mn.DEBUG&&E("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),xo(n)),this.es(e,o,n,HR(i,-1)).next(a=>a))})}Zi(e,n){let r=new pe(lN(e));return n.forEach((i,s)=>{qc(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return Ao()<=mn.DEBUG&&E("QueryEngine","Using full collection scan to execute query:",xo(n)),this.zi.getDocumentsMatchingQuery(e,n,Qt.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Bw=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new _e(G),this.rs=new $n(s=>os(s),Uc),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Sf(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function GN(t,e,n,r){return new Bw(t,e,n,r)}function zN(t,e){return y(this,null,function*(){let n=b(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],u=W();for(let c of i){o.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}for(let c of s){a.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}return n.localDocuments.getDocuments(r,u).next(c=>({us:c,removedBatchIds:o,addedBatchIds:a}))})})})}function x4(t,e){let n=b(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,u,c,l){let d=c.batch,h=d.keys(),f=p.resolve();return h.forEach(m=>{f=f.next(()=>l.getEntry(u,m)).next(v=>{let _=c.docVersions.get(m);N(_!==null),v.version.compareTo(_)<0&&(d.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),l.addEntry(v)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(u,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=W();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function WN(t){let e=b(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function M4(t,e){let n=b(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(We.EMPTY_BYTE_STRING,O.min()).withLastLimboFreeSnapshotVersion(O.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(v,_,I){return v.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(h,f,l)&&a.push(n.Qr.updateTargetData(s,f))});let u=wt(),c=W();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(KN(s,o,e.documentUpdates).next(l=>{u=l.cs,c=l.ls})),!r.isEqual(O.min())){let l=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return p.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.ns=i,s))}function KN(t,e,n){let r=W(),i=W();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=wt();return n.forEach((a,u)=>{let c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(O.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):E("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{cs:o,ls:i}})}function R4(t,e){let n=b(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function zo(t,e){let n=b(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,p.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new Ho(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function Wo(t,e,n){return y(this,null,function*(){let r=b(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!si(o))throw o;E("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function Rf(t,e,n){let r=b(t),i=O.min(),s=W();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,l){let d=b(u),h=d.rs.get(l);return h!==void 0?p.resolve(d.ns.get(h)):d.Qr.getTargetData(c,l)}(r,o,ht(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:O.min(),n?s:W())).next(a=>(ZN(r,cN(e),a),{documents:a,hs:s})))}function QN(t,e){let n=b(t),r=b(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function YN(t,e){let n=b(t),r=n.ss.get(e)||O.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,HR(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(ZN(n,e,i),i))}function ZN(t,e,n){let r=t.ss.get(e)||O.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function N4(t,e,n,r){return y(this,null,function*(){let i=b(t),s=W(),o=wt();for(let c of n){let l=e.Ps(c.metadata.name);c.document&&(s=s.add(l));let d=e.Is(c);d.setReadTime(e.Ts(c.metadata.readTime)),o=o.insert(l,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),u=yield zo(i,function(l){return ht(ea(ne.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>KN(c,a,o).next(l=>(a.apply(c),l)).next(l=>i.Qr.removeMatchingKeysForTargetId(c,u.targetId).next(()=>i.Qr.addMatchingKeys(c,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,l.cs,l.ls)).next(()=>l.cs)))})}function P4(r,i){return y(this,arguments,function*(t,e,n=W()){let s=yield zo(t,ht(kE(e.bundledQuery))),o=b(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let u=Ne(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.$r.saveNamedQuery(a,e);let c=s.withResumeToken(We.EMPTY_BYTE_STRING,u);return o.ns=o.ns.insert(c.targetId,c),o.Qr.updateTargetData(a,c).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function MR(t,e){return`firestore_clients_${t}_${e}`}function RR(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function A_(t,e){return`firestore_targets_${t}_${e}`}var Nf=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new w(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(Me("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},gc=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new w(r.error.code,r.error.message))),s?new t(e,r.state,i):(Me("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Pf=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=PE();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=WR(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(Me("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},Uw=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(Me("SharedClientState",`Failed to parse online state: ${e}`),null)}},Nc=class{constructor(){this.activeTargetIds=PE()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},mc=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new _e(G),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=MR(this.persistenceKey,this.Vs),this.Ss=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Nc),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Fs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return y(this,null,function*(){let e=yield this.syncEngine.Li();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(MR(this.persistenceKey,r));if(i){let s=Pf.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Bs(e,"pending")}updateMutationState(e,n,r){this.Bs(e,n,r),this.Ls(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(A_(this.persistenceKey,e));if(r){let i=gc.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(A_(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Ls(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return E("SharedClientState","READ",e,n),n}setItem(e,n){E("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){E("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(E("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void Me("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>y(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=Rt._e;if(s!=null)try{let a=JSON.parse(s);N(typeof a=="number"),o=a}catch(a){Me("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==Rt._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Bs(e,n,r){let i=new Nf(this.currentUser,e,n,r),s=RR(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Ls(e){let n=RR(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=A_(this.persistenceKey,e),s=new gc(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return Pf.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Nf.Es(new Le(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return gc.Es(i,n)}xs(e){return Uw.Es(e)}Js(e){return JSON.parse(e)}zs(e){return y(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);E("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=PE();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},Of=class{constructor(){this.no=new Nc,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Nc,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var $w=class{io(e){}shutdown(){}};var kf=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){E("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){E("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Yh=null;function x_(){return Yh===null?Yh=function(){return 268435456+Math.round(2147483648*Math.random())}():Yh++,"0x"+Yh.toString(16)}var O4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var qw=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var st="WebChannelConnection",Hw=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=x_(),u=this.bo(n,r.toUriEncodedString());E("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);let c={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(c,s,o),this.Co(n,u,c,i).then(l=>(E("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Kt("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",u,"request:",i),l})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Jo}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=O4[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=x_();return new Promise((o,a)=>{let u=new BM;u.setWithCredentials(!0),u.listenOnce(LM.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case zh.NO_ERROR:let l=u.getResponseJson();E(st,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case zh.TIMEOUT:E(st,`RPC '${e}' ${s} timed out`),a(new w(g.DEADLINE_EXCEEDED,"Request time out"));break;case zh.HTTP_ERROR:let d=u.getStatus();if(E(st,`RPC '${e}' ${s} failed with status:`,d,"response text:",u.getResponseText()),d>0){let h=u.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let m=function(_){let I=_.toLowerCase().replace(/_/g,"-");return Object.values(g).indexOf(I)>=0?I:g.UNKNOWN}(f.status);a(new w(m,f.message))}else a(new w(g.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new w(g.UNAVAILABLE,"Connection failed."));break;default:A()}}finally{E(st,`RPC '${e}' ${s} completed.`)}});let c=JSON.stringify(i);E(st,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}Fo(e,n,r){let i=x_(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=FM(),a=VM(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Do(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;let l=s.join("");E(st,`Creating RPC '${e}' stream ${i}: ${l}`,u);let d=o.createWebChannel(l,u),h=!1,f=!1,m=new qw({lo:_=>{f?E(st,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(h||(E(st,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),E(st,`RPC '${e}' stream ${i} sending:`,_),d.send(_))},ho:()=>d.close()}),v=(_,I,M)=>{_.listen(I,T=>{try{M(T)}catch(F){setTimeout(()=>{throw F},0)}})};return v(d,sc.EventType.OPEN,()=>{f||E(st,`RPC '${e}' stream ${i} transport opened.`)}),v(d,sc.EventType.CLOSE,()=>{f||(f=!0,E(st,`RPC '${e}' stream ${i} transport closed`),m.Vo())}),v(d,sc.EventType.ERROR,_=>{f||(f=!0,Kt(st,`RPC '${e}' stream ${i} transport errored:`,_),m.Vo(new w(g.UNAVAILABLE,"The operation could not be completed")))}),v(d,sc.EventType.MESSAGE,_=>{var I;if(!f){let M=_.data[0];N(!!M);let T=M,F=T.error||((I=T[0])===null||I===void 0?void 0:I.error);if(F){E(st,`RPC '${e}' stream ${i} received error:`,F);let B=F.status,z=function(pp){let II=Fe[pp];if(II!==void 0)return CN(II)}(B),we=F.message;z===void 0&&(z=g.INTERNAL,we="Unknown error status: "+B+" with message "+F.message),f=!0,m.Vo(new w(z,we)),d.close()}else E(st,`RPC '${e}' stream ${i} received:`,M),m.mo(M)}}),v(a,jM.STAT_EVENT,_=>{_.stat===b_.PROXY?E(st,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===b_.NOPROXY&&E(st,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{m.Ro()},0),m}};function XN(){return typeof window<"u"?window:null}function tf(){return typeof document<"u"?document:null}function Hc(t){return new aw(t,!0)}var Pc=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Lo),i=Math.max(0,n-r);i>0&&E("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Lo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Bo!==null&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){this.Bo!==null&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}};var Ff=class{constructor(e,n,r,i,s,o,a,u){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Pc(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return y(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return y(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return y(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===g.RESOURCE_EXHAUSTED?(Me(n.toString()),Me("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===g.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new w(g.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>y(this,null,function*(){this.state=0,this.start()}))}__(e){return E("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(E("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Gw=class extends Ff{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=v4(this.serializer,e),r=function(s){if(!("targetChange"in s))return O.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?O.min():o.readTime?Ne(o.readTime):O.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=lw(this.serializer),n.addTarget=function(s,o){let a,u=o.target;if(a=ff(u)?{documents:NN(s,u)}:{query:PN(s,u).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=TN(s,o.resumeToken);let c=uw(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(O.min())>0){a.readTime=qo(s,o.snapshotVersion.toTimestamp());let c=uw(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);let r=w4(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=lw(this.serializer),n.removeTarget=e,this.t_(n)}},zw=class extends Ff{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if(N(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=_4(e.writeResults,e.commitTime),r=Ne(e.commitTime);return this.listener.T_(r,n)}return N(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=lw(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>xc(this.serializer,r))};this.t_(n)}};var Ww=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new w(g.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,cw(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===g.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new w(g.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,cw(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===g.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new w(g.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var Kw=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(Me(n),this.g_=!1):E("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var Qw=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>y(this,null,function*(){oi(this)&&(E("RemoteStore","Restarting streams for network reachability change."),yield function(u){return y(this,null,function*(){let c=b(u);c.v_.add(4),yield ta(c),c.x_.set("Unknown"),c.v_.delete(4),yield Gc(c)})}(this))}))}),this.x_=new Kw(r,i)}};function Gc(t){return y(this,null,function*(){if(oi(t))for(let e of t.F_)yield e(!0)})}function ta(t){return y(this,null,function*(){for(let e of t.F_)yield e(!1)})}function tp(t,e){let n=b(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),BE(n)?jE(n):ra(n).Jo()&&LE(n,e))}function Oc(t,e){let n=b(t),r=ra(n);n.C_.delete(e),r.Jo()&&JN(n,e),n.C_.size===0&&(r.Jo()?r.Xo():oi(n)&&n.x_.set("Unknown"))}function LE(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(O.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ra(t).c_(e)}function JN(t,e){t.O_.Oe(e),ra(t).l_(e)}function jE(t){t.O_=new ow({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),ra(t).start(),t.x_.p_()}function BE(t){return oi(t)&&!ra(t).Ho()&&t.C_.size>0}function oi(t){return b(t).v_.size===0}function eP(t){t.O_=void 0}function k4(t){return y(this,null,function*(){t.C_.forEach((e,n)=>{LE(t,e)})})}function F4(t,e){return y(this,null,function*(){eP(t),BE(t)?(t.x_.S_(e),jE(t)):t.x_.set("Unknown")})}function V4(t,e,n){return y(this,null,function*(){if(t.x_.set("Online"),e instanceof yf&&e.state===2&&e.cause)try{yield function(i,s){return y(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){E("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Vf(t,r)}else if(e instanceof Fo?t.O_.$e(e):e instanceof mf?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(O.min()))try{let r=yield WN(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){let l=s.C_.get(c);l&&s.C_.set(c,l.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{let l=s.C_.get(u);if(!l)return;s.C_.set(u,l.withResumeToken(We.EMPTY_BYTE_STRING,l.snapshotVersion)),JN(s,u);let d=new Ho(l.target,u,c,l.sequenceNumber);LE(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){E("RemoteStore","Failed to raise snapshot:",r),yield Vf(t,r)}})}function Vf(t,e,n){return y(this,null,function*(){if(!si(e))throw e;t.v_.add(1),yield ta(t),t.x_.set("Offline"),n||(n=()=>WN(t.localStore)),t.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){E("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield Gc(t)}))})}function tP(t,e){return e().catch(n=>Vf(t,n,e))}function na(t){return y(this,null,function*(){let e=b(t),n=ri(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;L4(e);)try{let i=yield R4(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,j4(e,i)}catch(i){yield Vf(e,i)}nP(e)&&rP(e)})}function L4(t){return oi(t)&&t.D_.length<10}function j4(t,e){t.D_.push(e);let n=ri(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function nP(t){return oi(t)&&!ri(t).Ho()&&t.D_.length>0}function rP(t){ri(t).start()}function B4(t){return y(this,null,function*(){ri(t).d_()})}function U4(t){return y(this,null,function*(){let e=ri(t);for(let n of t.D_)e.I_(n.mutations)})}function $4(t,e,n){return y(this,null,function*(){let r=t.D_.shift(),i=rw.from(r,e,n);yield tP(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield na(t)})}function q4(t,e){return y(this,null,function*(){e&&ri(t).P_&&(yield function(r,i){return y(this,null,function*(){if(function(o){return DN(o)&&o!==g.ABORTED}(i.code)){let s=r.D_.shift();ri(r).Zo(),yield tP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield na(r)}})}(t,e)),nP(t)&&rP(t)})}function NR(t,e){return y(this,null,function*(){let n=b(t);n.asyncQueue.verifyOperationInProgress(),E("RemoteStore","RemoteStore received new credentials");let r=oi(n);n.v_.add(3),yield ta(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield Gc(n)})}function Yw(t,e){return y(this,null,function*(){let n=b(t);e?(n.v_.delete(2),yield Gc(n)):e||(n.v_.add(2),yield ta(n),n.x_.set("Unknown"))})}function ra(t){return t.N_||(t.N_=function(n,r,i){let s=b(n);return s.R_(),new Gw(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:k4.bind(null,t),To:F4.bind(null,t),u_:V4.bind(null,t)}),t.F_.push(e=>y(this,null,function*(){e?(t.N_.Zo(),BE(t)?jE(t):t.x_.set("Unknown")):(yield t.N_.stop(),eP(t))}))),t.N_}function ri(t){return t.B_||(t.B_=function(n,r,i){let s=b(n);return s.R_(),new zw(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:B4.bind(null,t),To:q4.bind(null,t),E_:U4.bind(null,t),T_:$4.bind(null,t)}),t.F_.push(e=>y(this,null,function*(){e?(t.B_.Zo(),yield na(t)):(yield t.B_.stop(),t.D_.length>0&&(E("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}var Zw=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new je,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new w(g.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ia(t,e){if(Me("AsyncQueue",`${e}: ${t}`),si(t))return new w(g.UNAVAILABLE,`${e}: ${t}`);throw t}var Lf=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||D.comparator(n.key,r.key):(n,r)=>D.comparator(n.key,r.key),this.keyedMap=lc(),this.sortedSet=new _e(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var jf=class{constructor(){this.L_=new _e(D.comparator)}track(e){let n=e.doc.key,r=this.L_.get(n);r?e.type!==0&&r.type===3?this.L_=this.L_.insert(n,e):e.type===3&&r.type!==1?this.L_=this.L_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.L_=this.L_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.L_=this.L_.remove(n):e.type===1&&r.type===2?this.L_=this.L_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):A():this.L_=this.L_.insert(n,e)}k_(){let e=[];return this.L_.inorderTraversal((n,r)=>{e.push(r)}),e}},Ko=class t{constructor(e,n,r,i,s,o,a,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,Lf.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$c(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var Xw=class{constructor(){this.q_=void 0,this.Q_=[]}},Jw=class{constructor(){this.queries=new $n(e=>uN(e),$c),this.onlineState="Unknown",this.K_=new Set}};function UE(t,e){return y(this,null,function*(){let n=b(t),r=e.query,i=!1,s=n.queries.get(r);if(s||(i=!0,s=new Xw),i)try{s.q_=yield n.onListen(r)}catch(o){let a=ia(o,`Initialization of query '${xo(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.Q_.push(e),e.U_(n.onlineState),s.q_&&e.W_(s.q_)&&qE(n)})}function $E(t,e){return y(this,null,function*(){let n=b(t),r=e.query,i=!1,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),i=s.Q_.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)})}function H4(t,e){let n=b(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.W_(i)&&(r=!0);o.q_=i}}r&&qE(n)}function G4(t,e,n){let r=b(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function qE(t){t.K_.forEach(e=>{e.next()})}var kc=class{constructor(e,n,r){this.query=e,this.G_=n,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=r||{}}W_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Ko(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.z_?this.H_(e)&&(this.G_.next(e),n=!0):this.J_(e,this.onlineState)&&(this.Y_(e),n=!0),this.j_=e,n}onError(e){this.G_.error(e)}U_(e){this.onlineState=e;let n=!1;return this.j_&&!this.z_&&this.J_(this.j_,e)&&(this.Y_(this.j_),n=!0),n}J_(e,n){if(!e.fromCache)return!0;let r=n!=="Offline";return(!this.options.Z_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}H_(e){if(e.docChanges.length>0)return!0;let n=this.j_&&this.j_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Y_(e){e=Ko.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.z_=!0,this.G_.next(e)}};var eE=class{constructor(e,n){this.X_=e,this.byteLength=n}ea(){return"metadata"in this.X_}};var Bf=class{constructor(e){this.serializer=e}Ps(e){return Ln(this.serializer,e)}Is(e){return e.metadata.exists?RN(this.serializer,e.document,!1):Be.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Ne(e)}},tE=class{constructor(e,n,r){this.ta=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=iP(e)}na(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.X_.namedQuery)this.queries.push(e.X_.namedQuery);else if(e.X_.documentMetadata){this.documents.push({metadata:e.X_.documentMetadata}),e.X_.documentMetadata.exists||++n;let r=ne.fromString(e.X_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.X_.document&&(this.documents[this.documents.length-1].document=e.X_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ra(e){let n=new Map,r=new Bf(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||W()).add(s);n.set(o,a)}}return n}complete(){return y(this,null,function*(){let e=yield N4(this.localStore,new Bf(this.serializer),this.documents,this.ta.id),n=this.ra(this.documents);for(let r of this.queries)yield P4(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ia:this.collectionGroups,sa:e}})}};function iP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Uf=class{constructor(e){this.key=e}},$f=class{constructor(e){this.key=e}},qf=class{constructor(e,n){this.query=e,this.oa=n,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=W(),this.mutatedKeys=W(),this.ua=lN(e),this.ca=new Lf(this.ua)}get la(){return this.oa}ha(e,n){let r=n?n.Pa:new jf,i=n?n.ca:this.ca,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=qc(this.query,d)?d:null,m=!!h&&this.mutatedKeys.has(h.key),v=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),_=!1;h&&f?h.data.isEqual(f.data)?m!==v&&(r.track({type:3,doc:f}),_=!0):this.Ia(h,f)||(r.track({type:2,doc:f}),_=!0,(u&&this.ua(f,u)>0||c&&this.ua(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),_=!0):h&&!f&&(r.track({type:1,doc:h}),_=!0,(u||c)&&(a=!0)),_&&(f?(o=o.add(f),s=v?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{ca:o,Pa:r,Xi:a,mutatedKeys:s}}Ia(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.ca;this.ca=e.ca,this.mutatedKeys=e.mutatedKeys;let o=e.Pa.k_();o.sort((l,d)=>function(f,m){let v=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return A()}};return v(f)-v(m)}(l.type,d.type)||this.ua(l.doc,d.doc)),this.Ta(r),i=i!=null&&i;let a=n&&!i?this.Ea():[],u=this.aa.size===0&&this.current&&!i?1:0,c=u!==this._a;return this._a=u,o.length!==0||c?{snapshot:new Ko(this.query,e.ca,s,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),da:a}:{da:a}}U_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new jf,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(e){return!this.oa.has(e)&&!!this.ca.has(e)&&!this.ca.get(e).hasLocalMutations}Ta(e){e&&(e.addedDocuments.forEach(n=>this.oa=this.oa.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.oa=this.oa.delete(n)),this.current=e.current)}Ea(){if(!this.current)return[];let e=this.aa;this.aa=W(),this.ca.forEach(r=>{this.Aa(r.key)&&(this.aa=this.aa.add(r.key))});let n=[];return e.forEach(r=>{this.aa.has(r)||n.push(new $f(r))}),this.aa.forEach(r=>{e.has(r)||n.push(new Uf(r))}),n}Ra(e){this.oa=e.hs,this.aa=W();let n=this.ha(e.documents);return this.applyChanges(n,!0)}Va(){return Ko.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,this._a===0,this.hasCachedResults)}},nE=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},rE=class{constructor(e){this.key=e,this.ma=!1}},iE=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.fa={},this.ga=new $n(a=>uN(a),$c),this.pa=new Map,this.ya=new Set,this.wa=new _e(D.comparator),this.Sa=new Map,this.ba=new Rc,this.Da={},this.Ca=new Map,this.va=Go.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return this.Fa===!0}};function z4(t,e){return y(this,null,function*(){let n=KE(t),r,i,s=n.ga.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Va();else{let o=yield zo(n.localStore,ht(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield HE(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&tp(n.remoteStore,o)}return i})}function HE(t,e,n,r,i){return y(this,null,function*(){t.Ma=(d,h,f)=>function(v,_,I,M){return y(this,null,function*(){let T=_.view.ha(I);T.Xi&&(T=yield Rf(v.localStore,_.query,!1).then(({documents:we})=>_.view.ha(we,T)));let F=M&&M.targetChanges.get(_.targetId),B=M&&M.targetMismatches.get(_.targetId)!=null,z=_.view.applyChanges(T,v.isPrimaryClient,F,B);return sE(v,_.targetId,z.da),z.snapshot})}(t,d,h,f);let s=yield Rf(t.localStore,e,!0),o=new qf(e,s.hs),a=o.ha(s.documents),u=Sc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,u);sE(t,n,c.da);let l=new nE(e,n,o);return t.ga.set(e,l),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),c.snapshot})}function W4(t,e){return y(this,null,function*(){let n=b(t),r=n.ga.get(e),i=n.pa.get(r.targetId);if(i.length>1)return n.pa.set(r.targetId,i.filter(s=>!$c(s,e))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Wo(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Oc(n.remoteStore,r.targetId),Qo(n,r.targetId)}).catch(ii))):(Qo(n,r.targetId),yield Wo(n.localStore,r.targetId,!0))})}function K4(t,e,n){return y(this,null,function*(){let r=QE(t);try{let i=yield function(o,a){let u=b(o),c=De.now(),l=a.reduce((f,m)=>f.add(m.key),W()),d,h;return u.persistence.runTransaction("Locally write mutations","readwrite",f=>{let m=wt(),v=W();return u.os.getEntries(f,l).next(_=>{m=_,m.forEach((I,M)=>{M.isValidDocument()||(v=v.add(I))})}).next(()=>u.localDocuments.getOverlayedDocuments(f,m)).next(_=>{d=_;let I=[];for(let M of a){let T=d4(M,d.get(M.key).overlayedDocument);T!=null&&I.push(new fn(M.key,T,tN(T.value.mapValue),Te.exists(!0)))}return u.mutationQueue.addMutationBatch(f,c,I,a)}).next(_=>{h=_;let I=_.applyToLocalDocumentSet(d,v);return u.documentOverlayCache.saveOverlays(f,_.batchId,I)})}).then(()=>({batchId:h.batchId,changes:hN(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let c=o.Da[o.currentUser.toKey()];c||(c=new _e(G)),c=c.insert(a,u),o.Da[o.currentUser.toKey()]=c}(r,i.batchId,n),yield _r(r,i.changes),yield na(r.remoteStore)}catch(i){let s=ia(i,"Failed to persist write");n.reject(s)}})}function sP(t,e){return y(this,null,function*(){let n=b(t);try{let r=yield M4(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Sa.get(s);o&&(N(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.ma=!0:i.modifiedDocuments.size>0?N(o.ma):i.removedDocuments.size>0&&(N(o.ma),o.ma=!1))}),yield _r(n,r,e)}catch(r){yield ii(r)}})}function PR(t,e,n){let r=b(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ga.forEach((s,o)=>{let a=o.view.U_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let u=b(o);u.onlineState=a;let c=!1;u.queries.forEach((l,d)=>{for(let h of d.Q_)h.U_(a)&&(c=!0)}),c&&qE(u)}(r.eventManager,e),i.length&&r.fa.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Q4(t,e,n){return y(this,null,function*(){let r=b(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Sa.get(e),s=i&&i.key;if(s){let o=new _e(D.comparator);o=o.insert(s,Be.newNoDocument(s,O.min()));let a=W().add(s),u=new Tc(O.min(),new Map,new _e(G),o,a);yield sP(r,u),r.wa=r.wa.remove(s),r.Sa.delete(e),WE(r)}else yield Wo(r.localStore,e,!1).then(()=>Qo(r,e,n)).catch(ii)})}function Y4(t,e){return y(this,null,function*(){let n=b(t),r=e.batch.batchId;try{let i=yield x4(n.localStore,e);zE(n,r,null),GE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield _r(n,i)}catch(i){yield ii(i)}})}function Z4(t,e,n){return y(this,null,function*(){let r=b(t);try{let i=yield function(o,a){let u=b(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return u.mutationQueue.lookupMutationBatch(c,a).next(d=>(N(d!==null),l=d.keys(),u.mutationQueue.removeMutationBatch(c,d))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,l,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>u.localDocuments.getDocuments(c,l))})}(r.localStore,e);zE(r,e,n),GE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield _r(r,i)}catch(i){yield ii(i)}})}function X4(t,e){return y(this,null,function*(){let n=b(t);oi(n.remoteStore)||E("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=b(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ca.get(r)||[];i.push(e),n.Ca.set(r,i)}catch(r){let i=ia(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function GE(t,e){(t.Ca.get(e)||[]).forEach(n=>{n.resolve()}),t.Ca.delete(e)}function zE(t,e,n){let r=b(t),i=r.Da[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Da[r.currentUser.toKey()]=i}}function Qo(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.pa.get(e))t.ga.delete(r),n&&t.fa.xa(r,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach(r=>{t.ba.containsKey(r)||oP(t,r)})}function oP(t,e){t.ya.delete(e.path.canonicalString());let n=t.wa.get(e);n!==null&&(Oc(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),WE(t))}function sE(t,e,n){for(let r of n)r instanceof Uf?(t.ba.addReference(r.key,e),J4(t,r)):r instanceof $f?(E("SyncEngine","Document no longer in limbo: "+r.key),t.ba.removeReference(r.key,e),t.ba.containsKey(r.key)||oP(t,r.key)):A()}function J4(t,e){let n=e.key,r=n.path.canonicalString();t.wa.get(n)||t.ya.has(r)||(E("SyncEngine","New document in limbo: "+n),t.ya.add(r),WE(t))}function WE(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){let e=t.ya.values().next().value;t.ya.delete(e);let n=new D(ne.fromString(e)),r=t.va.next();t.Sa.set(r,new rE(n)),t.wa=t.wa.insert(n,r),tp(t.remoteStore,new Ho(ht(ea(n.path)),r,"TargetPurposeLimboResolution",Rt._e))}}function _r(t,e,n){return y(this,null,function*(){let r=b(t),i=[],s=[],o=[];r.ga.isEmpty()||(r.ga.forEach((a,u)=>{o.push(r.Ma(u,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c?.fromCache?"not-current":"current"),c){i.push(c);let l=Lw.Ki(u.targetId,c);s.push(l)}}))}),yield Promise.all(o),r.fa.u_(i),yield function(u,c){return y(this,null,function*(){let l=b(u);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>p.forEach(c,h=>p.forEach(h.qi,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>p.forEach(h.Qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!si(d))throw d;E("LocalStore","Failed to update sequence numbers: "+d)}for(let d of c){let h=d.targetId;if(!d.fromCache){let f=l.ns.get(h),m=f.snapshotVersion,v=f.withLastLimboFreeSnapshotVersion(m);l.ns=l.ns.insert(h,v)}}})}(r.localStore,s))})}function eG(t,e){return y(this,null,function*(){let n=b(t);if(!n.currentUser.isEqual(e)){E("SyncEngine","User change. New user:",e.toKey());let r=yield zN(n.localStore,e);n.currentUser=e,function(s,o){s.Ca.forEach(a=>{a.forEach(u=>{u.reject(new w(g.CANCELLED,o))})}),s.Ca.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield _r(n,r.us)}})}function tG(t,e){let n=b(t),r=n.Sa.get(e);if(r&&r.ma)return W().add(r.key);{let i=W(),s=n.pa.get(e);if(!s)return i;for(let o of s){let a=n.ga.get(o);i=i.unionWith(a.view.la)}return i}}function nG(t,e){return y(this,null,function*(){let n=b(t),r=yield Rf(n.localStore,e.query,!0),i=e.view.Ra(r);return n.isPrimaryClient&&sE(n,e.targetId,i.da),i})}function rG(t,e){return y(this,null,function*(){let n=b(t);return YN(n.localStore,e).then(r=>_r(n,r))})}function iG(t,e,n,r){return y(this,null,function*(){let i=b(t),s=yield function(a,u){let c=b(a),l=b(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.vn(d,u).next(h=>h?c.localDocuments.getDocuments(d,h):p.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield na(i.remoteStore):n==="acknowledged"||n==="rejected"?(zE(i,e,r||null),GE(i,e),function(a,u){b(b(a).mutationQueue).Mn(u)}(i.localStore,e)):A(),yield _r(i,s)):E("SyncEngine","Cannot apply mutation batch with id: "+e)})}function sG(t,e){return y(this,null,function*(){let n=b(t);if(KE(n),QE(n),e===!0&&n.Fa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield OR(n,r.toArray());n.Fa=!0,yield Yw(n.remoteStore,!0);for(let s of i)tp(n.remoteStore,s)}else if(e===!1&&n.Fa!==!1){let r=[],i=Promise.resolve();n.pa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Qo(n,o),Wo(n.localStore,o,!0))),Oc(n.remoteStore,o)}),yield i,yield OR(n,r),function(o){let a=b(o);a.Sa.forEach((u,c)=>{Oc(a.remoteStore,c)}),a.ba.mr(),a.Sa=new Map,a.wa=new _e(D.comparator)}(n),n.Fa=!1,yield Yw(n.remoteStore,!1)}})}function OR(t,e,n){return y(this,null,function*(){let r=b(t),i=[],s=[];for(let o of e){let a,u=r.pa.get(o);if(u&&u.length!==0){a=yield zo(r.localStore,ht(u[0]));for(let c of u){let l=r.ga.get(c),d=yield nG(r,l);d.snapshot&&s.push(d.snapshot)}}else{let c=yield QN(r.localStore,o);a=yield zo(r.localStore,c),yield HE(r,aP(c),o,!1,a.resumeToken)}i.push(a)}return r.fa.u_(s),i})}function aP(t){return aN(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function oG(t){return function(n){return b(b(n).persistence).Li()}(b(t).localStore)}function aG(t,e,n,r){return y(this,null,function*(){let i=b(t);if(i.Fa)return void E("SyncEngine","Ignoring unexpected query state notification.");let s=i.pa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield YN(i.localStore,cN(s[0])),a=Tc.createSynthesizedRemoteEventForCurrentChange(e,n==="current",We.EMPTY_BYTE_STRING);yield _r(i,o,a);break}case"rejected":yield Wo(i.localStore,e,!0),Qo(i,e,r);break;default:A()}})}function uG(t,e,n){return y(this,null,function*(){let r=KE(t);if(r.Fa){for(let i of e){if(r.pa.has(i)){E("SyncEngine","Adding an already active target "+i);continue}let s=yield QN(r.localStore,i),o=yield zo(r.localStore,s);yield HE(r,aP(s),o.targetId,!1,o.resumeToken),tp(r.remoteStore,o)}for(let i of n)r.pa.has(i)&&(yield Wo(r.localStore,i,!1).then(()=>{Oc(r.remoteStore,i),Qo(r,i)}).catch(ii))}})}function KE(t){let e=b(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=sP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tG.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Q4.bind(null,e),e.fa.u_=H4.bind(null,e.eventManager),e.fa.xa=G4.bind(null,e.eventManager),e}function QE(t){let e=b(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Y4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Z4.bind(null,e),e}function cG(t,e,n){let r=b(t);(function(s,o,a){return y(this,null,function*(){try{let u=yield o.getMetadata();if(yield function(f,m){let v=b(f),_=Ne(m.createTime);return v.persistence.runTransaction("hasNewerBundle","readonly",I=>v.$r.getBundleMetadata(I,m.id)).then(I=>!!I&&I.createTime.compareTo(_)>=0)}(s.localStore,u))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(iP(u));let c=new tE(u,s.localStore,o.serializer),l=yield o.Oa();for(;l;){let h=yield c.na(l);h&&a._updateProgress(h),l=yield o.Oa()}let d=yield c.complete();return yield _r(s,d.sa,void 0),yield function(f,m){let v=b(f);return v.persistence.runTransaction("Save bundle","readwrite",_=>v.$r.saveBundleMetadata(_,m))}(s.localStore,u),a._completeWith(d.progress),Promise.resolve(d.ia)}catch(u){return Kt("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Fc=class{constructor(){this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){this.serializer=Hc(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return GN(this.persistence,new Mf,e.initialUser,this.serializer)}createPersistence(e){return new Af(xf.Hr,this.serializer)}createSharedClientState(e){return new Of}terminate(){return y(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Hf=class t extends Fc{constructor(e,n,r){super(),this.Na=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){yield gp(t.prototype,this,"initialize").call(this,e),yield this.Na.initialize(this,e),yield QE(this.Na.syncEngine),yield na(this.Na.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return GN(this.persistence,new Mf,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new Dw(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new U_(n,this.persistence);return new B_(e.asyncQueue,r)}createPersistence(e){let n=VE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Wt.withCacheSize(this.cacheSizeBytes):Wt.DEFAULT;return new Vw(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,XN(),tf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Of}},oE=class t extends Hf{constructor(e,n){super(e,n,!1),this.Na=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return y(this,null,function*(){yield gp(t.prototype,this,"initialize").call(this,e);let n=this.Na.syncEngine;this.sharedClientState instanceof mc&&(this.sharedClientState.syncEngine={Zs:iG.bind(null,n),Xs:aG.bind(null,n),eo:uG.bind(null,n),Li:oG.bind(null,n),Ys:rG.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>y(this,null,function*(){yield sG(this.Na.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=XN();if(!mc.D(n))throw new w(g.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=VE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new mc(n,e.asyncQueue,r,e.clientId,e.initialUser)}},Vc=class{initialize(e,n){return y(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>PR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=eG.bind(null,this.syncEngine),yield Yw(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new Jw}()}createDatastore(e){let n=Hc(e.databaseInfo.databaseId),r=function(s){return new Hw(s)}(e.databaseInfo);return function(s,o,a,u){return new Ww(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new Qw(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>PR(this.syncEngine,n,0),function(){return kf.D()?new kf:new $w}())}createSyncEngine(e,n){return function(i,s,o,a,u,c,l){let d=new iE(i,s,o,a,u,c);return l&&(d.Fa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return y(this,null,function*(){var e;yield function(r){return y(this,null,function*(){let i=b(r);E("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield ta(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function kR(t,e=10240){let n=0;return{read(){return y(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return y(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Yo=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ba(this.observer.next,e)}error(e){this.observer.error?this.Ba(this.observer.error,e):Me("Uncaught Error in snapshot listener:",e.toString())}La(){this.muted=!0}Ba(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var aE=class{constructor(e,n){this.ka=e,this.serializer=n,this.metadata=new je,this.buffer=new Uint8Array,this.qa=function(){return new TextDecoder("utf-8")}(),this.Qa().then(r=>{r&&r.ea()?this.metadata.resolve(r.X_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.X_)}`))},r=>this.metadata.reject(r))}close(){return this.ka.cancel()}getMetadata(){return y(this,null,function*(){return this.metadata.promise})}Oa(){return y(this,null,function*(){return yield this.getMetadata(),this.Qa()})}Qa(){return y(this,null,function*(){let e=yield this.Ka();if(e===null)return null;let n=this.qa.decode(e),r=Number(n);isNaN(r)&&this.$a(`length string (${n}) is not valid number`);let i=yield this.Ua(r);return new eE(JSON.parse(i),e.length+r)})}Wa(){return this.buffer.findIndex(e=>e===123)}Ka(){return y(this,null,function*(){for(;this.Wa()<0&&!(yield this.Ga()););if(this.buffer.length===0)return null;let e=this.Wa();e<0&&this.$a("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}Ua(e){return y(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ga())&&this.$a("Reached the end of bundle when more is expected.");let n=this.qa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}$a(e){throw this.ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ga(){return y(this,null,function*(){let e=yield this.ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var uE=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return y(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new w(g.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return y(this,null,function*(){let o=b(i),a={documents:s.map(d=>Ac(o.serializer,d))},u=yield o.vo("BatchGetDocuments",o.serializer.databaseId,ne.emptyPath(),a,s.length),c=new Map;u.forEach(d=>{let h=y4(o.serializer,d);c.set(h.key.toString(),h)});let l=[];return s.forEach(d=>{let h=c.get(d.toString());N(!!h),l.push(h)}),l})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ni(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return y(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=D.fromPath(r);this.mutations.push(new Dc(i,this.precondition(i)))}),yield function(r,i){return y(this,null,function*(){let s=b(r),o={writes:i.map(a=>xc(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,ne.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw A();n=O.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new w(g.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(O.min())?Te.exists(!1):Te.updateTime(n):Te.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(O.min()))throw new w(g.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Te.updateTime(n)}return Te.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var cE=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.za=r.maxAttempts,this.jo=new Pc(this.asyncQueue,"transaction_retry")}ja(){this.za-=1,this.Ha()}Ha(){this.jo.qo(()=>y(this,null,function*(){let e=new uE(this.datastore),n=this.Ja(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Ya(i)}))}).catch(r=>{this.Ya(r)})}))}Ja(e){try{let n=this.updateFunction(e);return!Bc(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Ya(e){this.za>0&&this.Za(e)?(this.za-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ha(),Promise.resolve()))):this.deferred.reject(e)}Za(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!DN(n)}return!1}};var lE=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Le.UNAUTHENTICATED,this.clientId=sf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>y(this,null,function*(){E("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(E("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new w(g.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new je;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=ia(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function nf(t,e){return y(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),E("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield zN(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function dE(t,e){return y(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield YE(t);E("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>NR(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>NR(e.remoteStore,i)),t._onlineComponents=e})}function uP(t){return t.name==="FirebaseError"?t.code===g.FAILED_PRECONDITION||t.code===g.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function YE(t){return y(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){E("FirestoreClient","Using user provided OfflineComponentProvider");try{yield nf(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!uP(n))throw n;Kt("Error using user provided cache. Falling back to memory cache: "+n),yield nf(t,new Fc)}}else E("FirestoreClient","Using default OfflineComponentProvider"),yield nf(t,new Fc);return t._offlineComponents})}function np(t){return y(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(E("FirestoreClient","Using user provided OnlineComponentProvider"),yield dE(t,t._uninitializedComponentsProvider._online)):(E("FirestoreClient","Using default OnlineComponentProvider"),yield dE(t,new Vc))),t._onlineComponents})}function cP(t){return YE(t).then(e=>e.persistence)}function ZE(t){return YE(t).then(e=>e.localStore)}function lP(t){return np(t).then(e=>e.remoteStore)}function XE(t){return np(t).then(e=>e.syncEngine)}function lG(t){return np(t).then(e=>e.datastore)}function Zo(t){return y(this,null,function*(){let e=yield np(t),n=e.eventManager;return n.onListen=z4.bind(null,e.syncEngine),n.onUnlisten=W4.bind(null,e.syncEngine),n})}function dG(t){return t.asyncQueue.enqueue(()=>y(this,null,function*(){let e=yield cP(t),n=yield lP(t);return e.setNetworkEnabled(!0),function(i){let s=b(i);return s.v_.delete(0),Gc(s)}(n)}))}function hG(t){return t.asyncQueue.enqueue(()=>y(this,null,function*(){let e=yield cP(t),n=yield lP(t);return e.setNetworkEnabled(!1),function(i){return y(this,null,function*(){let s=b(i);s.v_.add(0),yield ta(s),s.x_.set("Offline")})}(n)}))}function fG(t,e){let n=new je;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(i,s,o){return y(this,null,function*(){try{let a=yield function(c,l){let d=b(c);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new w(g.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=ia(a,`Failed to get document '${s} from cache`);o.reject(u)}})}(yield ZE(t),e,n)})),n.promise}function dP(t,e,n={}){let r=new je;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(s,o,a,u,c){let l=new Yo({next:h=>{o.enqueueAndForget(()=>$E(s,d));let f=h.docs.has(a);!f&&h.fromCache?c.reject(new w(g.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&u&&u.source==="server"?c.reject(new w(g.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new kc(ea(a.path),l,{includeMetadataChanges:!0,Z_:!0});return UE(s,d)}(yield Zo(t),t.asyncQueue,e,n,r)})),r.promise}function pG(t,e){let n=new je;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(i,s,o){return y(this,null,function*(){try{let a=yield Rf(i,s,!0),u=new qf(s,a.hs),c=u.ha(a.documents),l=u.applyChanges(c,!1);o.resolve(l.snapshot)}catch(a){let u=ia(a,`Failed to execute query '${s} against cache`);o.reject(u)}})}(yield ZE(t),e,n)})),n.promise}function hP(t,e,n={}){let r=new je;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(s,o,a,u,c){let l=new Yo({next:h=>{o.enqueueAndForget(()=>$E(s,d)),h.fromCache&&u.source==="server"?c.reject(new w(g.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new kc(a,l,{includeMetadataChanges:!0,Z_:!0});return UE(s,d)}(yield Zo(t),t.asyncQueue,e,n,r)})),r.promise}function gG(t,e){let n=new Yo(e);return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(i,s){b(i).K_.add(s),s.next()}(yield Zo(t),n)})),()=>{n.La(),t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(i,s){b(i).K_.delete(s)}(yield Zo(t),n)}))}}function mG(t,e,n,r){let i=function(o,a){let u;return u=typeof o=="string"?bN().encode(o):o,function(l,d){return new aE(l,d)}(function(l,d){if(l instanceof Uint8Array)return kR(l,d);if(l instanceof ArrayBuffer)return kR(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(n,Hc(e));t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){cG(yield XE(t),i,r)}))}function yG(t,e){return t.asyncQueue.enqueue(()=>y(this,null,function*(){return function(r,i){let s=b(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield ZE(t),e)}))}function fP(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var FR=new Map;function JE(t,e,n){if(!n)throw new w(g.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function eI(t,e,n,r){if(e===!0&&r===!0)throw new w(g.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function VR(t){if(!D.isDocumentKey(t))throw new w(g.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function LR(t){if(D.isDocumentKey(t))throw new w(g.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function rp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":A()}function re(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new w(g.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=rp(t);throw new w(g.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function pP(t,e){if(e<=0)throw new w(g.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var Gf=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new w(g.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new w(g.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}eI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fP((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new w(g.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new w(g.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new w(g.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ls=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gf({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new w(g.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new w(g.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gf(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new M_;switch(r.type){case"firstParty":return new O_(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new w(g.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=FR.get(n);r&&(E("ComponentProvider","Removing Datastore"),FR.delete(n),r.terminate())}(this),Promise.resolve()}};function gP(t,e,n,r={}){var i;let s=(t=re(t,ls))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Kt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=Le.MOCK_USER;else{a=SI(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new w(g.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Le(c)}t._authCredentials=new R_(new rf(a,u))}}var Xe=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},me=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new jn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},jn=class t extends Xe{constructor(e,n,r){super(e,n,ea(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new me(this.firestore,null,new D(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function tI(t,e,...n){if(t=Ie(t),JE("collection","path",e),t instanceof ls){let r=ne.fromString(e,...n);return LR(r),new jn(t,null,r)}{if(!(t instanceof me||t instanceof jn))throw new w(g.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ne.fromString(e,...n));return LR(r),new jn(t.firestore,null,r)}}function mP(t,e){if(t=re(t,ls),JE("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new w(g.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Xe(t,null,function(r){return new hn(ne.emptyPath(),r)}(e))}function zc(t,e,...n){if(t=Ie(t),arguments.length===1&&(e=sf.newId()),JE("doc","path",e),t instanceof ls){let r=ne.fromString(e,...n);return VR(r),new me(t,null,new D(r))}{if(!(t instanceof me||t instanceof jn))throw new w(g.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ne.fromString(e,...n));return VR(r),new me(t.firestore,t instanceof jn?t.converter:null,new D(r))}}function nI(t,e){return t=Ie(t),e=Ie(e),(t instanceof me||t instanceof jn)&&(e instanceof me||e instanceof jn)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function rI(t,e){return t=Ie(t),e=Ie(e),t instanceof Xe&&e instanceof Xe&&t.firestore===e.firestore&&$c(t._query,e._query)&&t.converter===e.converter}var hE=class{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new Pc(this,"async_queue_retry"),this._u=()=>{let n=tf();n&&E("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=tf();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.au(),this.uu(e)}enterRestrictedMode(e){if(!this.tu){this.tu=!0,this.su=e||!1;let n=tf();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._u)}}enqueue(e){if(this.au(),this.tu)return new Promise(()=>{});let n=new je;return this.uu(()=>this.tu&&this.su?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.eu.push(e),this.cu()))}cu(){return y(this,null,function*(){if(this.eu.length!==0){try{yield this.eu[0](),this.eu.shift(),this.jo.reset()}catch(e){if(!si(e))throw e;E("AsyncQueue","Operation failed with retryable error: "+e)}this.eu.length>0&&this.jo.qo(()=>this.cu())}})}uu(e){let n=this.Xa.then(()=>(this.iu=!0,e().catch(r=>{this.ru=r,this.iu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Me("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.iu=!1,r))));return this.Xa=n,n}enqueueAfterDelay(e,n,r){this.au(),this.ou.indexOf(e)>-1&&(n=0);let i=Zw.createAndSchedule(this,e,n,r,s=>this.lu(s));return this.nu.push(i),i}au(){this.ru&&A()}verifyOperationInProgress(){}hu(){return y(this,null,function*(){let e;do e=this.Xa,yield e;while(e!==this.Xa)})}Pu(e){for(let n of this.nu)if(n.timerId===e)return!0;return!1}Iu(e){return this.hu().then(()=>{this.nu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.nu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.hu()})}Tu(e){this.ou.push(e)}lu(e){let n=this.nu.indexOf(e);this.nu.splice(n,1)}};function fE(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var pE=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new je,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var yP=-1,Ee=class extends ls{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new hE}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||vP(this),this._firestoreClient.terminate()}};function He(t){return t._firestoreClient||vP(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function vP(t){var e,n,r;let i=t._freezeSettings(),s=function(a,u,c,l){return new $_(a,u,c,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,fP(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new lE(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function _P(t,e){AP(t=re(t,Ee));let n=He(t);if(n._uninitializedComponentsProvider)throw new w(g.FAILED_PRECONDITION,"SDK cache is already specified.");Kt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new Vc;return EP(n,i,new Hf(i,r.cacheSizeBytes,e?.forceOwnership))}function wP(t){AP(t=re(t,Ee));let e=He(t);if(e._uninitializedComponentsProvider)throw new w(g.FAILED_PRECONDITION,"SDK cache is already specified.");Kt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new Vc;return EP(e,r,new oE(r,n.cacheSizeBytes))}function EP(t,e,n){let r=new je;return t.asyncQueue.enqueue(()=>y(this,null,function*(){try{yield nf(t,n),yield dE(t,e),r.resolve()}catch(i){let s=i;if(!uP(s))throw s;Kt("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function IP(t){if(t._initialized&&!t._terminated)throw new w(g.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new je;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{yield function(r){return y(this,null,function*(){if(!pr.D())return Promise.resolve();let i=r+"main";yield pr.delete(i)})}(VE(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function DP(t){return function(n){let r=new je;return n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return X4(yield XE(n),r)})),r.promise}(He(t=re(t,Ee)))}function CP(t){return dG(He(t=re(t,Ee)))}function bP(t){return hG(He(t=re(t,Ee)))}function TP(t,e){let n=He(t=re(t,Ee)),r=new pE;return mG(n,t._databaseId,e,r),r}function SP(t,e){return yG(He(t=re(t,Ee)),e).then(n=>n?new Xe(t,null,n.query):null)}function AP(t){if(t._initialized||t._terminated)throw new w(g.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var qn=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(We.fromBase64String(e))}catch(n){throw new w(g.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(We.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var pn=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new w(g.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Re(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var yr=class{constructor(e){this._methodName=e}};var ds=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new w(g.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new w(g.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return G(this._lat,e._lat)||G(this._long,e._long)}};var vG=/^__.*__$/,gE=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new fn(e,this.data,this.fieldMask,n,this.fieldTransforms):new ti(e,this.data,n,this.fieldTransforms)}},zf=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new fn(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function xP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw A()}}var Wf=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Eu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.mu(e),i}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.Eu(),i}gu(e){return this.Au({path:void 0,Vu:!0})}pu(e){return Kf(e,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Eu(){if(this.path)for(let e=0;e<this.path.length;e++)this.mu(this.path.get(e))}mu(e){if(e.length===0)throw this.pu("Document fields must not be empty");if(xP(this.du)&&vG.test(e))throw this.pu('Document fields cannot begin and end with "__"')}},mE=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Hc(e)}Su(e,n,r,i=!1){return new Wf({du:e,methodName:n,wu:r,path:Re.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function gs(t){let e=t._freezeSettings(),n=Hc(t._databaseId);return new mE(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ip(t,e,n,r,i,s={}){let o=t.Su(s.merge||s.mergeFields?2:0,e,n,i);oI("Data must be an object, but it was:",o,r);let a=NP(r,o),u,c;if(s.merge)u=new Nt(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=EE(e,d,n);if(!o.contains(h))throw new w(g.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);OP(l,h)||l.push(h)}u=new Nt(l),c=o.fieldTransforms.filter(d=>u.covers(d.field))}else u=null,c=o.fieldTransforms;return new gE(new ot(a),u,c)}var Lc=class t extends yr{_toFieldTransform(e){if(e.du!==2)throw e.du===1?e.pu(`${this._methodName}() can only appear at the top level of your update data`):e.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function MP(t,e,n){return new Wf({du:3,wu:e.settings.wu,methodName:t._methodName,Vu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var yE=class t extends yr{_toFieldTransform(e){return new as(e.path,new Jr)}isEqual(e){return e instanceof t}},vE=class t extends yr{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=MP(this,e,!0),r=this.bu.map(s=>ms(s,n)),i=new gr(r);return new as(e.path,i)}isEqual(e){return e instanceof t&&vp(this.bu,e.bu)}},_E=class t extends yr{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=MP(this,e,!0),r=this.bu.map(s=>ms(s,n)),i=new mr(r);return new as(e.path,i)}isEqual(e){return e instanceof t&&vp(this.bu,e.bu)}},wE=class t extends yr{constructor(e,n){super(e),this.Du=n}_toFieldTransform(e){let n=new ei(e.serializer,mN(e.serializer,this.Du));return new as(e.path,n)}isEqual(e){return e instanceof t&&this.Du===e.Du}};function iI(t,e,n,r){let i=t.Su(1,e,n);oI("Data must be an object, but it was:",i,r);let s=[],o=ot.empty();ps(r,(u,c)=>{let l=aI(e,u,n);c=Ie(c);let d=i.fu(l);if(c instanceof Lc)s.push(l);else{let h=ms(c,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new Nt(s);return new zf(o,a,i.fieldTransforms)}function sI(t,e,n,r,i,s){let o=t.Su(1,e,n),a=[EE(e,r,n)],u=[i];if(s.length%2!=0)throw new w(g.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(EE(e,s[h])),u.push(s[h+1]);let c=[],l=ot.empty();for(let h=a.length-1;h>=0;--h)if(!OP(c,a[h])){let f=a[h],m=u[h];m=Ie(m);let v=o.fu(f);if(m instanceof Lc)c.push(f);else{let _=ms(m,v);_!=null&&(c.push(f),l.set(f,_))}}let d=new Nt(c);return new zf(l,d,o.fieldTransforms)}function RP(t,e,n,r=!1){return ms(n,t.Su(r?4:3,e))}function ms(t,e){if(PP(t=Ie(t)))return oI("Unsupported field value:",e,t),NP(t,e);if(t instanceof yr)return function(r,i){if(!xP(i.du))throw i.pu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.pu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&e.du!==4)throw e.pu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let u=ms(a,i.gu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Ie(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return mN(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=De.fromDate(r);return{timestampValue:qo(i.serializer,s)}}if(r instanceof De){let s=new De(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:qo(i.serializer,s)}}if(r instanceof ds)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof qn)return{bytesValue:TN(i.serializer,r._byteString)};if(r instanceof me){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.pu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:OE(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.pu(`Unsupported field value: ${rp(r)}`)}(t,e)}function NP(t,e){let n={};return XR(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ps(t,(r,i)=>{let s=ms(i,e.Ru(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function PP(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof De||t instanceof ds||t instanceof qn||t instanceof me||t instanceof yr)}function oI(t,e,n){if(!PP(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=rp(n);throw r==="an object"?e.pu(t+" a custom object"):e.pu(t+" "+r)}}function EE(t,e,n){if((e=Ie(e))instanceof pn)return e._internalPath;if(typeof e=="string")return aI(t,e);throw Kf("Field path arguments must be of type string or ",t,!1,void 0,n)}var _G=new RegExp("[~\\*/\\[\\]]");function aI(t,e,n){if(e.search(_G)>=0)throw Kf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new pn(...e.split("."))._internalPath}catch{throw Kf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Kf(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new w(g.INVALID_ARGUMENT,a+t+u)}function OP(t,e){return t.some(n=>n.isEqual(e))}var hs=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new IE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(sp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},IE=class extends hs{data(){return super.data()}};function sp(t,e){return typeof e=="string"?aI(t,e):e instanceof pn?e._internalPath:e._delegate._internalPath}function kP(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new w(g.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var jc=class{},fs=class extends jc{};function wr(t,e,...n){let r=[];e instanceof jc&&r.push(e),r=r.concat(n),function(s){let o=s.filter(u=>u instanceof DE).length,a=s.filter(u=>u instanceof Qf).length;if(o>1||o>0&&a>0)throw new w(g.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var Qf=class t extends fs{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return GP(e._query,n),new Xe(e.firestore,e.converter,tw(e._query,n))}_parse(e){let n=gs(e.firestore);return function(s,o,a,u,c,l,d){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new w(g.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){BR(d,l);let f=[];for(let m of d)f.push(jR(u,s,m));h={arrayValue:{values:f}}}else h=jR(u,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||BR(d,l),h=RP(a,o,d,l==="in"||l==="not-in");return J.create(c,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function FP(t,e,n){let r=e,i=sp("where",t);return Qf._create(i,r,n)}var DE=class t extends jc{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:de.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let u of a)GP(o,u),o=tw(o,u)}(e._query,n),new Xe(e.firestore,e.converter,tw(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var CE=class t extends fs{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new w(g.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new w(g.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ss(s,o)}(e._query,this._field,this._direction);return new Xe(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new hn(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function VP(t,e="asc"){let n=e,r=sp("orderBy",t);return CE._create(r,n)}var Yf=class t extends fs{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new Xe(e.firestore,e.converter,gf(e._query,this._limit,this._limitType))}};function LP(t){return pP("limit",t),Yf._create("limit",t,"F")}function jP(t){return pP("limitToLast",t),Yf._create("limitToLast",t,"L")}var Zf=class t extends fs{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=HP(e,this.type,this._docOrFields,this._inclusive);return new Xe(e.firestore,e.converter,function(i,s){return new hn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function BP(...t){return Zf._create("startAt",t,!0)}function UP(...t){return Zf._create("startAfter",t,!1)}var Xf=class t extends fs{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=HP(e,this.type,this._docOrFields,this._inclusive);return new Xe(e.firestore,e.converter,function(i,s){return new hn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function $P(...t){return Xf._create("endBefore",t,!1)}function qP(...t){return Xf._create("endAt",t,!0)}function HP(t,e,n,r){if(n[0]=Ie(n[0]),n[0]instanceof hs)return function(s,o,a,u,c){if(!u)throw new w(g.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of ko(s))if(d.field.isKeyField())l.push(is(o,u.key));else{let h=u.data.field(d.field);if(ep(h))throw new w(g.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new w(g.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new Un(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=gs(t.firestore);return function(o,a,u,c,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new w(g.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let m=0;m<l.length;m++){let v=l[m];if(h[m].field.isKeyField()){if(typeof v!="string")throw new w(g.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof v}`);if(!NE(o)&&v.indexOf("/")!==-1)throw new w(g.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${v}' contains a slash.`);let _=o.path.child(ne.fromString(v));if(!D.isDocumentKey(_))throw new w(g.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${_}' is not because it contains an odd number of segments.`);let I=new D(_);f.push(is(a,I))}else{let _=RP(u,c,v);f.push(_)}}return new Un(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function jR(t,e,n){if(typeof(n=Ie(n))=="string"){if(n==="")throw new w(g.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!NE(e)&&n.indexOf("/")!==-1)throw new w(g.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(ne.fromString(n));if(!D.isDocumentKey(r))throw new w(g.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return is(t,new D(r))}if(n instanceof me)return is(t,n._key);throw new w(g.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rp(n)}.`)}function BR(t,e){if(!Array.isArray(t)||t.length===0)throw new w(g.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function GP(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new w(g.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new w(g.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var Xo=class{convertValue(e,n="none"){switch(rs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return be(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Yr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw A()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return ps(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new ds(be(e.latitude),be(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=ME(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(wc(e));default:return null}}convertTimestamp(e){let n=Qr(e);return new De(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=ne.fromString(e);N(VN(r));let i=new Zr(r.get(1),r.get(3)),s=new D(r.popFirst(5));return i.isEqual(n)||Me(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function op(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var bE=class extends Xo{constructor(e){super(),this.firestore=e}convertBytes(e){return new qn(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new me(this.firestore,null,n)}};var fr=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Yt=class extends hs{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Wr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(sp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Wr=class extends Yt{data(e={}){return super.data(e)}},gn=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new fr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Wr(this._firestore,this._userDataWriter,r.key,r,new fr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new w(g.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let u=new Wr(i._firestore,i._userDataWriter,a.doc.key,a.doc,new fr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let u=new Wr(i._firestore,i._userDataWriter,a.doc.key,a.doc,new fr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),c=-1,l=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:wG(a.type),doc:u,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function wG(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return A()}}function uI(t,e){return t instanceof Yt&&e instanceof Yt?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof gn&&e instanceof gn&&t._firestore===e._firestore&&rI(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function zP(t){t=re(t,me);let e=re(t.firestore,Ee);return dP(He(e),t._key).then(n=>hI(e,t,n))}var vr=class extends Xo{constructor(e){super(),this.firestore=e}convertBytes(e){return new qn(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new me(this.firestore,null,n)}};function WP(t){t=re(t,me);let e=re(t.firestore,Ee),n=He(e),r=new vr(e);return fG(n,t._key).then(i=>new Yt(e,r,t._key,i,new fr(i!==null&&i.hasLocalMutations,!0),t.converter))}function KP(t){t=re(t,me);let e=re(t.firestore,Ee);return dP(He(e),t._key,{source:"server"}).then(n=>hI(e,t,n))}function QP(t){t=re(t,Xe);let e=re(t.firestore,Ee),n=He(e),r=new vr(e);return kP(t._query),hP(n,t._query).then(i=>new gn(e,r,t,i))}function YP(t){t=re(t,Xe);let e=re(t.firestore,Ee),n=He(e),r=new vr(e);return pG(n,t._query).then(i=>new gn(e,r,t,i))}function ZP(t){t=re(t,Xe);let e=re(t.firestore,Ee),n=He(e),r=new vr(e);return hP(n,t._query,{source:"server"}).then(i=>new gn(e,r,t,i))}function cI(t,e,n){t=re(t,me);let r=re(t.firestore,Ee),i=op(t.converter,e,n);return sa(r,[ip(gs(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Te.none())])}function lI(t,e,n,...r){t=re(t,me);let i=re(t.firestore,Ee),s=gs(i),o;return o=typeof(e=Ie(e))=="string"||e instanceof pn?sI(s,"updateDoc",t._key,e,n,r):iI(s,"updateDoc",t._key,e),sa(i,[o.toMutation(t._key,Te.exists(!0))])}function XP(t){return sa(re(t.firestore,Ee),[new ni(t._key,Te.none())])}function JP(t,e){let n=re(t.firestore,Ee),r=zc(t),i=op(t.converter,e);return sa(n,[ip(gs(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Te.exists(!1))]).then(()=>r)}function dI(t,...e){var n,r,i;t=Ie(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||fE(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(fE(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let u,c,l;if(t instanceof me)c=re(t.firestore,Ee),l=ea(t._key.path),u={next:d=>{e[o]&&e[o](hI(c,t,d))},error:e[o+1],complete:e[o+2]};else{let d=re(t,Xe);c=re(d.firestore,Ee),l=d._query;let h=new vr(c);u={next:f=>{e[o]&&e[o](new gn(c,h,d,f))},error:e[o+1],complete:e[o+2]},kP(t._query)}return function(h,f,m,v){let _=new Yo(v),I=new kc(f,_,m);return h.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return UE(yield Zo(h),I)})),()=>{_.La(),h.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return $E(yield Zo(h),I)}))}}(He(c),l,a,u)}function eO(t,e){return gG(He(t=re(t,Ee)),fE(e)?e:{next:e})}function sa(t,e){return function(r,i){let s=new je;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return K4(yield XE(r),i,s)})),s.promise}(He(t),e)}function hI(t,e,n){let r=n.docs.get(e._key),i=new vr(t);return new Yt(t,i,e._key,r,new fr(n.hasPendingWrites,n.fromCache),e.converter)}var EG={maxAttempts:5};var Jf=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=gs(e)}set(e,n,r){this._verifyNotCommitted();let i=Gr(e,this._firestore),s=op(i.converter,n,r),o=ip(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Te.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=Gr(e,this._firestore),o;return o=typeof(n=Ie(n))=="string"||n instanceof pn?sI(this._dataReader,"WriteBatch.update",s._key,n,r,i):iI(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Te.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=Gr(e,this._firestore);return this._mutations=this._mutations.concat(new ni(n._key,Te.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new w(g.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Gr(t,e){if((t=Ie(t)).firestore!==e)throw new w(g.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var TE=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=gs(n)}get(n){let r=Gr(n,this._firestore),i=new bE(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return A();let o=s[0];if(o.isFoundDocument())return new hs(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new hs(this._firestore,i,r._key,null,r.converter);throw A()})}set(n,r,i){let s=Gr(n,this._firestore),o=op(s.converter,r,i),a=ip(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=Gr(n,this._firestore),a;return a=typeof(r=Ie(r))=="string"||r instanceof pn?sI(this._dataReader,"Transaction.update",o._key,r,i,s):iI(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=Gr(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=Gr(e,this._firestore),r=new vr(this._firestore);return super.get(e).then(i=>new Yt(this._firestore,r,n._key,i._document,new fr(!1,!1),n.converter))}};function tO(t,e,n){t=re(t,Ee);let r=Object.assign(Object.assign({},EG),n);return function(s){if(s.maxAttempts<1)throw new w(g.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let u=new je;return s.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let c=yield lG(s);new cE(s.asyncQueue,c,a,o,u).ja()})),u.promise}(He(t),i=>e(new TE(t,i)),r)}function nO(){return new Lc("deleteField")}function rO(){return new yE("serverTimestamp")}function iO(...t){return new vE("arrayUnion",t)}function sO(...t){return new _E("arrayRemove",t)}function oO(t){return new wE("increment",t)}(function(e,n=!0){(function(i){Jo=i})(MI),la(new ai("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ee(new N_(r.getProvider("auth-internal")),new F_(r.getProvider("app-check-internal")),function(c,l){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new w(g.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zr(c.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Er($M,"4.4.1",e),Er($M,"4.4.1","esm2017")})();var IG="@firebase/firestore-compat",DG="0.3.24";function vI(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new w("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function aO(){if(typeof Uint8Array>"u")throw new w("unimplemented","Uint8Arrays are not available in this environment.")}function uO(){if(!JR())throw new w("unimplemented","Blobs are unavailable in Firestore in this environment.")}var ap=class t{constructor(e){this._delegate=e}static fromBase64String(e){return uO(),new t(qn.fromBase64String(e))}static fromUint8Array(e){return aO(),new t(qn.fromUint8Array(e))}toBase64(){return uO(),this._delegate.toBase64()}toUint8Array(){return aO(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function fI(t){return CG(t,["next","error","complete"])}function CG(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var pI=class{enableIndexedDbPersistence(e,n){return _P(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return wP(e._delegate)}clearIndexedDbPersistence(e){return IP(e._delegate)}},up=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Zr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Kt("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){gP(this._delegate,e,n,r)}enableNetwork(){return CP(this._delegate)}disableNetwork(){return bP(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,eI("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return DP(this._delegate)}onSnapshotsInSync(e){return eO(this._delegate,e)}get app(){if(!this._appCompat)throw new w("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ua(this,tI(this._delegate,e))}catch(n){throw ft(n,"collection()","Firestore.collection()")}}doc(e){try{return new Hn(this,zc(this._delegate,e))}catch(n){throw ft(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ws(this,mP(this._delegate,e))}catch(n){throw ft(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return tO(this._delegate,n=>e(new cp(this,n)))}batch(){return He(this._delegate),new lp(new Jf(this._delegate,e=>sa(this._delegate,e)))}loadBundle(e){return TP(this._delegate,e)}namedQuery(e){return SP(this._delegate,e).then(n=>n?new ws(this,n):null)}},oa=class extends Xo{constructor(e){super(),this.firestore=e}convertBytes(e){return new ap(new qn(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return Hn.forKey(n,this.firestore,null)}};function bG(t){UR(t)}var cp=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new oa(e)}get(e){let n=ys(e);return this._delegate.get(n).then(r=>new vs(this._firestore,new Yt(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=ys(e);return r?(vI("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=ys(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=ys(e);return this._delegate.delete(n),this}},lp=class{constructor(e){this._delegate=e}set(e,n,r){let i=ys(e);return r?(vI("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=ys(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=ys(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},aa=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Wr(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new _s(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new oa(e),n),i.set(n,s)),s}};aa.INSTANCES=new WeakMap;var Hn=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new oa(e)}static forPath(e,n,r){if(e.length%2!==0)throw new w("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new me(n._delegate,r,new D(e)))}static forKey(e,n,r){return new t(n,new me(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ua(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ua(this.firestore,tI(this._delegate,e))}catch(n){throw ft(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ie(e),e instanceof me?nI(this._delegate,e):!1}set(e,n){n=vI("DocumentReference.set",n);try{return n?cI(this._delegate,e,n):cI(this._delegate,e)}catch(r){throw ft(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?lI(this._delegate,e):lI(this._delegate,e,n,...r)}catch(i){throw ft(i,"updateDoc()","DocumentReference.update()")}}delete(){return XP(this._delegate)}onSnapshot(...e){let n=cO(e),r=lO(e,i=>new vs(this.firestore,new Yt(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return dI(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=WP(this._delegate):e?.source==="server"?n=KP(this._delegate):n=zP(this._delegate),n.then(r=>new vs(this.firestore,new Yt(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(aa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function ft(t,e,n){return t.message=t.message.replace(e,n),t}function cO(t){for(let e of t)if(typeof e=="object"&&!fI(e))return e;return{}}function lO(t,e){var n,r;let i;return fI(t[0])?i=t[0]:fI(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var vs=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Hn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return uI(this._delegate,e._delegate)}},_s=class extends vs{data(e){let n=this._delegate.data(e);return this._delegate._converter||$R(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},ws=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new oa(e)}where(e,n,r){try{return new t(this.firestore,wr(this._delegate,FP(e,n,r)))}catch(i){throw ft(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,wr(this._delegate,VP(e,n)))}catch(r){throw ft(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,wr(this._delegate,LP(e)))}catch(n){throw ft(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,wr(this._delegate,jP(e)))}catch(n){throw ft(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,wr(this._delegate,BP(...e)))}catch(n){throw ft(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,wr(this._delegate,UP(...e)))}catch(n){throw ft(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,wr(this._delegate,$P(...e)))}catch(n){throw ft(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,wr(this._delegate,qP(...e)))}catch(n){throw ft(n,"endAt()","Query.endAt()")}}isEqual(e){return rI(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=YP(this._delegate):e?.source==="server"?n=ZP(this._delegate):n=QP(this._delegate),n.then(r=>new Wc(this.firestore,new gn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=cO(e),r=lO(e,i=>new Wc(this.firestore,new gn(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return dI(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(aa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},gI=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new _s(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Wc=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new ws(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new _s(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new gI(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new _s(this._firestore,r))})}isEqual(e){return uI(this._delegate,e._delegate)}},ua=class t extends ws{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Hn(this.firestore,e):null}doc(e){try{return e===void 0?new Hn(this.firestore,zc(this._delegate)):new Hn(this.firestore,zc(this._delegate,e))}catch(n){throw ft(n,"doc()","CollectionReference.doc()")}}add(e){return JP(this._delegate,e).then(n=>new Hn(this.firestore,n))}isEqual(e){return nI(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(aa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function ys(t){return re(t,me)}var mI=class t{constructor(...e){this._delegate=new pn(...e)}static documentId(){return new t(Re.keyField().canonicalString())}isEqual(e){return e=Ie(e),e instanceof pn?this._delegate._internalPath.isEqual(e._internalPath):!1}};var yI=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=rO();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=nO();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=iO(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=sO(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=oO(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var TG={Firestore:up,GeoPoint:ds,Timestamp:De,Blob:ap,Transaction:cp,WriteBatch:lp,DocumentReference:Hn,DocumentSnapshot:vs,Query:ws,QueryDocumentSnapshot:_s,QuerySnapshot:Wc,CollectionReference:ua,FieldPath:mI,FieldValue:yI,setLogLevel:bG,CACHE_SIZE_UNLIMITED:yP};function SG(t,e){t.INTERNAL.registerComponent(new ai("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},TG)))}function AG(t){SG(t,(e,n)=>new up(e,n,new pI)),t.registerVersion(IG,DG)}AG(pt);function xG(t,e=pa){return new X(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function dO(t,e){return xG(t,e)}function MG(t,e){return dO(t,e).pipe(hi(void 0),ya(),V(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function EI(t,e){return dO(t,e).pipe(V(n=>({payload:n,type:"query"})))}var dp=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=mO(r,n);return new fp(i,s,this.afs)}snapshotChanges(){return MG(this.ref,this.afs.schedulers.outsideAngular).pipe(_t)}valueChanges(e={}){return this.snapshotChanges().pipe(V(({payload:n})=>e.idField?ae(x({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return ue(this.ref.get(e)).pipe(_t)}};function hp(t,e){return EI(t,e).pipe(hi(void 0),ya(),V(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let c=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function hO(t,e,n){return hp(t,n).pipe(di((r,i)=>RG(r,i.map(s=>s.payload),e),[]),Lp(),V(r=>r.map(i=>({type:i.type,payload:i}))))}function RG(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=NG(t,r))}),t}function _I(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function NG(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return _I(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return _I(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return _I(t,e.oldIndex,1);break}return t}function fO(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var fp=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=hp(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(V(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(hi(void 0),ya(),Je(([r,i])=>i.length>0||!r),V(([,r])=>r),_t)}auditTrail(e){return this.stateChanges(e).pipe(di((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=fO(e);return hO(this.query,n,this.afs.schedulers.outsideAngular).pipe(_t)}valueChanges(e={}){return EI(this.query,this.afs.schedulers.outsideAngular).pipe(V(n=>n.payload.docs.map(r=>e.idField?ae(x({},r.data()),{[e.idField]:r.id}):r.data())),_t)}get(e){return ue(this.query.get(e)).pipe(_t)}add(e){return this.ref.add(e)}doc(e){return new dp(this.ref.doc(e),this.afs)}},wI=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?hp(this.query,this.afs.schedulers.outsideAngular).pipe(_t):hp(this.query,this.afs.schedulers.outsideAngular).pipe(V(n=>n.filter(r=>e.indexOf(r.type)>-1)),Je(n=>n.length>0),_t)}auditTrail(e){return this.stateChanges(e).pipe(di((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=fO(e);return hO(this.query,n,this.afs.schedulers.outsideAngular).pipe(_t)}valueChanges(e={}){return EI(this.query,this.afs.schedulers.outsideAngular).pipe(V(r=>r.payload.docs.map(i=>e.idField?x({[e.idField]:i.id},i.data()):i.data())),_t)}get(e){return ue(this.query.get(e)).pipe(_t)}},pO=new k("angularfire2.enableFirestorePersistence"),gO=new k("angularfire2.firestore.persistenceSettings"),PG=new k("angularfire2.firestore.settings"),OG=new k("angularfire2.firestore.use-emulator");function mO(t,e=n=>n){return{query:e(t),ref:t}}var kG=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,c,l,d,h,f,m,v,_,I,M){this.schedulers=u;let T=ku(n,a,r),F=l;d&&kv(T,a,h,m,v,_,f,I),[this.firestore,this.persistenceEnabled$]=mh(`${T.name}.firestore`,"AngularFirestore",T.name,()=>{let B=a.runOutsideAngular(()=>T.firestore());if(s&&B.settings(s),F&&B.useEmulator(...F),i&&!xi(o)){let z=()=>{try{return ue(B.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(we){return typeof console<"u"&&console.warn(we),j(!1)}};return[B,a.runOutsideAngular(z)]}else return[B,j(!1)]},[s,F,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=mO(i,r),a=this.schedulers.ngZone.run(()=>s);return new fp(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new wI(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new dp(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(S(mo),S(yo,8),S(pO,8),S(PG,8),S(Ut),S(he),S(ph),S(gO,8),S(OG,8),S(wx,8),S(xv,8),S(Mv,8),S(Rv,8),S(Nv,8),S(Pv,8),S(Ov,8),S(qi,8))};static \u0275prov=L({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),yO=(()=>{class t{constructor(){pt.registerVersion("angularfire",go.full,"fst-compat")}static enablePersistence(n){return{ngModule:t,providers:[{provide:pO,useValue:!0},{provide:gO,useValue:n}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ct({type:t});static \u0275inj=Dt({providers:[kG]})}return t})();var vO={firebaseConfig:{apiKey:"AIzaSyAX6znG4biS61EIv08SzNFoqv8ibi30Ybg",authDomain:"app-social-post.firebaseapp.com",databaseURL:"https://app-social-post-default-rtdb.firebaseio.com",projectId:"app-social-post",storageBucket:"app-social-post.appspot.com",messagingSenderId:"479914290269",appId:"1:479914290269:web:307f02b53fed7c5582f1b4"}};var _O=(()=>{let e=class e{constructor(){this.title="chat-springboot-angular"}ngOnInit(){ax.initializeApp(vO.firebaseConfig)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Gs({type:e,selectors:[["app-root"]],standalone:!0,features:[Ys],decls:1,vars:0,template:function(i,s){i&1&&Cn(0,"router-outlet")},dependencies:[_y,yO]});let t=e;return t})();c0(_O,rx).catch(t=>console.error(t));
